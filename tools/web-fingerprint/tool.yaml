name: web-fingerprint
version: "1.0"
description: "Web technology fingerprinting for identifying CMS, frameworks, and servers"
image: "ghcr.io/silicon-works/mcp-tools-web-fingerprint:latest"
image_size_mb: 100

capabilities:
  - technology_detection
  - cms_identification
  - framework_detection
  - server_fingerprinting
  - security_header_analysis

phases:
  - reconnaissance
  - enumeration

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 128
  cpu: 0.25

# Routing hints for tool selection
routing:
  use_for:
    - "technology detection"
    - "CMS identification"
    - "framework detection"
    - "server fingerprinting"
    - "security header analysis"
    - "identify technology stack"
  never_use_for:
    - "vulnerability scanning"
    - "port scanning"
    - "exploitation"
  triggers:
    - "fingerprint"
    - "technology stack"
    - "what technology"
    - "CMS"
    - "identify framework"
    - "security headers"
    - "favicon hash"
  prefer_over:
    - nuclei  # Lighter weight for pure tech detection

methods:
  fingerprint:
    description: "Fingerprint web technologies on a target URL"
    when_to_use: "Initial reconnaissance to identify technology stack"
    params:
      url:
        type: string
        required: true
        description: "Target URL to fingerprint"
      follow_redirects:
        type: boolean
        default: true
        description: "Follow HTTP redirects"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
      user_agent:
        type: string
        description: "Custom User-Agent header"
    returns:
      technologies:
        type: array
        description: "Detected technologies with confidence scores"
      server:
        type: string
        description: "Server header value"
      title:
        type: string
        description: "Page title"
      interesting_paths:
        type: array
        description: "Extracted paths from HTML"

  headers:
    description: "Extract and analyze HTTP headers"
    when_to_use: "To analyze server configuration and security headers"
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
    returns:
      security_headers:
        type: object
        description: "Security-related headers"
      server_headers:
        type: object
        description: "Server information headers"

  security_headers:
    description: "Check for security headers and misconfigurations"
    when_to_use: "To assess security header configuration"
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
    returns:
      missing_headers:
        type: array
        description: "Missing security headers"
      present_headers:
        type: array
        description: "Present security headers"
      issues:
        type: array
        description: "Security issues found"
      score:
        type: string
        description: "Security header score"

  favicon_hash:
    description: "Calculate favicon hash for Shodan lookup"
    when_to_use: "To find similar servers via Shodan favicon search"
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      timeout:
        type: integer
        default: 30
        description: "Request timeout"
    returns:
      md5:
        type: string
        description: "Favicon MD5 hash"
      shodan_query:
        type: string
        description: "Shodan search query"
