name: hash-lookup
version: "1.0"
description: "Online hash lookup via public databases (hashes.com, nitrxgen, hashtoolkit)"
image: "ghcr.io/silicon-works/mcp-tools-hash-lookup:latest"
image_size_mb: 100

capabilities:
  - hash_lookup
  - hash_identification
  - online_cracking

phases:
  - post-exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 128
  cpu: 0.25

# Routing hints for tool selection
routing:
  use_for:
    - "hash cracking via online databases"
    - "hash identification"
    - "password hash lookup"
    - "quick hash check"
  never_use_for:
    - "offline brute-force cracking"
    - "password spraying"
    - "port scanning"
  triggers:
    - "hash"
    - "crack"
    - "password hash"
    - "NTLM"
    - "MD5"
    - "SHA"
    - "hash lookup"
  prefer_over:
    - hydra  # For known hashes, lookup is faster than brute-force

methods:
  lookup:
    description: "Look up a hash in online databases"
    when_to_use: "To quickly check if a hash has already been cracked online"
    params:
      hash:
        type: string
        required: true
        description: "Hash value to look up"
      hash_type:
        type: enum
        values: [auto, md5, sha1, sha256, ntlm]
        default: auto
        description: "Hash type (auto-detect if not specified)"
    returns:
      hash:
        type: string
        description: "The hash that was looked up"
      plaintext:
        type: string
        description: "Cracked plaintext if found"
      source:
        type: string
        description: "Source that returned the result"
      cracked:
        type: boolean
        description: "Whether the hash was cracked"

  lookup_batch:
    description: "Look up multiple hashes at once"
    when_to_use: "To check multiple hashes quickly"
    params:
      hashes:
        type: array
        required: true
        description: "List of hashes to look up"
      hash_type:
        type: enum
        values: [auto, md5, sha1, sha256, ntlm]
        default: auto
        description: "Hash type for all hashes"
    returns:
      results:
        type: array
        description: "Results for each hash"
      cracked_count:
        type: integer
        description: "Number of hashes cracked"
      not_found_count:
        type: integer
        description: "Number of hashes not found"

  identify:
    description: "Identify the type of a hash"
    when_to_use: "When unsure what type of hash was extracted"
    params:
      hash:
        type: string
        required: true
        description: "Hash to identify"
    returns:
      possible_types:
        type: array
        description: "Possible hash types"
      descriptions:
        type: array
        description: "Descriptions of each type"

  generate:
    description: "Generate hash from plaintext (for testing/comparison)"
    when_to_use: "To generate test hashes or verify cracked passwords"
    params:
      plaintext:
        type: string
        required: true
        description: "Text to hash"
      hash_type:
        type: enum
        values: [md5, sha1, sha256, sha512, ntlm]
        default: md5
        description: "Hash algorithm to use"
    returns:
      plaintext:
        type: string
        description: "Original plaintext"
      hash:
        type: string
        description: "Generated hash"
