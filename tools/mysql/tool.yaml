name: mysql
version: "8.0"
description: "MySQL client for database enumeration and credential extraction"
image: "ghcr.io/silicon-works/mcp-tools-mysql:latest"
image_size_mb: 300

capabilities:
  - database_enumeration
  - sql_query_execution
  - credential_extraction
  - data_exfiltration

phases:
  - enumeration
  - post-exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

# Routing hints for tool selection
routing:
  use_for:
    - "MySQL database access"
    - "MySQL query execution"
    - "database enumeration"
    - "credential extraction from MySQL"
    - "MySQL data exfiltration"
  never_use_for:
    - "SQL injection (use sqlmap)"
    - "port scanning"
    - "MongoDB or SQLite access"
  triggers:
    - "MySQL"
    - "MariaDB"
    - "database query"
    - "SQL query"
    - "database enumeration"
    - "port 3306"

methods:
  query:
    description: "Execute a SQL query on a MySQL database"
    when_to_use: "When you have MySQL credentials and need to query the database"
    params:
      host:
        type: string
        required: true
        description: "MySQL server hostname or IP"
      username:
        type: string
        required: true
        description: "MySQL username"
      password:
        type: string
        description: "MySQL password"
      database:
        type: string
        description: "Database to use"
      query:
        type: string
        required: true
        description: "SQL query to execute"
      port:
        type: integer
        default: 3306
        description: "MySQL port"
      timeout:
        type: integer
        default: 30
        description: "Query timeout in seconds"
    returns:
      rows:
        type: array
        description: "Query results as array of objects"
      row_count:
        type: integer
        description: "Number of rows returned"

  list_databases:
    description: "List all databases on the server"
    when_to_use: "Initial enumeration after gaining MySQL access"
    params:
      host:
        type: string
        required: true
        description: "MySQL server hostname or IP"
      username:
        type: string
        required: true
        description: "MySQL username"
      password:
        type: string
        description: "MySQL password"
      port:
        type: integer
        default: 3306
        description: "MySQL port"
    returns:
      databases:
        type: array
        description: "List of database names"

  list_tables:
    description: "List all tables in a database"
    when_to_use: "To enumerate tables after identifying interesting databases"
    params:
      host:
        type: string
        required: true
        description: "MySQL server hostname or IP"
      username:
        type: string
        required: true
        description: "MySQL username"
      password:
        type: string
        description: "MySQL password"
      database:
        type: string
        required: true
        description: "Database name"
      port:
        type: integer
        default: 3306
        description: "MySQL port"
    returns:
      tables:
        type: array
        description: "List of table names"

  dump_table:
    description: "Dump contents of a table"
    when_to_use: "To extract data from a table"
    params:
      host:
        type: string
        required: true
        description: "MySQL server hostname or IP"
      username:
        type: string
        required: true
        description: "MySQL username"
      password:
        type: string
        description: "MySQL password"
      database:
        type: string
        required: true
        description: "Database name"
      table:
        type: string
        required: true
        description: "Table name"
      columns:
        type: array
        description: "Specific columns to dump"
      limit:
        type: integer
        default: 100
        description: "Maximum rows to return"
      port:
        type: integer
        default: 3306
        description: "MySQL port"
    returns:
      data:
        type: array
        description: "Table contents"
      row_count:
        type: integer
        description: "Number of rows returned"

  find_credentials:
    description: "Search for credential-related tables and data"
    when_to_use: "To find usernames and passwords in the database"
    params:
      host:
        type: string
        required: true
        description: "MySQL server hostname or IP"
      username:
        type: string
        required: true
        description: "MySQL username"
      password:
        type: string
        description: "MySQL password"
      database:
        type: string
        description: "Database to search (searches all if not specified)"
      port:
        type: integer
        default: 3306
        description: "MySQL port"
    returns:
      tables:
        type: array
        description: "Tables that may contain credentials"
      credentials:
        type: array
        description: "Found credentials (username, password/hash)"
