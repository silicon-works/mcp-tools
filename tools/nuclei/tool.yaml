name: nuclei
version: "3.0"
description: "Template-based vulnerability scanner with extensive CVE coverage"
image: "ghcr.io/silicon-works/mcp-tools-nuclei:latest"
image_size_mb: 500

capabilities:
  - vulnerability_scanning
  - cve_detection
  - technology_detection
  - misconfiguration_detection

# Routing hints for tool selection
routing:
  use_for:
    - "vulnerability scanning"
    - "CVE scanning"
    - "known vulnerability detection"
    - "technology fingerprinting"
    - "misconfiguration detection"
    - "security scanning"
  never_use_for:
    - "port scanning"
    - "directory brute-forcing"
    - "password cracking"
  triggers:
    - "nuclei"
    - "CVE scan"
    - "vulnerability scan"
    - "template scan"
    - "security scan"
    - "misconfiguration scan"
  prefer_over:
    - "nikto"  # nuclei has more templates and is faster

phases:
  - enumeration

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 512
  cpu: 1.0

methods:
  scan:
    description: "Scan a target using nuclei templates"
    when_to_use: "After discovering services to check for known CVEs and misconfigurations"
    params:
      target:
        type: string
        required: true
        description: "Target URL or IP"
      templates:
        type: string
        description: "Specific template or directory (e.g., 'cves/', 'vulnerabilities/')"
      tags:
        type: string
        description: "Filter by tags (e.g., 'cve,rce,sqli')"
      severity:
        type: string
        description: "Filter by severity (info,low,medium,high,critical)"
      rate_limit:
        type: integer
        default: 150
        description: "Maximum requests per second"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      findings:
        type: array
        description: "Detected vulnerabilities with template details"
      by_severity:
        type: object
        description: "Count of findings grouped by severity"

  quick_scan:
    description: "Quick scan for critical/high severity vulnerabilities only"
    when_to_use: "For rapid initial assessment focusing on high-impact vulnerabilities"
    params:
      target:
        type: string
        required: true
        description: "Target URL or IP"
      focus:
        type: enum
        values: [cve, rce, lfi, sqli, xss, ssrf, auth-bypass, default-login]
        default: "cve"
        description: "Focus area for quick scan"
      timeout:
        type: integer
        default: 120
        description: "Timeout in seconds"
    returns:
      findings:
        type: array
        description: "Critical/high severity findings"

  tech_detect:
    description: "Detect technologies used by target (fast)"
    when_to_use: "For quick technology fingerprinting before deeper scanning"
    params:
      target:
        type: string
        required: true
        description: "Target URL or IP"
      timeout:
        type: integer
        default: 60
        description: "Timeout in seconds"
    returns:
      technologies:
        type: array
        description: "Detected technology names"
      details:
        type: array
        description: "Full detection details"
