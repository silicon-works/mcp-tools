name: enum4linux-ng
version: "1.3"
description: "SMB/Windows enumeration tool for shares, users, and groups"
image: "ghcr.io/silicon-works/mcp-tools-enum4linux-ng:latest"
image_size_mb: 150

capabilities:
  - smb_enumeration
  - user_enumeration
  - share_enumeration
  - group_enumeration

phases:
  - enumeration

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

# Routing hints for tool selection
routing:
  use_for:
    - "SMB enumeration"
    - "Windows user enumeration"
    - "share enumeration"
    - "group enumeration"
    - "RID cycling"
    - "password policy enumeration"
  never_use_for:
    - "SMB exploitation"
    - "port scanning"
    - "brute-force attacks"
  triggers:
    - "SMB"
    - "enum4linux"
    - "Windows enumeration"
    - "shares"
    - "RID cycling"
    - "Samba"
    - "port 445"
    - "port 139"
  prefer_over:
    - nmap  # For detailed SMB enumeration

methods:
  enumerate:
    description: "Enumerate SMB shares, users, groups, and more from a Windows/Samba target"
    when_to_use: "After discovering SMB service (445/139) to enumerate Windows/Samba information"
    params:
      target:
        type: string
        required: true
        description: "Target IP or hostname"
      username:
        type: string
        description: "Username for authenticated enumeration"
      password:
        type: string
        description: "Password for authenticated enumeration"
      shares:
        type: boolean
        default: true
        description: "Enumerate shares"
      users:
        type: boolean
        default: true
        description: "Enumerate users via RID cycling"
      groups:
        type: boolean
        default: true
        description: "Enumerate groups"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      shares:
        type: array
        description: "Discovered SMB shares"
      users:
        type: array
        description: "Discovered users"
      groups:
        type: array
        description: "Discovered groups"
      os_info:
        type: object
        description: "Operating system information"

  enum_users:
    description: "Enumerate users via RID cycling on SMB/Windows target"
    when_to_use: "To enumerate user accounts on Windows/Samba targets"
    params:
      target:
        type: string
        required: true
        description: "Target IP or hostname"
      username:
        type: string
        description: "Username for authenticated enumeration"
      password:
        type: string
        description: "Password for authenticated enumeration"
      rid_range:
        type: string
        default: "500-550,1000-1200"
        description: "RID range to enumerate (e.g., '500-550,1000-1200')"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      users:
        type: array
        description: "Discovered users with RID and domain info"
      count:
        type: integer
        description: "Number of users found"

  enum_shares:
    description: "Enumerate SMB shares and check access permissions"
    when_to_use: "To discover available SMB shares and access levels"
    params:
      target:
        type: string
        required: true
        description: "Target IP or hostname"
      username:
        type: string
        description: "Username for authenticated enumeration"
      password:
        type: string
        description: "Password for authenticated enumeration"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      shares:
        type: array
        description: "Discovered shares with type, comment, and access info"
      count:
        type: integer
        description: "Number of shares found"

  enum_groups:
    description: "Enumerate groups and their members from SMB/Windows target"
    when_to_use: "To discover group memberships for privilege escalation paths"
    params:
      target:
        type: string
        required: true
        description: "Target IP or hostname"
      username:
        type: string
        description: "Username for authenticated enumeration"
      password:
        type: string
        description: "Password for authenticated enumeration"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      groups:
        type: array
        description: "Discovered groups with RID and members"
      count:
        type: integer
        description: "Number of groups found"

  enum_policy:
    description: "Enumerate password policy and domain info"
    when_to_use: "To understand password requirements before brute-forcing"
    params:
      target:
        type: string
        required: true
        description: "Target IP or hostname"
      username:
        type: string
        description: "Username for authenticated enumeration"
      password:
        type: string
        description: "Password for authenticated enumeration"
      timeout:
        type: integer
        default: 300
        description: "Timeout in seconds"
    returns:
      password_policy:
        type: object
        description: "Password policy settings"
      domain_info:
        type: object
        description: "Domain and OS information"
