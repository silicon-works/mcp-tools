name: curl
version: "8.18"
description: "HTTP client (curl 8.18.0 with HTTP/2, HTTP/3, NTLM, Kerberos support) wrapped in 5 specialized methods: request (any HTTP method with timing/debug), inject (RCE payload delivery with {PAYLOAD} placeholder and auto-encoding), upload (multipart file upload for web shells), download (small files as base64), and download_to_file (large files with auto .gz decompression). Returns structured response data: status code, parsed headers, body (50KB cap), timing breakdown (DNS/connect/TLS/TTFB/total), and error classification. Default User-Agent mimics Chrome on Windows. For login forms and JS pages, use playwright-mcp instead."
image: "ghcr.io/silicon-works/mcp-tools-curl:latest"
image_size_mb: 100

capabilities:
  - http_requests
  - file_download
  - exploit_testing
  - api_interaction

# Cross-references to related tools
see_also:
  - playwright-mcp  # For JavaScript-rendered pages, login forms, when curl returns empty
  - ffuf            # For directory/parameter fuzzing
  - zap             # For automated security scanning

# Routing hints for tool selection
routing:
  use_for:
    - "make a single HTTP request to test an endpoint or check headers"
    - "deliver exploit payloads to web RCE endpoints with auto-encoding"
    - "upload web shells or malicious files via multipart form"
    - "download wordlists or exploit scripts to session directory"
    - "interact with a deployed web shell via command injection"
    - "check server response headers for version fingerprinting"
    - "send POST data to test for SQL injection or command injection"
    - "download files from target (configs SSH keys databases)"
    - "API request with authentication cookies or bearer tokens"
  never_use_for:
    - "directory brute-forcing"
    - "web fuzzing"
    - "automated scanning"
    - "login form filling"
    - "JavaScript rendered pages"
    - "pages that return empty bodies"
  triggers:
    - "download wordlist"
    - "get rockyou"
    - "fetch wordlist"
    - "download to session"
    - "api request"
    - "exploit payload"
  prefer_over: []

warnings:
  - "Returns raw HTTP response - does NOT execute JavaScript"
  - "If response body is empty, the page likely requires JavaScript - use playwright-mcp instead"
  - "For login forms, playwright-mcp is usually better (handles cookies, CSRF, JS validation)"
  - "Cannot see rendered page content - use playwright-mcp browser_snapshot for that"

phases:
  - reconnaissance
  - enumeration
  - exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 128
  cpu: 0.25

methods:
  request:
    description: "Make an HTTP request with any method (GET/POST/PUT/DELETE/HEAD/OPTIONS/PATCH). Uses curl -s -S -i under the hood with response header parsing, redirect following (up to 10), and structured timing breakdown. Returns parsed status code, response headers as dict, body text (capped at 50KB), and timing (DNS lookup, TCP connect, TLS handshake, TTFB, total in ms, remote IP/port). Supports cookies, basic auth, custom headers, SSL bypass, and 4 debug levels. Body is NOT returned as base64 by default — use raw_response=true for binary content."
    when_to_use: "For any single HTTP request: testing an endpoint, checking response headers, verifying a vulnerability, sending API calls, or confirming exploit success. Common pentest uses: (1) Check server headers for version info (HEAD request), (2) Test for open redirects or SSRF by checking redirect chains, (3) Send POST data to test for injection, (4) Verify web shell was uploaded by requesting it, (5) Interact with REST APIs. Use inject method instead when you need automatic payload encoding for RCE. Use playwright-mcp for JavaScript-rendered pages or when response body is empty."
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      method:
        type: enum
        values: [GET, POST, PUT, DELETE, HEAD, OPTIONS, PATCH]
        default: GET
        description: "HTTP method"
      headers:
        type: [object, array]
        description: "Custom headers as key-value pairs (object) or array of 'Header: value' strings"
      data:
        type: string
        description: "Request body data"
      body:
        type: string
        description: "Request body data (alias for 'data')"
      follow_redirects:
        type: boolean
        default: true
        description: "Follow HTTP redirects"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
      connect_timeout:
        type: integer
        default: 10
        description: "Connection timeout in seconds"
      insecure:
        type: boolean
        default: false
        description: "Skip SSL certificate verification"
      user_agent:
        type: string
        description: "Custom User-Agent header"
      cookie:
        type: string
        description: "Cookie header value"
      auth:
        type: string
        description: "Basic auth in user:password format"
      debug_level:
        type: integer
        enum: [0, 1, 2, 3]
        default: 0
        description: "Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace"
      raw_response:
        type: boolean
        default: false
        description: "Return raw binary response as base64 (for binary downloads)"
    returns:
      status_code:
        type: integer
        description: "HTTP response status code"
      headers:
        type: object
        description: "Response headers"
      body:
        type: string
        description: "Response body"
      body_length:
        type: integer
        description: "Length of response body in bytes"
      timing:
        type: object
        description: "Request timing breakdown"
        properties:
          dns_lookup_ms:
            type: integer
            description: "DNS lookup time in milliseconds"
          connect_ms:
            type: integer
            description: "TCP connection time in milliseconds"
          tls_handshake_ms:
            type: integer
            description: "TLS handshake time in milliseconds"
          first_byte_ms:
            type: integer
            description: "Time to first byte in milliseconds"
          total_ms:
            type: integer
            description: "Total request time in milliseconds"
          remote_ip:
            type: string
            description: "IP address of the remote server"
          remote_port:
            type: integer
            description: "Port of the remote server"
      debug:
        type: object
        description: "Debug information (when debug_level >= 1)"
        properties:
          request_headers:
            type: object
            description: "Headers sent in the request"
          verbose_output:
            type: string
            description: "Full verbose output (debug_level >= 2)"
      error:
        type: object
        description: "Error details (on failure)"
        properties:
          type:
            type: string
            description: "Error type (e.g., 'connection_refused', 'timeout', 'could_not_resolve_host')"
          message:
            type: string
            description: "Human-readable error message"
          curl_exit_code:
            type: integer
            description: "Curl exit code"

  download:
    description: "Download a file from a URL and return contents as base64-encoded string. Uses curl -s -S -L (follows redirects). Filename extracted from URL path. For large files (>10MB), use download_to_file instead — this method loads the entire file into memory and base64-encodes it."
    when_to_use: "For downloading small files (<10MB) that you need to inspect or process: exploit scripts, configuration files, SSH keys, small binaries. The base64 content can be decoded and written to disk. For wordlists, large binaries, or files >10MB, use download_to_file instead (writes directly to disk)."
    params:
      url:
        type: string
        required: true
        description: "URL to download from"
      timeout:
        type: integer
        default: 120
        description: "Download timeout in seconds"
      insecure:
        type: boolean
        default: false
        description: "Skip SSL certificate verification"
    returns:
      filename:
        type: string
        description: "Extracted filename"
      size_bytes:
        type: integer
        description: "File size in bytes"
      content_base64:
        type: string
        description: "File contents as base64"

  download_to_file:
    description: "Download a large file directly to a filesystem path using curl -o (no memory buffering). Follows redirects, shows progress bar. Auto-decompresses .gz files when decompress=true (default). Creates parent directories automatically. For text files (.txt), counts lines after download. 10-minute default timeout for large files."
    when_to_use: "For downloading wordlists, large exploit tools, or binaries directly to disk. Common workflow: (1) Use web_search to find a wordlist URL (e.g., rockyou.txt, SecLists), (2) download_to_file to save to /session/wordlists/. Example: url='https://github.com/.../rockyou.txt.gz', output_path='/session/wordlists/rockyou.txt' (auto-decompresses .gz). Also useful for downloading large exploit scripts or toolkits that need to be saved locally before execution."
    params:
      url:
        type: string
        required: true
        description: "URL to download from"
      output_path:
        type: string
        required: true
        description: "Path to save file (e.g., /session/wordlists/rockyou.txt)"
      timeout:
        type: integer
        default: 600
        description: "Download timeout in seconds (default 10 minutes for large files)"
      insecure:
        type: boolean
        default: false
        description: "Skip SSL certificate verification"
      decompress:
        type: boolean
        default: true
        description: "Auto-decompress .gz files after download"
    returns:
      output_path:
        type: string
        description: "Path where file was saved"
      size_bytes:
        type: integer
        description: "File size in bytes"
      size_mb:
        type: number
        description: "File size in MB"
      line_count:
        type: integer
        description: "Number of lines (for text files)"
      decompressed:
        type: boolean
        description: "Whether file was decompressed"

  inject:
    description: "Send a command to a web RCE endpoint via {PAYLOAD} placeholder substitution with automatic encoding (URL, double-URL, base64, or none). Replaces {PAYLOAD} in both URL and POST body with the encoded command. Extracts command output from the response using optional start/end markers, strips HTML tags by default. Built on the request method — inherits timing, error handling, and redirect following."
    when_to_use: "For exploiting confirmed web RCE vulnerabilities — command injection, PHP code injection, template injection, etc. Typical workflow: (1) Confirm RCE via request method with manual payload, (2) Switch to inject for repeated command execution with auto-encoding. The {PAYLOAD} placeholder goes in the URL for GET-based injection (e.g., url='http://target/vuln.php?cmd={PAYLOAD}') or in the POST body (data='cmd={PAYLOAD}'). Use output_markers to extract clean output from noisy HTML responses. Use encoding='double-url' for WAF bypass, 'base64' for payloads with special characters."
    params:
      url:
        type: string
        required: true
        description: "Target URL (use {PAYLOAD} as placeholder for command)"
      command:
        type: string
        required: true
        description: "Command to execute"
      method:
        type: enum
        values: [GET, POST]
        default: GET
        description: "HTTP method"
      encoding:
        type: enum
        values: [url, double-url, base64, none]
        default: url
        description: "Payload encoding method"
      output_markers:
        type: object
        description: "Start/end markers to extract output: {start: str, end: str}"
      strip_html:
        type: boolean
        default: true
        description: "Strip HTML tags from output"
      headers:
        type: [object, array]
        description: "Custom headers as key-value pairs (object) or array of 'Header: value' strings"
      data:
        type: string
        description: "POST body (use {PAYLOAD} as placeholder)"
      body:
        type: string
        description: "POST body (alias for 'data', use {PAYLOAD} as placeholder)"
      cookie:
        type: string
        description: "Cookie header value"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
      connect_timeout:
        type: integer
        default: 10
        description: "Connection timeout in seconds"
      insecure:
        type: boolean
        default: false
        description: "Skip SSL certificate verification"
      debug_level:
        type: integer
        enum: [0, 1, 2, 3]
        default: 0
        description: "Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace"
    returns:
      output:
        type: string
        description: "Extracted command output"
      status_code:
        type: integer
        description: "HTTP response status code"
      raw_body_length:
        type: integer
        description: "Length of raw response body"
      timing:
        type: object
        description: "Request timing breakdown (same as request method)"
      debug:
        type: object
        description: "Debug information (when debug_level >= 1)"
      error:
        type: object
        description: "Error details (on failure)"

  upload:
    description: "Upload a file via multipart/form-data POST request. Content can be plain text (for web shells, scripts) or base64-encoded (for binary files). Uses curl -F with automatic temp file creation and cleanup. Supports custom MIME type spoofing, extra form fields, cookies, and custom headers. Returns parsed response including status code, headers, body, and timing."
    when_to_use: "For exploiting file upload vulnerabilities: (1) Upload a PHP/JSP/ASP web shell through a file upload form, (2) Upload a reverse shell binary, (3) Exploit unrestricted file upload for RCE. You need to know the form field name (inspect the HTML form for the <input type='file' name='...'> attribute). Common field names: 'file', 'upload', 'avatar', 'image', 'attachment'. Set content_type to 'image/jpeg' or 'image/png' to bypass MIME type checks. Use extra_fields for additional required form parameters."
    params:
      url:
        type: string
        required: true
        description: "Target upload URL"
      file_field:
        type: string
        required: true
        description: "Form field name for file (e.g., 'file', 'upload', 'avatar')"
      filename:
        type: string
        required: true
        description: "Filename to send (e.g., 'shell.php', 'image.png')"
      content:
        type: string
        required: true
        description: "File content (plain text or base64 encoded)"
      content_type:
        type: string
        default: "application/octet-stream"
        description: "MIME type for the uploaded file"
      is_base64:
        type: boolean
        default: false
        description: "Whether content is base64 encoded"
      extra_fields:
        type: object
        description: "Additional form fields as key-value pairs"
      headers:
        type: [object, array]
        description: "Custom HTTP headers as key-value pairs (object) or array of 'Header: value' strings"
      cookie:
        type: string
        description: "Cookie header value"
      timeout:
        type: integer
        default: 60
        description: "Upload timeout in seconds"
      connect_timeout:
        type: integer
        default: 10
        description: "Connection timeout in seconds"
      insecure:
        type: boolean
        default: false
        description: "Skip SSL certificate verification"
      debug_level:
        type: integer
        enum: [0, 1, 2, 3]
        default: 0
        description: "Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace"
    returns:
      status_code:
        type: integer
        description: "HTTP response status code"
      filename:
        type: string
        description: "Uploaded filename"
      file_size:
        type: integer
        description: "Size of uploaded content"
      body:
        type: string
        description: "Response body"
      body_length:
        type: integer
        description: "Length of response body"
      timing:
        type: object
        description: "Request timing breakdown (same as request method)"
      debug:
        type: object
        description: "Debug information (when debug_level >= 1)"
      error:
        type: object
        description: "Error details (on failure)"
