name: ffuf
version: "2.1.0"
description: "Fast web fuzzer (ffuf v2.1.0, Go-based) for directory/file discovery, GET/POST parameter fuzzing, and virtual host enumeration. Uses FUZZ keyword placeholder in URLs, headers, or POST data. Includes 7 built-in wordlists: common (4,614 entries), big (20,469), small (959), dirbuster-small (87,650), dirbuster-medium (220,546), raft-small, raft-medium from SecLists. Supports response filtering by status code, size, lines, words, regex, and response time. Default 40 concurrent threads. JSON output with structured result parsing. Auto-calibration (-ac) for intelligent response filtering. Includes dirb and SecLists wordlists."
image: "ghcr.io/silicon-works/mcp-tools-ffuf:latest"
image_size_mb: 200
timeout_seconds: 600

capabilities:
  - directory_bruteforce
  - parameter_fuzzing
  - vhost_discovery

# Routing hints for tool selection
routing:
  use_for:
    - "directory brute-forcing"
    - "directory enumeration"
    - "find hidden files"
    - "find hidden directories"
    - "parameter fuzzing"
    - "vhost discovery"
    - "subdomain enumeration"
  never_use_for:
    - "SQL injection"
    - "port scanning"
    - "password cracking"
  triggers:
    - "ffuf"
    - "directory brute"
    - "fuzz"
    - "dirbuster"
    - "hidden files"
    - "hidden directories"
    - "vhost"
    - "wordlist"
  prefer_over:
    - "gobuster"  # ffuf is faster and more flexible
    - "dirbuster"  # ffuf is CLI-based and faster

phases:
  - enumeration

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 512
  cpu: 1.0

methods:
  dir_fuzz:
    description: "Fuzz directories and files on a web server using wordlist-based brute-forcing. Appends FUZZ keyword to URL if not present. Runs ffuf with JSON output, auto-calibration, and configurable thread count (default 40). Supports file extension fuzzing (e.g., .php,.html,.txt), custom headers, cookies for authenticated fuzzing, and response size filtering. Returns discovered paths with HTTP status code, content length, word count, and line count."
    when_to_use: "The standard web enumeration step after discovering an HTTP/HTTPS service. Run this to find hidden directories, admin panels, backup files, and API endpoints. Start with wordlist='common' (fast, 4.6K entries), then try 'big' (20K) or 'dirbuster-medium' (220K) if initial results are sparse. Add extensions='php,html,txt,bak,old' for the target's technology stack. For PHP sites: extensions='php,php.bak,inc'. For Java: extensions='jsp,do,action'. Filter out false positives with filter_size (e.g., '0' for empty responses). Use cookies param for post-authentication fuzzing."
    params:
      url:
        type: string
        required: true
        description: "Target URL (FUZZ keyword added automatically if missing)"
      wordlist:
        type: string
        default: "common"
        description: "Wordlist name (common, big, dirbuster-small, dirbuster-medium) or path"
      extensions:
        type: string
        description: "File extensions to append (e.g., 'php,html,txt')"
      threads:
        type: integer
        default: 40
        description: "Number of concurrent threads"
      filter_status:
        type: string
        description: "Match these status codes (default: 200,204,301,302,307,401,403,405)"
      filter_size:
        type: string
        description: "Filter out responses of this size"
      timeout:
        type: integer
        default: 10
        description: "HTTP request timeout in seconds"
      headers:
        type: object
        description: "Custom HTTP headers as key-value pairs (e.g., {\"Host\": \"target.htb\"})"
      cookies:
        type: string
        description: "Cookie header value for authenticated fuzzing"
    returns:
      results:
        type: array
        description: "Discovered paths with status codes and sizes"
      summary:
        type: object
        description: "Summary with target, wordlist, and found paths"

  param_fuzz:
    description: "Fuzz GET or POST parameters on a web endpoint. The FUZZ keyword must be placed in the URL query string (GET) or POST data body. Supports JSON POST bodies. Uses same wordlist resolution and filtering as dir_fuzz. Useful for discovering hidden GET parameters, valid parameter values, or testing for different responses that indicate injection points."
    when_to_use: "Two main scenarios: (1) Discover hidden GET parameters — place FUZZ as the parameter name: url='http://target.com/page?FUZZ=test'. (2) Fuzz parameter values for valid inputs — place FUZZ as the value: url='http://target.com/api?id=FUZZ'. For POST parameter fuzzing, set method='POST' and data='username=admin&password=FUZZ'. Filter by response size to find responses that differ from the default (which indicates a valid parameter or value). Also useful for IDOR testing by fuzzing numeric IDs."
    params:
      url:
        type: string
        required: true
        description: "Target URL with FUZZ keyword in parameter"
      wordlist:
        type: string
        default: "common"
        description: "Wordlist name or path"
      method:
        type: enum
        default: GET
        values: [GET, POST]
        description: "HTTP method"
      data:
        type: string
        description: "POST data with FUZZ keyword (e.g., 'username=admin&password=FUZZ')"
      threads:
        type: integer
        default: 40
        description: "Number of concurrent threads"
      filter_status:
        type: string
        description: "Match these status codes"
      filter_size:
        type: string
        description: "Filter out responses of this size"
      headers:
        type: object
        description: "Custom HTTP headers as key-value pairs"
      cookies:
        type: string
        description: "Cookie header value for authenticated fuzzing"
    returns:
      results:
        type: array
        description: "Matching parameter values with responses"

  vhost_fuzz:
    description: "Fuzz virtual hosts by sending requests with different Host headers. Sets Host header to 'FUZZ.domain' and filters by response size to identify valid vhosts that return different content than the default. Critical for HTB/CTF targets where the IP hosts multiple sites under different subdomains."
    when_to_use: "When you have a target IP that serves different content based on the Host header — common in CTFs (Hack The Box) and shared hosting. The workflow: (1) Access the IP directly, note the default response size, (2) vhost_fuzz with filter_size set to the default size to filter it out. This reveals subdomains like 'dev.target.htb', 'api.target.htb', 'internal.target.htb' that serve different applications. Add discovered vhosts to /etc/hosts. Use after nmap finds HTTP and you've already done dir_fuzz on the main site."
    params:
      url:
        type: string
        required: true
        description: "Target URL (IP address or hostname)"
      domain:
        type: string
        required: true
        description: "Base domain for vhost fuzzing (e.g., 'target.htb')"
      wordlist:
        type: string
        default: "common"
        description: "Wordlist for subdomain prefixes"
      threads:
        type: integer
        default: 40
        description: "Number of concurrent threads"
      filter_size:
        type: string
        description: "Filter out default response size"
    returns:
      vhosts:
        type: array
        description: "Discovered virtual hosts"
      summary:
        type: object
        description: "Summary with target domain and found vhosts"
