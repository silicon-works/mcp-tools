name: searchsploit
version: "latest"
description: "Search ExploitDB for public exploits and vulnerability information"
image: "ghcr.io/silicon-works/mcp-tools-searchsploit:latest"
image_size_mb: 500

capabilities:
  - exploit_search
  - vulnerability_research

phases:
  - exploitation

requirements:
  network: false
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

# Routing hints for tool selection (added for Doc 22 Phase 1)
routing:
  use_for:
    - "find exploit for CVE"
    - "search exploitdb"
    - "known vulnerability exploit"
    - "public exploit"
    - "exploit database search"
  triggers:
    - "CVE-\\d{4}-\\d+"
    - "exploit.*search"
    - "searchsploit"
  never_use_for:
    - "writing custom exploits"
    - "payload generation"

methods:
  search:
    description: "Search ExploitDB for exploits matching a query"
    when_to_use: "After identifying a service version to find known exploits"
    params:
      query:
        type: string
        required: true
        description: "Search terms (e.g., 'apache 2.4', 'wordpress 5.0', 'ms17-010')"
      exact:
        type: boolean
        default: false
        description: "Perform exact match search"
      type:
        type: enum
        values: [all, exploit, shellcode, paper]
        default: all
        description: "Type of results to return"
    returns:
      results:
        type: array
        description: "Matching exploits with ID, title, and path"

  get_exploit:
    description: "Get the content of a specific exploit by ID or path"
    when_to_use: "To retrieve exploit code for manual review or execution"
    params:
      exploit_id:
        type: string
        required: true
        description: "Exploit ID number or path from search results"
    returns:
      content:
        type: string
        description: "Exploit source code"
