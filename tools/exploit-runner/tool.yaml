name: exploit-runner
version: "1.1"
description: "Execute CVE exploits, PoCs, parameterized templates, and develop binary exploits. Includes pwntools, GDB+pwndbg, ropper, one_gadget, and impacket for writing and testing exploitation scripts."
image: "ghcr.io/silicon-works/mcp-tools-exploit-runner:latest"
image_size_mb: 800

capabilities:
  - python_exploits
  - shell_exploits
  - ruby_exploits
  - exploit_analysis
  - exploit_templates
  - payload_generation

routing:
  use_for:
    - "run known CVE exploits"
    - "execute exploit templates"
    - "generate reverse shell payloads"
    - "run PoC scripts"
    - "binary exploitation with pwntools"
    - "buffer overflow exploit development"
    - "ROP chain building"
    - "format string exploitation"
    - "ELF binary analysis checksec"
    - "pwntools scripting"
    - "GDB debugging binary"
    - "find buffer overflow offset"
  never_use_for:
    - "port scanning"
    - "enumeration"
  triggers:
    - "run exploit"
    - "execute PoC"
    - "CVE exploit"
    - "exploit template"
    - "run script"
  prefer_over: []

phases:
  - exploitation
  - post-exploitation

requirements:
  network: true
  privileged: true

resources:
  memory_mb: 512
  cpu: 1.0

methods:
  run_python:
    description: "Execute a Python exploit script"
    when_to_use: "To run Python-based CVE exploits or PoCs"
    params:
      script:
        type: string
        required: true
        description: "Python script content or path"
      args:
        type: array
        description: "Command line arguments for the script"
      is_path:
        type: boolean
        default: false
        description: "Whether script is a file path"
      is_base64:
        type: boolean
        default: false
        description: "Whether script content is base64 encoded"
      python_version:
        type: enum
        values: [python3, python2]
        default: "python3"
        description: "Python version to use"
      timeout:
        type: integer
        default: 120
        description: "Execution timeout in seconds"
      env:
        type: object
        description: "Environment variables to set"
    returns:
      returncode:
        type: integer
        description: "Exit code"
      stdout:
        type: string
        description: "Standard output"
      stderr:
        type: string
        description: "Standard error"

  run_shell:
    description: "Execute a shell script or command"
    when_to_use: "To run shell-based exploits"
    params:
      script:
        type: string
        required: true
        description: "Shell script content"
      args:
        type: array
        description: "Command line arguments"
      shell:
        type: enum
        values: [bash, sh, zsh]
        default: "bash"
        description: "Shell to use"
      timeout:
        type: integer
        default: 120
        description: "Execution timeout"
      env:
        type: object
        description: "Environment variables"
    returns:
      returncode:
        type: integer
        description: "Exit code"
      stdout:
        type: string
        description: "Standard output"
      stderr:
        type: string
        description: "Standard error"

  run_ruby:
    description: "Execute a Ruby exploit script"
    when_to_use: "To run Ruby-based exploits (many Metasploit modules)"
    params:
      script:
        type: string
        required: true
        description: "Ruby script content or path"
      args:
        type: array
        description: "Command line arguments"
      is_path:
        type: boolean
        default: false
        description: "Whether script is a file path"
      timeout:
        type: integer
        default: 120
        description: "Execution timeout"
      env:
        type: object
        description: "Environment variables to set"
    returns:
      returncode:
        type: integer
        description: "Exit code"
      stdout:
        type: string
        description: "Standard output"
      stderr:
        type: string
        description: "Standard error"

  prepare_exploit:
    description: "Prepare exploit by saving and setting up dependencies"
    when_to_use: "To save exploit for repeated execution"
    params:
      content:
        type: string
        required: true
        description: "Exploit script content"
      filename:
        type: string
        required: true
        description: "Filename to save as"
      is_base64:
        type: boolean
        default: false
        description: "Whether content is base64 encoded"
      requirements:
        type: array
        description: "Python packages to install"
    returns:
      path:
        type: string
        description: "Saved exploit path"
      requirements_installed:
        type: array
        description: "Installed packages"

  list_exploits:
    description: "List prepared exploits in workspace"
    when_to_use: "To see available prepared exploits"
    params: {}
    returns:
      exploits:
        type: array
        description: "List of prepared exploits"

  analyze_exploit:
    description: "Analyze an exploit script for safety and requirements"
    when_to_use: "Before running to understand what exploit does"
    params:
      script:
        type: string
        required: true
        description: "Exploit script content"
      language:
        type: enum
        values: [python, ruby, shell, auto]
        default: "auto"
        description: "Script language"
    returns:
      language:
        type: string
        description: "Detected language"
      imports:
        type: array
        description: "Imported modules"
      dangerous_patterns:
        type: array
        description: "Potentially dangerous operations"
      likely_requirements:
        type: array
        description: "Likely pip requirements"

  # Template-based exploit methods
  list_templates:
    description: "List available parameterized exploit templates"
    when_to_use: "To see what CVE exploits are available as templates"
    params:
      cve:
        type: string
        description: "Filter by CVE ID"
      software:
        type: string
        description: "Filter by affected software"
      severity:
        type: string
        enum: [critical, high, medium, low]
        description: "Filter by severity"
      tag:
        type: string
        description: "Filter by tag"
    returns:
      templates:
        type: array
        description: "List of exploit templates"
      total:
        type: integer
        description: "Number of templates found"

  get_template:
    description: "Get details of a specific exploit template"
    when_to_use: "To see what parameters an exploit template needs"
    params:
      template_id:
        type: string
        required: true
        description: "Template ID"
    returns:
      id:
        type: string
        description: "Template ID"
      name:
        type: string
        description: "Template name"
      cve:
        type: string
        description: "CVE identifier"
      parameters:
        type: array
        description: "Required parameters"
      description:
        type: string
        description: "Full description"

  search_templates:
    description: "Search for exploit templates by software/version"
    when_to_use: "To find exploits for a specific software you discovered"
    params:
      software:
        type: string
        required: true
        description: "Software name (e.g., 'jenkins', 'log4j')"
      version:
        type: string
        description: "Version string"
    returns:
      matches:
        type: array
        description: "Matching templates"
      total:
        type: integer
        description: "Number of matches"

  run_template:
    description: "Execute an exploit template with parameters"
    when_to_use: "To run a CVE exploit by filling in target-specific parameters"
    params:
      template_id:
        type: string
        required: true
        description: "Template ID (e.g., 'log4shell', 'cacti-cmd-injection')"
      params:
        type: object
        required: true
        description: "Exploit parameters (target_url, command, etc.)"
      timeout:
        type: integer
        default: 120
        description: "Execution timeout"
    returns:
      output:
        type: string
        description: "Exploit output"
      success:
        type: boolean
        description: "Whether exploit succeeded"
      indicators_matched:
        type: array
        description: "Success indicators found in output"

  generate_payload:
    description: "Generate a payload for use with exploits"
    when_to_use: "To create reverse shell or command payloads"
    params:
      payload_type:
        type: string
        required: true
        enum: [reverse_shell, bind_shell, command]
        description: "Type of payload"
      lhost:
        type: string
        description: "Attacker IP for reverse shells"
      lport:
        type: integer
        description: "Attacker port"
      command:
        type: string
        description: "Command for command payloads"
      language:
        type: string
        default: "bash"
        enum: [bash, python, php]
        description: "Payload language"
    returns:
      payload:
        type: string
        description: "Generated payload"
      payload_base64:
        type: string
        description: "Base64 encoded payload"

# =============================================================================
# IKE / IPSEC / VPN
# =============================================================================
