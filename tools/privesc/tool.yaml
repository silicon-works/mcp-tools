name: privesc
version: "1.0"
description: "Privilege escalation enumeration and exploit suggestion"
image: "ghcr.io/silicon-works/mcp-tools-privesc:latest"
image_size_mb: 200

capabilities:
  - privilege_escalation_enumeration
  - suid_analysis
  - sudo_analysis
  - capability_analysis
  - cve_lookup

phases:
  - post-exploitation

requirements:
  network: false
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

# Routing hints for tool selection
routing:
  use_for:
    - "privilege escalation enumeration"
    - "SUID binary analysis"
    - "sudo misconfiguration"
    - "capability analysis"
    - "cron job enumeration"
    - "Linux privilege escalation"
  never_use_for:
    - "remote scanning"
    - "initial access"
    - "port scanning"
  triggers:
    - "privilege escalation"
    - "privesc"
    - "SUID"
    - "sudo"
    - "linpeas"
    - "root access"
    - "escalate"

methods:
  enumerate:
    description: "Run comprehensive privilege escalation enumeration"
    when_to_use: "After gaining initial access to find privilege escalation paths"
    params:
      checks:
        type: array
        description: "Specific checks to run (default: all)"
      quick:
        type: boolean
        default: false
        description: "Run quick enumeration only"
    returns:
      suid_binaries:
        type: array
        description: "SUID binaries found"
      sudo_rights:
        type: array
        description: "Sudo permissions"
      capabilities:
        type: array
        description: "Files with capabilities"
      writable_paths:
        type: array
        description: "Writable sensitive paths"
      cron_jobs:
        type: array
        description: "Cron jobs found"

  check_suid:
    description: "Find SUID/SGID binaries"
    when_to_use: "To find binaries that may allow privilege escalation"
    params: {}
    returns:
      suid_binaries:
        type: array
        description: "SUID binaries with GTFOBins status"

  check_sudo:
    description: "Check sudo permissions"
    when_to_use: "To find sudo misconfigurations"
    params: {}
    returns:
      sudo_rights:
        type: array
        description: "Sudo permissions and exploit potential"

  check_capabilities:
    description: "Find files with special capabilities"
    when_to_use: "To find capability-based privilege escalation"
    params: {}
    returns:
      capabilities:
        type: array
        description: "Files with capabilities"

  check_cron:
    description: "Enumerate cron jobs"
    when_to_use: "To find cron-based privilege escalation"
    params: {}
    returns:
      cron_jobs:
        type: array
        description: "Cron jobs with analysis"

  check_writable:
    description: "Find writable sensitive paths"
    when_to_use: "To find writable files that may allow privilege escalation"
    params: {}
    returns:
      writable_paths:
        type: array
        description: "Writable sensitive files and directories"

  suggest_exploits:
    description: "Suggest privilege escalation exploits based on system info"
    when_to_use: "To get exploit suggestions for the target system"
    params:
      kernel_version:
        type: string
        description: "Kernel version (from uname -r)"
      distro:
        type: string
        description: "Distribution info (from /etc/os-release)"
      installed_software:
        type: array
        description: "List of installed software with versions (e.g., ['netdata 1.45.2', 'sudo 1.8.31'])"
    returns:
      suggestions:
        type: array
        description: "Suggested exploits with CVE references"
      count:
        type: integer
        description: "Number of suggestions found"

  get_linpeas:
    description: "Get linpeas.sh script content"
    when_to_use: "To run comprehensive Linux enumeration"
    params: {}
    returns:
      script:
        type: string
        description: "linpeas.sh script content"
      size:
        type: integer
        description: "Script size in bytes"

  get_lse:
    description: "Get linux-smart-enumeration script content"
    when_to_use: "To run targeted Linux enumeration"
    params: {}
    returns:
      script:
        type: string
        description: "lse.sh script content"
      size:
        type: integer
        description: "Script size in bytes"
