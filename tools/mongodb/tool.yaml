name: mongodb
version: "1.0"
description: "MongoDB client for database enumeration and data extraction"
image: "ghcr.io/silicon-works/mcp-tools-mongodb:latest"
image_size_mb: 250

capabilities:
  - database_enumeration
  - nosql_access
  - credential_extraction
  - data_exfiltration

phases:
  - enumeration
  - post-exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

# Routing hints for tool selection
routing:
  use_for:
    - "MongoDB database access"
    - "NoSQL enumeration"
    - "MongoDB data extraction"
    - "MongoDB credential search"
  never_use_for:
    - "SQL databases (use mysql or sqlite)"
    - "NoSQL injection (use nosqlmap)"
    - "port scanning"
  triggers:
    - "MongoDB"
    - "NoSQL"
    - "mongo"
    - "port 27017"
    - "BSON"

methods:
  connect:
    description: "Test connection to a MongoDB server"
    when_to_use: "To verify MongoDB is accessible and check authentication requirements"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
      timeout:
        type: integer
        default: 5
        description: "Connection timeout in seconds"
    returns:
      connected:
        type: boolean
        description: "Whether connection succeeded"
      version:
        type: string
        description: "MongoDB server version"

  list_databases:
    description: "List all databases on the MongoDB server"
    when_to_use: "To enumerate available databases"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      databases:
        type: array
        description: "List of databases with size info"

  list_collections:
    description: "List all collections in a database"
    when_to_use: "To enumerate collections after identifying a target database"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      database:
        type: string
        required: true
        description: "Database name"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      collections:
        type: array
        description: "List of collection names"

  query:
    description: "Query documents from a collection using MongoDB filter syntax"
    when_to_use: "To retrieve specific documents with filter criteria"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      database:
        type: string
        required: true
        description: "Database name"
      collection:
        type: string
        required: true
        description: "Collection name"
      filter:
        type: object
        default: {}
        description: "MongoDB query filter (JSON)"
      projection:
        type: object
        description: "Fields to include/exclude"
      limit:
        type: integer
        default: 100
        description: "Maximum documents to return"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      documents:
        type: array
        description: "Matching documents"
      count:
        type: integer
        description: "Number of documents returned"

  dump_collection:
    description: "Dump all documents from a collection"
    when_to_use: "To extract all data from a collection"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      database:
        type: string
        required: true
        description: "Database name"
      collection:
        type: string
        required: true
        description: "Collection name"
      limit:
        type: integer
        default: 100
        description: "Maximum documents to return"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      documents:
        type: array
        description: "All documents in collection"

  find_credentials:
    description: "Search for credential-like data across collections"
    when_to_use: "To search for stored passwords, tokens, or auth data"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      database:
        type: string
        description: "Database to search (searches all if not specified)"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      findings:
        type: array
        description: "Collections with potential credentials"

  server_info:
    description: "Get MongoDB server information and version"
    when_to_use: "To fingerprint the MongoDB installation"
    params:
      host:
        type: string
        required: true
        description: "MongoDB hostname or IP"
      port:
        type: integer
        default: 27017
        description: "MongoDB port"
      username:
        type: string
        description: "Username for authentication (optional)"
      password:
        type: string
        description: "Password for authentication (optional)"
      auth_db:
        type: string
        default: admin
        description: "Authentication database"
    returns:
      version:
        type: string
        description: "MongoDB version"
      storage_engines:
        type: array
        description: "Available storage engines"
