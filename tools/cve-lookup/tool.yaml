name: cve-lookup
version: "1.0"
description: "CVE lookup and vulnerability research using NVD API"
image: "ghcr.io/silicon-works/mcp-tools-cve-lookup:latest"
image_size_mb: 100

capabilities:
  - cve_lookup
  - vulnerability_search
  - exploit_research
  - cvss_scoring

phases:
  - enumeration
  - exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 128
  cpu: 0.25

# Routing hints for tool selection
routing:
  use_for:
    - "CVE lookup"
    - "vulnerability research"
    - "exploit search"
    - "CVSS scoring"
    - "vulnerability details"
  never_use_for:
    - "active scanning"
    - "exploitation"
    - "port scanning"
  triggers:
    - "CVE"
    - "vulnerability lookup"
    - "NVD"
    - "exploit search"
    - "CVSS"
    - "vulnerability research"
  prefer_over:
    - searchsploit  # For CVE details and CVSS context

environment:
  NVD_API_KEY:
    description: "Optional NVD API key for higher rate limits"
    required: false

methods:
  lookup:
    description: "Look up a specific CVE by ID"
    when_to_use: "When you have a CVE ID and need full details"
    params:
      cve_id:
        type: string
        required: true
        description: "CVE ID (e.g., CVE-2024-32019)"
    returns:
      cve_id:
        type: string
        description: "CVE identifier"
      description:
        type: string
        description: "Vulnerability description"
      cvss_score:
        type: number
        description: "CVSS base score"
      cvss_severity:
        type: string
        description: "Severity level (LOW, MEDIUM, HIGH, CRITICAL)"
      affected_products:
        type: array
        description: "Affected products and versions"
      references:
        type: array
        description: "Reference URLs"

  search:
    description: "Search CVEs by product/keyword"
    when_to_use: "After fingerprinting to find vulnerabilities for detected software"
    params:
      keyword:
        type: string
        required: true
        description: "Search keyword (product name)"
      version:
        type: string
        description: "Product version to filter"
      severity:
        type: enum
        values: [LOW, MEDIUM, HIGH, CRITICAL]
        description: "Filter by severity"
      limit:
        type: integer
        default: 20
        description: "Maximum results"
      year:
        type: integer
        description: "Filter by year"
    returns:
      cves:
        type: array
        description: "Matching CVEs with scores and descriptions"
      total_results:
        type: integer
        description: "Total matching CVEs in NVD"

  recent:
    description: "Get recent CVEs from last 7 days"
    when_to_use: "To find newly disclosed vulnerabilities"
    params:
      severity:
        type: enum
        values: [LOW, MEDIUM, HIGH, CRITICAL]
        description: "Filter by severity"
      limit:
        type: integer
        default: 20
        description: "Maximum results"
    returns:
      cves:
        type: array
        description: "Recent CVEs"

  exploits:
    description: "Find known exploits for a CVE"
    when_to_use: "After finding relevant CVE to check for public exploits"
    params:
      cve_id:
        type: string
        required: true
        description: "CVE ID to search exploits for"
    returns:
      exploit_references:
        type: array
        description: "URLs to exploit code or PoCs"
      exploit_sources:
        type: array
        description: "Sources with exploits (ExploitDB, GitHub, etc.)"
      searchsploit_query:
        type: string
        description: "Query for searchsploit tool"
      metasploit_search:
        type: string
        description: "Metasploit search command"
