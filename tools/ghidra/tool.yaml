name: ghidra
version: "12.0"
description: "Ghidra reverse engineering framework for binary decompilation, disassembly, function analysis, and cross-reference mapping. Converts machine code to readable C pseudocode."
image: "ghcr.io/silicon-works/mcp-tools-ghidra:latest"
image_size_mb: 1500

capabilities:
  - decompilation
  - disassembly
  - binary_analysis
  - reverse_engineering
  - cross_references

routing:
  use_for:
    - "decompile binary to C code"
    - "reverse engineer executable"
    - "understand what a binary does"
    - "analyze ELF binary functions"
    - "find vulnerability in binary"
    - "list functions in executable"
    - "cross-reference analysis"
    - "binary reverse engineering"
    - "decompile SUID binary"
    - "static binary analysis"
  never_use_for:
    - "port scanning"
    - "web scanning"
    - "running exploits"
  triggers:
    - "decompile"
    - "reverse engineer"
    - "ghidra"
    - "disassemble"
    - "binary analysis"
  prefer_over: []

phases:
  - enumeration
  - exploitation

requirements:
  network: false
  privileged: false

resources:
  memory_mb: 4096
  cpu: 2.0

methods:
  load_binary:
    description: "Load a binary into Ghidra and run auto-analysis. Call this first before using other analysis methods — analysis can take 5-30s depending on binary size."
    when_to_use: "First step when you have a binary to analyze. Load it once, then use decompile_function, list_functions, etc. repeatedly without waiting again."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file to load and analyze (use /session/ path for files in session directory)"
    returns:
      binary_path:
        type: string
        description: "Path to the loaded binary"
      analyzed:
        type: boolean
        description: "Whether auto-analysis completed successfully"

  decompile_function:
    description: "Decompile a function to C pseudocode by name. Returns readable C code from machine code, making it easy to identify vulnerabilities like buffer overflows, format strings, and logic flaws."
    when_to_use: "After identifying a potentially vulnerable function (from strings, symbols, or function list) to understand its logic in C rather than reading raw assembly."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file to analyze (use /session/ path for files in session directory)"
      name:
        type: string
        required: true
        description: "Function name to decompile (e.g., 'main', 'vuln', 'check_password')"
    returns:
      decompiled:
        type: string
        description: "C pseudocode of the function"

  decompile_function_by_address:
    description: "Decompile a function at a specific memory address to C pseudocode. Use when you have an address but not a function name."
    when_to_use: "When you have a function address from xrefs, crash dumps, or disassembly but don't know the function name."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      address:
        type: string
        required: true
        description: "Function address in hex (e.g., '0x401234')"
    returns:
      decompiled:
        type: string
        description: "C pseudocode of the function"

  list_functions:
    description: "List all functions found in the binary with their addresses and sizes."
    when_to_use: "First step when analyzing an unknown binary — get an overview of all functions to identify interesting targets (main, custom functions, vulnerable-looking names like 'check_auth', 'handle_input')."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      offset:
        type: integer
        default: 0
        description: "Pagination offset for large binaries"
      limit:
        type: integer
        default: 100
        description: "Maximum number of functions to return"
    returns:
      functions:
        type: array
        description: "List of functions with name, address, size"

  search_functions_by_name:
    description: "Search for functions whose names contain a query string. Useful for finding functions related to specific functionality."
    when_to_use: "When looking for functions related to specific behavior (e.g., search 'auth' to find authentication functions, 'buf' to find buffer-related functions)."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      query:
        type: string
        required: true
        description: "Substring to search for in function names (e.g., 'auth', 'check', 'buf')"
    returns:
      functions:
        type: array
        description: "Matching functions with name and address"

  get_xrefs_to:
    description: "Get cross-references TO an address — shows what code calls or references this location."
    when_to_use: "To understand how a potentially vulnerable function is reached (call chain), or to find all callers of a dangerous function like system(), execve(), strcpy()."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      address:
        type: string
        required: true
        description: "Target address in hex (e.g., '0x401234') or function name"
    returns:
      xrefs:
        type: array
        description: "List of addresses/functions that reference this location"

  get_xrefs_from:
    description: "Get cross-references FROM an address — shows what this function/location calls or references."
    when_to_use: "To see what dangerous functions a target function calls (system, execve, strcpy, gets, printf with user input)."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      address:
        type: string
        required: true
        description: "Source address in hex (e.g., '0x401234') or function name"
    returns:
      xrefs:
        type: array
        description: "List of addresses/functions referenced by this location"

  list_strings:
    description: "Extract defined strings from the binary with their addresses. Finds URLs, passwords, error messages, format strings, /bin/sh, and other interesting constants."
    when_to_use: "To find interesting strings (URLs, passwords, error messages, format strings, /bin/sh) and trace them back to the functions that use them via xrefs."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      filter:
        type: string
        description: "Optional substring filter to narrow results (e.g., 'password', '/bin', 'http')"
      offset:
        type: integer
        default: 0
        description: "Pagination offset"
      limit:
        type: integer
        default: 100
        description: "Maximum strings to return"
    returns:
      strings:
        type: array
        description: "Strings with addresses"

  list_imports:
    description: "List imported functions (from libc, etc.) with their addresses. Shows what external functions the binary uses."
    when_to_use: "To identify dangerous imports (gets, strcpy, printf, system) that indicate vulnerability types, and to get addresses needed for ROP chains and GOT overwrite attacks."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
    returns:
      imports:
        type: array
        description: "Imported functions with names and addresses"

  list_exports:
    description: "List exported symbols from the binary."
    when_to_use: "To see what symbols the binary exports — useful for shared libraries or to find entry points."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
    returns:
      exports:
        type: array
        description: "Exported symbols with names and addresses"

  list_segments:
    description: "List memory segments (sections) of the binary with permissions."
    when_to_use: "To understand memory layout — which segments are executable (for shellcode), writable (for overwrites), or both (W+X = exploitable)."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
    returns:
      segments:
        type: array
        description: "Segments with name, address, size, permissions"

  disassemble_function:
    description: "Get the assembly code for a function. Returns raw assembly instructions with addresses."
    when_to_use: "When you need exact assembly instructions (e.g., to verify ROP gadgets, understand calling convention, or check instruction alignment). Prefer decompile_function for general understanding."
    params:
      binary_path:
        type: string
        required: true
        description: "Path to the binary file"
      address:
        type: string
        required: true
        description: "Function address in hex"
    returns:
      assembly:
        type: string
        description: "Assembly code listing"
