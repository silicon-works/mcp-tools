name: netexec
version: "1.5.0"
description: "Network execution tool (NetExec/nxc v1.5.0, CrackMapExec successor, codename Yippie-Ki-Yay) for credential validation, authenticated command execution, credential dumping, AD enumeration, and Kerberos attacks across 10 protocols: SMB, WinRM, LDAP, MSSQL, WMI, RDP, SSH, FTP, NFS, VNC. 7 MCP methods covering the most critical protocols. Supports password, NTLM pass-the-hash (-H), Kerberos (-k/--use-kcache), AES key, and certificate authentication. 70+ built-in modules for SMB including lsassy, enum_av, spider_plus, zerologon, nopac, printnightmare, bloodhound, masky, nanodump. Output markers: [+] success, [-] failure, (Pwn3d!) admin access. Default 256 concurrent threads. Maintained by @NeffIsBack, @MJHallenbeck, @_zblurx."
image: "ghcr.io/silicon-works/mcp-tools-netexec:latest"
image_size_mb: 800
timeout_seconds: 300

capabilities:
  - credential_validation
  - authenticated_execution
  - credential_dumping
  - share_enumeration
  - ad_enumeration
  - pass_the_hash
  - kerberoasting
  - bloodhound

phases:
  - enumeration
  - exploitation
  - post-exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 512
  cpu: 1.0

routing:
  use_for:
    - "credential validation across multiple protocols (SMB, WinRM, LDAP, MSSQL, RDP, SSH, WMI)"
    - "WinRM command execution and credential dumping (SAM/LSA/DPAPI)"
    - "crackmapexec replacement for credential spraying and pass-the-hash"
    - "pass-the-hash validation against SMB/WinRM/LDAP/MSSQL/RDP/WMI"
    - "SMB authenticated share enumeration, spidering, and file transfer"
    - "credential spraying with --no-bruteforce and --continue-on-success"
    - "SAM/LSA/NTDS/DPAPI credential dumping from Windows targets"
    - "kerberoasting and AS-REP roasting via LDAP"
    - "BloodHound AD data collection (Group, LocalAdmin, Session, Trusts, All)"
    - "AD user/group/computer/delegation enumeration via LDAP"
    - "WMI command execution via DCOM (port 135) as SMB alternative"
    - "RID brute force user discovery via SMB or MSSQL"
    - "share spidering with spider_plus module for file discovery"
    - "netexec module execution (lsassy, enum_av, zerologon, nopac, masky)"
    - "MSSQL xp_cmdshell command execution and SQL queries"
    - "RDP credential validation and screenshot capture"
    - "SSH credential validation, sudo check, and command execution"
    - "SMB signing check for relay attack targeting (--gen-relay-list)"
  never_use_for:
    - "port scanning (use nmap)"
    - "web application testing (use ffuf, nikto, zap)"
    - "SQL injection (use sqlmap)"
    - "vulnerability scanning (use nuclei, nikto)"
    - "SSH brute-force (use hydra for wordlist attacks)"
  triggers:
    - "netexec"
    - "nxc"
    - "crackmapexec"
    - "cme"
    - "evil-winrm"
    - "winrm exec"
    - "credential spray"
    - "credential validation"
    - "pass-the-hash"
    - "sam dump"
    - "lsa dump"
    - "ntds dump"
    - "kerberoast"
    - "asreproast"
    - "bloodhound"
    - "wmiexec"
    - "dpapi dump"
    - "lsassy"
    - "rid brute"
    - "share spider"
  prefer_over: []

see_also:
  - tool: impacket
    reason: "wmiexec/psexec/secretsdump for non-NetExec remote execution and Kerberos ticket operations"
  - tool: evil-winrm
    reason: "Dedicated WinRM shell with pywinrm for file upload/download via PowerShell base64 chunking"

methods:
  smb:
    required_ports: [445]
    description: "SMB operations via NetExec: credential validation (password/hash/Kerberos), share enumeration with access-level filtering (READ/WRITE), user/group/computer enumeration, credential dumping (SAM via regdump/secdump, LSA secrets, NTDS.dit via DRSUAPI/VSS, DPAPI/cookies, SCCM), command execution (CMD -x / PowerShell -X) via wmiexec/atexec/smbexec/mmcexec, file transfer (--put-file/--get-file), share spidering with pattern/regex matching, RID brute force, SMB session enumeration, logged-on user detection, WMI queries, and 70+ module execution. Output includes (Pwn3d!) marker when admin access is confirmed."
    when_to_use: "Primary Windows credential validation and post-exploitation method when port 445 is open. Use for: (1) Validate discovered credentials or hashes — check for (Pwn3d!) admin marker, (2) Enumerate shares with --shares to find readable/writable shares, (3) Dump credentials with --sam/--lsa/--ntds after gaining admin access, (4) Execute commands via -x (CMD) or -X (PowerShell) with admin privileges, (5) Spider writable shares for sensitive files (passwords, configs, keys), (6) Run modules like lsassy for in-memory credential extraction without touching disk, (7) RID brute force when LDAP is not available for user discovery. For non-admin credential validation, any successful [+] output confirms valid credentials."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), CIDR range(s), or file containing targets (one per line). Supports NMap XML and .Nessus input files."
      username:
        type: string
        required: true
        description: "Username(s) or file containing usernames. Accepts single user or space-separated list. For credential spraying, combine with password file."
      password:
        type: string
        description: "Password(s) or file containing passwords. Used with -p flag. Provide either password or hash, not both."
      hash:
        type: string
        description: "NTLM hash(es) for pass-the-hash authentication (-H flag). Format: LM:NT or bare NT hash. Supports file of hashes. Mutually exclusive with password."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Mutually exclusive with local_auth. Omit for domain auto-detection."
      local_auth:
        type: boolean
        description: "Authenticate to local SAM database (--local-auth). Mutually exclusive with domain. Use for local admin accounts that aren't domain accounts."
      port:
        type: integer
        description: "SMB port (default: 445). Change only for non-standard SMB configurations."
      command:
        type: string
        description: "CMD command to execute on target via -x flag. Requires admin access (Pwn3d!). Default exec method: wmiexec. Output returned unless --no-output."
      ps_command:
        type: string
        description: "PowerShell command to execute on target via -X flag. Requires admin access. Supports --obfs for obfuscation, --amsi-bypass, --force-ps32, --no-encode."
      exec_method:
        type: string
        description: "Execution method for commands: wmiexec (default, uses Win32_Process+StdRegProv), atexec (scheduled task), smbexec (service creation), mmcexec (MMC20.Application DCOM). Each has different stealth/reliability tradeoffs."
      shares:
        type: boolean
        description: "Enumerate SMB shares and access levels (--shares). Shows READ/WRITE permissions per share. Low-privilege operation, no admin required."
      spider:
        type: string
        description: "Spider a share for files (--spider SHARE). Default: C$. Use with --depth, --pattern/--regex for targeted file search. spider_plus module recommended for large-scale spidering."
      sam:
        type: boolean
        description: "Dump SAM hashes from target (--sam). Requires admin access. Dumps local user NTLM hashes. Methods: regdump (default) or secdump."
      lsa:
        type: boolean
        description: "Dump LSA secrets from target (--lsa). Requires admin access. Reveals service account passwords, cached domain credentials, DPAPI keys."
      ntds:
        type: string
        description: "Dump NTDS.dit domain hashes from DC (--ntds METHOD). Methods: 'drsuapi' (default, DCSync-like) or 'vss' (Volume Shadow Copy). Requires Domain Admin. Use --history for password history, --enabled for active accounts only, --user for specific user."
      users:
        type: boolean
        description: "Enumerate domain users via SMB (--users). Returns sAMAccountName, description, badPwdCount, lastLogon. Use --users-export for file output."
      groups:
        type: string
        description: "Enumerate domain groups (--groups). Optionally specify group name to enumerate members (e.g., 'Domain Admins'). Supports --local-groups for local groups."
      rid_brute:
        type: integer
        description: "RID brute force user discovery (--rid-brute MAX_RID). Default max: 4000. Works without domain credentials. Use when LDAP access is blocked."
      pass_pol:
        type: boolean
        description: "Dump domain password policy (--pass-pol). Shows min/max password age, length requirements, lockout threshold. Essential before credential spraying."
      put_file:
        type: array
        description: "Upload local file to target (--put-file SRC DEST). Array of [local_path, remote_path]. Example: ['/tmp/shell.exe', 'C:\\Windows\\Temp\\shell.exe']. Requires write access to destination."
      get_file:
        type: array
        description: "Download file from target (--get-file SRC DEST). Array of [remote_path, local_path]. Example: ['C:\\Windows\\Temp\\flag.txt', '/session/artifacts/flag.txt']."
      module:
        type: string
        description: "NetExec module to run (-M MODULE). Key modules: lsassy (LSASS credential dump), enum_av (endpoint protection detection), spider_plus (recursive file listing to JSON), zerologon (CVE-2020-1472 check), nopac (CVE-2021-42278/42287), printnightmare, masky (ADCS credential dump), nanodump (LSASS minidump), enum_dns (WMI DNS dump), keepass_discover, wcc (security config check)."
      module_options:
        type: string
        description: "Module options (-o KEY=VALUE). Example for spider_plus: 'MAX_FILE_SIZE=50000 OUTPUT_FOLDER=/session/artifacts'. Multiple options space-separated."

  winrm:
    required_ports: [5985, 5986]
    description: "WinRM credential validation, command execution (CMD -x / PowerShell -X), and credential dumping (SAM/LSA/DPAPI) via Windows Remote Management. Checks both HTTP (5985) and HTTPS (5986) by default. Supports NTLM pass-the-hash. Dump method selectable: cmd or powershell (--dump-method). Returns (Pwn3d!) when user is in Remote Management Users or Administrators group."
    when_to_use: "When port 5985/5986 is open and you have valid credentials. Primary use cases: (1) Validate credentials against WinRM when SMB (445) is filtered or blocked, (2) Execute commands for post-exploitation when WinRM is the only available protocol, (3) Dump SAM/LSA/DPAPI secrets via WinRM when SMB is not available. WinRM access requires membership in 'Remote Management Users' or 'Administrators' group. For dedicated WinRM shell with file transfer, consider evil-winrm tool instead."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), CIDR range(s), or file containing targets."
      username:
        type: string
        required: true
        description: "Username(s) or file containing usernames."
      password:
        type: string
        description: "Password for authentication. Provide either password or hash, not both."
      hash:
        type: string
        description: "NTLM hash(es) for pass-the-hash (-H flag). Format: LM:NT or bare NT hash."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Mutually exclusive with local_auth."
      local_auth:
        type: boolean
        description: "Authenticate to local accounts (--local-auth). Mutually exclusive with domain."
      port:
        type: string
        description: "WinRM port(s) (--port). Format: 'http-port https-port' space-separated or single port for both. Default: '5985 5986'. Use --check-proto to limit to http or https."
      command:
        type: string
        description: "CMD command to execute (-x flag). Requires admin or Remote Management Users membership."
      ps_command:
        type: string
        description: "PowerShell command to execute (-X flag). Requires admin or Remote Management Users membership."
      sam:
        type: boolean
        description: "Dump SAM hashes via WinRM (--sam). Requires admin. Uses --dump-method cmd or powershell internally."
      lsa:
        type: boolean
        description: "Dump LSA secrets via WinRM (--lsa). Requires admin. Reveals service account passwords and cached credentials."
      dpapi:
        type: boolean
        description: "Dump DPAPI/Credential Manager secrets via WinRM (--dpapi). Reveals saved Windows credentials, browser passwords, Wi-Fi keys."

  ldap:
    required_ports: [389, 636]
    description: "LDAP/Active Directory enumeration: user/group/computer discovery, delegation relationships, password policy, Kerberoasting (TGS hash extraction), AS-REP Roasting (AS-REP hash extraction for accounts without pre-auth), BloodHound data collection (Group/LocalAdmin/Session/Trusts/Default/All), GMSA password extraction, adminCount enumeration, custom LDAP queries, domain SID retrieval, and Fine-Grained Password Policy (PSO) enumeration. Supports NTLM pass-the-hash and simple bind authentication."
    when_to_use: "Primary Active Directory intelligence gathering protocol. Use when port 389/636 is open on a Domain Controller and you have valid domain credentials. Key use cases: (1) Enumerate all domain users (--users) and groups (--groups) for target identification, (2) Kerberoast service accounts (--kerberoasting) to extract TGS hashes for offline cracking, (3) AS-REP roast accounts without Kerberos pre-auth (--asreproast), (4) Run BloodHound ingestor (--bloodhound -c All) for attack path analysis, (5) Find delegation relationships (--find-delegation) for privilege escalation, (6) Enumerate GMSA passwords (--gmsa) for service account takeover, (7) Get adminCount=1 users (--admin-count) to identify high-value targets. LDAP does NOT require Kerberos port 88 — it connects directly to the DC's LDAP service."
    params:
      target:
        type: string
        required: true
        description: "Target Domain Controller IP or hostname. Must be a DC for AD enumeration."
      username:
        type: string
        required: true
        description: "Domain username for authenticated LDAP bind."
      password:
        type: string
        description: "Domain password. Provide either password or hash, not both."
      hash:
        type: string
        description: "NTLM hash for pass-the-hash (-H flag). Mutually exclusive with --simple-bind."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Often auto-detected from DC."
      port:
        type: integer
        description: "LDAP port (default: 389). Use 636 for LDAPS (SSL/TLS)."
      users:
        type: boolean
        description: "Enumerate domain users (--users). Returns sAMAccountName, description, memberOf, lastLogon, badPwdCount. Use --users-export for file output."
      groups:
        type: boolean
        description: "Enumerate domain groups (--groups). Optionally specify group name for member enumeration."
      computers:
        type: boolean
        description: "Enumerate domain computers (--computers). Returns hostname, OS, OS version."
      dc_list:
        type: boolean
        description: "List all Domain Controllers (--dc-list). Returns DC hostnames and IPs."
      pass_pol:
        type: boolean
        description: "Dump domain password policy (--pass-pol). Shows lockout threshold, min length, complexity. Check before credential spraying to avoid lockouts."
      find_delegation:
        type: boolean
        description: "Find all delegation relationships (--find-delegation). Reveals unconstrained, constrained, and resource-based constrained delegation for privilege escalation paths. Only shows enabled accounts."
      admin_count:
        type: boolean
        description: "Get users with adminCount=1 (--admin-count). Identifies accounts that are or were members of privileged AD groups (Domain Admins, Enterprise Admins, etc.)."
      gmsa:
        type: boolean
        description: "Enumerate and extract Group Managed Service Account passwords (--gmsa). If you have read access to the msDS-ManagedPassword attribute, extracts the NTLM hash."
      kerberoasting:
        type: string
        description: "Kerberoast — extract TGS hashes for offline cracking (--kerberoasting OUTPUT_FILE). Targets accounts with SPNs set. Output in hashcat/john format. Use --kerberoast-account for targeted kerberoasting."
      asreproast:
        type: string
        description: "AS-REP roast — extract hashes for accounts without Kerberos pre-auth (--asreproast OUTPUT_FILE). Output in hashcat format (18200). Works against accounts with 'Do not require Kerberos preauthentication' flag."
      bloodhound:
        type: boolean
        description: "Run BloodHound data ingestor (--bloodhound). Collects AD relationships for attack path analysis. Default collection: Default. Outputs JSON files for BloodHound import."
      bloodhound_collection:
        type: string
        description: "BloodHound collection type (-c flag). Options: Group, LocalAdmin, Session, Trusts, Default, DCOnly, DCOM, RDP, PSRemote, LoggedOn, Container, ObjectProps, ACL, All. Comma-separated for multiple. 'All' is most comprehensive but slowest."
      query:
        type: array
        description: "Custom LDAP query (--query FILTER ATTRIBUTES). Array of [filter, attributes]. Example: ['(servicePrincipalName=*)', 'sAMAccountName servicePrincipalName']. Use --base-dn to change search root."

  mssql:
    required_ports: [1433]
    description: "MSSQL credential validation, SQL query execution (-q), OS command execution via xp_cmdshell (CMD -x / PowerShell -X), file transfer (--put-file/--get-file), SAM/LSA credential dumping, and RID brute force user discovery. Supports domain auth, local SQL auth (--local-auth for sa account), and NTLM pass-the-hash. xp_cmdshell requires sysadmin role or xp_cmdshell enabled."
    when_to_use: "When port 1433 is open (MSSQL). Use for: (1) Validate SQL credentials — check for [+] and sysadmin role indicator, (2) Execute SQL queries (-q 'SELECT ...') for data extraction, (3) Run OS commands via xp_cmdshell (-x) when you have sysadmin privileges, (4) Transfer files via --put-file/--get-file for payload delivery, (5) RID brute force (--rid-brute) for user discovery through MSSQL, (6) Dump SAM/LSA if xp_cmdshell is available. For SQL injection, use sqlmap instead."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), or file containing targets."
      username:
        type: string
        required: true
        description: "Username. Use 'sa' for default SQL Server admin account with --local-auth."
      password:
        type: string
        description: "Password for authentication."
      hash:
        type: string
        description: "NTLM hash for pass-the-hash (-H flag). Format: LM:NT or bare NT hash."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Mutually exclusive with local_auth."
      local_auth:
        type: boolean
        description: "SQL Server authentication (--local-auth). Use for local SQL accounts like 'sa'. Mutually exclusive with domain."
      port:
        type: integer
        description: "MSSQL port (default: 1433). Change for non-standard SQL Server instances."
      command:
        type: string
        description: "OS command to execute via xp_cmdshell (-x flag). Requires sysadmin role. NetExec auto-enables xp_cmdshell if disabled."
      ps_command:
        type: string
        description: "PowerShell command to execute via xp_cmdshell (-X flag). Requires sysadmin role. Supports --obfs, --amsi-bypass, --force-ps32."
      query:
        type: string
        description: "SQL query to execute (-q flag). Example: 'SELECT name FROM sys.databases' or 'SELECT * FROM openquery(...)'. Returns query results in output."
      database:
        type: string
        description: "List tables for a specific database (--database NAME), or omit value to list all databases (--database)."
      put_file:
        type: array
        description: "Upload file to target via MSSQL (--put-file SRC DEST). Array of [local_path, remote_path]. Example: ['shell.exe', 'C:\\Windows\\Temp\\shell.exe']."
      get_file:
        type: array
        description: "Download file from target via MSSQL (--get-file SRC DEST). Array of [remote_path, local_path]."
      rid_brute:
        type: integer
        description: "RID brute force user discovery via MSSQL (--rid-brute MAX_RID). Default max: 4000. Works when LDAP is blocked."

  ssh:
    required_ports: [22]
    description: "SSH credential validation (password or private key), command execution (-x), sudo privilege check (--sudo-check via sudo-stdin or mkfifo methods), and file transfer (--put-file/--get-file). Supports --key-file for private key authentication where password becomes the key passphrase. Does not support NTLM or pass-the-hash (SSH uses its own key-based auth)."
    when_to_use: "When port 22 is open on Linux/Unix targets. Use for: (1) Validate discovered SSH credentials — [+] indicates valid login, (2) Check if user has sudo privileges (--sudo-check), (3) Execute commands after credential validation, (4) Transfer files to/from target. For SSH brute-force attacks against large wordlists, use hydra instead. For persistent interactive SSH sessions with file transfer and script execution, use the dedicated ssh tool."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), or file containing targets."
      username:
        type: string
        required: true
        description: "SSH username (e.g., 'root', 'www-data', discovered user from web exploit)."
      password:
        type: string
        description: "SSH password. When --key-file is used, this becomes the key's passphrase."
      key_file:
        type: string
        description: "Path to SSH private key file (--key-file). Password parameter becomes the key passphrase. Key must be accessible inside the container (/session/ prefix for session files)."
      port:
        type: integer
        description: "SSH port (default: 22). Change for non-standard SSH configurations discovered during nmap scanning."
      command:
        type: string
        description: "Command to execute via SSH (-x flag). Single command execution — for multiple commands, chain with && or ;."
      sudo_check:
        type: boolean
        description: "Check if user has sudo privileges (--sudo-check). Methods: sudo-stdin (default, stable) or mkfifo (less stable, may need retry). Essential for privilege escalation assessment."
      put_file:
        type: array
        description: "Upload file to target via SSH (--put-file SRC DEST). Array of [local_path, remote_path]. Example: ['/session/artifacts/linpeas.sh', '/tmp/linpeas.sh']."
      get_file:
        type: array
        description: "Download file from target via SSH (--get-file SRC DEST). Array of [remote_path, local_path]. Example: ['/home/user/flag.txt', '/session/artifacts/flag.txt']."

  rdp:
    required_ports: [3389]
    description: "RDP credential validation, command execution (CMD -x / PowerShell -X via clipboard injection), and screenshot capture on successful login. Supports NTLM pass-the-hash and domain/local authentication. Screenshots saved to screenshots/ directory. Command execution uses clipboard injection with configurable delays (--cmd-delay, --clipboard-delay). NLA (Network Level Authentication) screenshot supported for login prompts."
    when_to_use: "When port 3389 is open. Use for: (1) Validate RDP credentials — [+] indicates successful RDP authentication, (2) Capture screenshots of remote desktop (--screenshot) for intelligence gathering, (3) Execute commands via clipboard injection (-x/-X) when other execution methods are blocked. RDP command execution is slower and less reliable than SMB/WinRM/WMI — prefer those protocols for command execution when available. RDP validation confirms the user can actually RDP (not just has valid creds)."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), or file containing targets."
      username:
        type: string
        required: true
        description: "Username for RDP authentication."
      password:
        type: string
        description: "Password for authentication."
      hash:
        type: string
        description: "NTLM hash for pass-the-hash (-H flag). RDP restricted admin mode may be required for PTH."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Mutually exclusive with local_auth."
      local_auth:
        type: boolean
        description: "Authenticate with local accounts (--local-auth). Mutually exclusive with domain."
      port:
        type: integer
        description: "RDP port (default: 3389)."
      command:
        type: string
        description: "CMD command to execute via clipboard injection (-x flag). Slower than SMB/WinRM execution. Use --cmd-delay to adjust execution timing."
      ps_command:
        type: string
        description: "PowerShell command to execute via clipboard injection (-X flag). Slower than SMB/WinRM execution."
      screenshot:
        type: boolean
        description: "Capture screenshot of remote desktop on successful login (--screenshot). Default screen time: 10s, resolution: 1024x768. Screenshots saved to /root/.nxc/screenshots/."

  wmi:
    required_ports: [135]
    description: "WMI (Windows Management Instrumentation) credential validation, command execution (CMD -x / PowerShell -X), and arbitrary WMI queries via DCOM on port 135. Stealthier alternative to SMB for command execution — uses Win32_Process or WMI event subscriptions (T1546.003) instead of service creation. Two exec methods: wmiexec (default, uses registry for output retrieval) and wmiexec-event (stealthier, uses WMI event subscriptions but less stable on multiple hosts). Supports NTLM pass-the-hash. Port is fixed at 135 (DCOM/RPC)."
    when_to_use: "When SMB command execution is blocked, monitored, or generating alerts. WMI uses DCOM (port 135) which is often less monitored than SMB (445). Use for: (1) Validate credentials against WMI when testing access, (2) Execute commands via -x/-X as a stealthier alternative to SMB exec methods, (3) Run WMI queries (--wmi) for system enumeration (processes, services, installed software), (4) Use wmiexec-event method (--exec-method wmiexec-event) for stealthiest execution via T1546.003. Prefer wmiexec (default) for reliability on multiple hosts; use wmiexec-event for single-target stealth."
    params:
      target:
        type: string
        required: true
        description: "Target IP(s), hostname(s), or file containing targets."
      username:
        type: string
        required: true
        description: "Username for authentication."
      password:
        type: string
        description: "Password for authentication."
      hash:
        type: string
        description: "NTLM hash for pass-the-hash (-H flag). Format: LM:NT or bare NT hash."
      domain:
        type: string
        description: "Active Directory domain name (-d flag). Mutually exclusive with local_auth."
      local_auth:
        type: boolean
        description: "Authenticate with local accounts (--local-auth). Mutually exclusive with domain."
      command:
        type: string
        description: "CMD command to execute (-x flag). Creates Win32_Process. Output retrieved via registry (wmiexec) or event subscription (wmiexec-event)."
      ps_command:
        type: string
        description: "PowerShell command to execute (-X flag). Same execution methods as CMD."
      wmi_query:
        type: string
        description: "WMI query to execute (--wmi QUERY). Default namespace: root\\cimv2. Examples: 'SELECT * FROM Win32_Process', 'SELECT * FROM Win32_Service WHERE State=\"Running\"', 'SELECT * FROM Win32_Product'."
      exec_method:
        type: string
        description: "Execution method (--exec-method). Options: 'wmiexec' (default, Win32_Process + StdRegProv registry output, stable on multiple hosts) or 'wmiexec-event' (T1546.003 WMI event subscriptions, stealthier but less stable, recommend single host only)."
