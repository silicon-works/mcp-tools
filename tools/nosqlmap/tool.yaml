name: nosqlmap
version: "0.7"
description: "NoSQL injection and database takeover tool for MongoDB, CouchDB, and other NoSQL databases"
image: "ghcr.io/silicon-works/mcp-tools-nosqlmap:latest"
image_size_mb: 180

capabilities:
  - nosql_injection
  - mongodb_exploitation
  - database_enumeration
  - authentication_bypass

# Routing hints for tool selection
routing:
  use_for:
    - "NoSQL injection"
    - "MongoDB injection"
    - "authentication bypass"
    - "NoSQL database exploitation"
    - "$ne injection"
    - "$regex injection"
  never_use_for:
    - "SQL injection"
    - "MySQL"
    - "PostgreSQL"
    - "port scanning"
  triggers:
    - "nosql injection"
    - "mongodb injection"
    - "nosqlmap"
    - "$ne"
    - "$regex"
  prefer_over: []

phases:
  - exploitation

requirements:
  network: true
  privileged: false

resources:
  memory_mb: 256
  cpu: 0.5

methods:
  scan:
    description: "Scan a URL for NoSQL injection vulnerabilities"
    when_to_use: "When testing web forms or APIs that may use NoSQL backends"
    params:
      url:
        type: string
        required: true
        description: "Target URL to scan"
      method:
        type: enum
        values: [GET, POST]
        default: POST
        description: "HTTP method"
      params:
        type: object
        description: "Request parameters as key-value pairs"
      headers:
        type: object
        description: "Custom HTTP headers"
      cookie:
        type: string
        description: "Cookie header value for authenticated scans"
      timeout:
        type: integer
        default: 30
        description: "Request timeout in seconds"
    returns:
      vulnerable:
        type: boolean
        description: "Whether target appears vulnerable"
      injection_points:
        type: array
        description: "Parameters that appear injectable"
      findings:
        type: array
        description: "Detailed findings with payloads that worked"

  inject:
    description: "Exploit NoSQL injection to bypass authentication or extract data"
    when_to_use: "After confirming NoSQL injection vulnerability to exploit it"
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      method:
        type: enum
        values: [GET, POST]
        default: POST
        description: "HTTP method"
      injection_type:
        type: enum
        values: [auth_bypass, data_extraction, operator_injection, js_injection]
        default: auth_bypass
        description: "Type of injection to attempt"
      params:
        type: object
        description: "Base request parameters"
      inject_param:
        type: string
        required: true
        description: "Parameter to inject into"
      headers:
        type: object
        description: "Custom HTTP headers"
      cookie:
        type: string
        description: "Cookie header value"
    returns:
      success:
        type: boolean
        description: "Whether injection succeeded"
      response_data:
        type: string
        description: "Response from successful injection"
      payload_used:
        type: string
        description: "Payload that worked"

  test_payloads:
    description: "Test multiple NoSQL injection payloads against a target"
    when_to_use: "To systematically test various NoSQL injection techniques"
    params:
      url:
        type: string
        required: true
        description: "Target URL"
      method:
        type: enum
        values: [GET, POST]
        default: POST
        description: "HTTP method"
      params:
        type: object
        required: true
        description: "Base request parameters"
      test_param:
        type: string
        required: true
        description: "Parameter to test for injection"
      headers:
        type: object
        description: "Custom HTTP headers"
      cookie:
        type: string
        description: "Cookie header value"
      payload_types:
        type: array
        description: "Types of payloads to test: operator, regex, js, timing"
    returns:
      results:
        type: array
        description: "Results for each payload tested"
      vulnerable:
        type: boolean
        description: "Whether any injection succeeded"
      recommended_payload:
        type: string
        description: "Most effective payload found"
