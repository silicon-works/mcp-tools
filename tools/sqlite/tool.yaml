name: sqlite
version: "1.0"
description: "SQLite database client for extracting data from SQLite database files"
image: "ghcr.io/silicon-works/mcp-tools-sqlite:latest"
image_size_mb: 100

capabilities:
  - database_extraction
  - credential_extraction
  - data_analysis

phases:
  - post-exploitation

requirements:
  network: false
  privileged: false

resources:
  memory_mb: 128
  cpu: 0.25

# Routing hints for tool selection
routing:
  use_for:
    - "SQLite database extraction"
    - "local database analysis"
    - "SQLite credential extraction"
    - "SQLite file analysis"
  never_use_for:
    - "remote database access (use mysql or mongodb)"
    - "SQL injection (use sqlmap)"
    - "port scanning"
  triggers:
    - "SQLite"
    - ".db file"
    - ".sqlite"
    - "database file"
    - "local database"

methods:
  query:
    description: "Execute a SQL query on a SQLite database"
    when_to_use: "When you have access to a SQLite database file and need to extract data"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file, or base64-encoded database content"
      query:
        type: string
        required: true
        description: "SQL query to execute"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded file content"
      limit:
        type: integer
        default: 1000
        description: "Maximum rows to return"
    returns:
      columns:
        type: array
        description: "Column names"
      rows:
        type: array
        description: "Query results"
      row_count:
        type: integer
        description: "Number of rows returned"

  list_tables:
    description: "List all tables in a SQLite database"
    when_to_use: "Initial enumeration of a SQLite database"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file, or base64-encoded content"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded file content"
    returns:
      tables:
        type: array
        description: "List of tables with row counts"
      count:
        type: integer
        description: "Number of tables"

  describe_table:
    description: "Get schema/structure of a table"
    when_to_use: "To understand table structure before querying"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file"
      table:
        type: string
        required: true
        description: "Table name to describe"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded"
    returns:
      columns:
        type: array
        description: "Column definitions with types"
      row_count:
        type: integer
        description: "Number of rows in table"

  dump_table:
    description: "Dump all rows from a table"
    when_to_use: "To extract all data from a specific table"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file"
      table:
        type: string
        required: true
        description: "Table name to dump"
      columns:
        type: array
        description: "Specific columns to select (default: all)"
      limit:
        type: integer
        default: 100
        description: "Maximum rows to return"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded"
    returns:
      rows:
        type: array
        description: "Table contents"
      row_count:
        type: integer
        description: "Number of rows returned"

  find_credentials:
    description: "Search for credential-related tables and extract potential usernames/passwords"
    when_to_use: "To quickly find and extract credentials from a SQLite database"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded"
      limit:
        type: integer
        default: 100
        description: "Maximum rows to return per table"
    returns:
      credential_tables:
        type: array
        description: "Tables that may contain credentials"
      credentials:
        type: array
        description: "Extracted username/password pairs"
      count:
        type: integer
        description: "Number of credentials found"

  schema:
    description: "Get full database schema (all tables and columns)"
    when_to_use: "To get complete overview of database structure"
    params:
      database:
        type: string
        required: true
        description: "Path to SQLite database file"
      is_base64:
        type: boolean
        default: false
        description: "If true, database parameter is base64-encoded"
    returns:
      tables:
        type: object
        description: "All tables with their columns and row counts"
      table_count:
        type: integer
        description: "Number of tables"
