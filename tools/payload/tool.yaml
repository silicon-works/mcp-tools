name: payload
version: "1.0"
description: "Payload compiler and generator for reverse shells, SUID binaries, C compilation, and encoding. 6 methods: compile_c (GCC cross-compilation for x64/x86/ARM, static/stripped), suid_shell (setuid(0)+execve shell binary), revshell (one-liners in 8 languages: bash, python, nc, php, perl, ruby, powershell, socat with variants), list_shells (show all available reverse shell types), encode (base64/URL/double-URL/hex/unicode), decode. Does NOT require network — runs locally. For Metasploit msfvenom payloads, use metasploit generate_payload instead."
image: "ghcr.io/silicon-works/mcp-tools-payload:latest"
image_size_mb: 400
timeout_seconds: 300

capabilities:
  - binary_compilation
  - reverse_shell_generation
  - payload_encoding
  - suid_binary_creation

phases:
  - exploitation
  - post-exploitation

requirements:
  network: false
  privileged: false

resources:
  memory_mb: 512
  cpu: 1.0

# Routing hints for tool selection
routing:
  use_for:
    - "generate reverse shell one-liners in bash python php perl ruby powershell"
    - "compile C exploit source code to ELF binary"
    - "create SUID shell binary for privilege escalation"
    - "encode payloads in base64 URL hex or unicode for delivery"
    - "cross-compile C code for x86 ARM or x64 targets"
  never_use_for:
    - "vulnerability scanning"
    - "port scanning"
    - "brute-force attacks"
  triggers:
    - "reverse shell"
    - "payload"
    - "compile"
    - "encode payload"
    - "SUID binary"
    - "shellcode"
    - "revshell"

methods:
  compile_c:
    description: "Compile C source code to an ELF binary using GCC. Supports x64, x86, and ARM architectures. Options for static linking (for targets without shared libraries) and symbol stripping (smaller binary, harder to reverse). Returns the compiled binary as base64 or hex."
    when_to_use: "To compile kernel exploits, privilege escalation exploits, or custom C code for a target. Typical workflow: get exploit source from searchsploit → compile_c with static=true for portability → upload to target via ssh upload_binary → execute. Use arch='x86' for 32-bit targets, 'arm' for embedded/IoT."
    params:
      source:
        type: string
        required: true
        description: "C source code to compile"
      arch:
        type: enum
        values: [x64, x86, arm]
        default: x64
        description: "Target architecture"
      static:
        type: boolean
        default: false
        description: "Compile statically linked binary"
      strip:
        type: boolean
        default: true
        description: "Strip symbols from binary"
      output_format:
        type: enum
        values: [base64, hex]
        default: base64
        description: "Output encoding format"
    returns:
      binary:
        type: string
        description: "Compiled binary in specified format"
      size_bytes:
        type: integer
        description: "Binary size in bytes"

  suid_shell:
    description: "Generate a SUID shell binary"
    when_to_use: "To create a binary that runs commands as root when SUID is set"
    params:
      command:
        type: string
        default: "/bin/bash"
        description: "Command to execute"
      arch:
        type: enum
        values: [x64, x86]
        default: x64
        description: "Target architecture"
      output_format:
        type: enum
        values: [base64, hex]
        default: base64
        description: "Output encoding format"
    returns:
      binary:
        type: string
        description: "SUID shell binary in specified format"
      size_bytes:
        type: integer
        description: "Binary size in bytes"

  revshell:
    description: "Generate a reverse shell one-liner in 8 languages: bash (tcp/pty/mkfifo variants), python, nc (traditional/mkfifo), php, perl, ruby, powershell, socat. Supports encoding (base64, URL, double-URL) for delivery through injection points."
    when_to_use: "When you have RCE and need a reverse shell payload in a specific language available on the target. Choose based on what's installed: bash (most Linux), python (if Python installed), php (PHP web servers), powershell (Windows). Use encode=base64 to avoid special character issues in injection. Start a listener (netcat listen or metasploit handler) BEFORE delivering the payload."
    params:
      lhost:
        type: string
        required: true
        description: "Listener IP address"
      lport:
        type: integer
        required: true
        description: "Listener port"
      type:
        type: enum
        values: [bash, python, nc, php, perl, ruby, powershell, socat]
        default: bash
        description: "Reverse shell type"
      variant:
        type: string
        description: "Variant of the shell type (e.g., 'tcp', 'pty', 'mkfifo')"
      encode:
        type: enum
        values: [none, base64, url, double-url]
        default: none
        description: "Encoding to apply"
    returns:
      payload:
        type: string
        description: "Reverse shell payload"
      raw_payload:
        type: string
        description: "Unencoded payload (if encoding applied)"

  list_shells:
    description: "List available reverse shell types and variants"
    when_to_use: "To see available reverse shell options"
    params: {}
    returns:
      shells:
        type: object
        description: "Available shell types and their variants"

  encode:
    description: "Encode a payload"
    when_to_use: "To encode payloads for evasion or transport"
    params:
      payload:
        type: string
        required: true
        description: "Payload to encode"
      encoding:
        type: enum
        values: [base64, url, double-url, hex, unicode]
        required: true
        description: "Encoding method"
    returns:
      encoded:
        type: string
        description: "Encoded payload"

  decode:
    description: "Decode an encoded payload"
    when_to_use: "To decode payloads for analysis"
    params:
      payload:
        type: string
        required: true
        description: "Payload to decode"
      encoding:
        type: enum
        values: [base64, url, hex]
        required: true
        description: "Encoding to reverse"
    returns:
      decoded:
        type: string
        description: "Decoded payload"
